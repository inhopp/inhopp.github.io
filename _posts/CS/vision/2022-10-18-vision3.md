---
title:  "[CV] Harris Corner Detection" 

categories:
  -  Vision
tags:
  - [CS]

toc: true
toc_sticky: true

date: 2022-10-18
last_modified_at: 2022-10-18
---

<br>

# ğŸ“¹ What is corner?

![corner](https://user-images.githubusercontent.com/96368476/196334721-06ca080a-f9c8-4f43-957b-ad900bedef52.png){: width="60%" height="70%" .align-center}

Cornerë¥¼ ì–´ë–»ê²Œ ì •ì˜í•´ì•¼ í• ê¹Œ? ì‚¬ì‹¤ Harris corner detectorëŠ” ë„ˆë¬´ ëŠë¦¬ê¸° ë•Œë¬¸ì— í˜„ì¬ì—ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë¼ê³  í•œë‹¤. í•˜ì§€ë§Œ Harrisê°€ ì œì•ˆí•œ cornerì˜ ìˆ˜í•™ì  ì •ì˜, ì´ë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ íƒì§€í•  ìˆ˜ ìˆëŠ” ì•Œê³ ë¦¬ì¦˜ì€ ì•„ì£¼ ì¸ìƒì ì´ë‹¤. HarrisëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ flat/edge/cornerë¥¼ êµ¬ë¶„í•˜ì˜€ë‹¤.

- flat : í•œ ì ì— ëŒ€í•´ì„œ, ëª¨ë“  ë°©í–¥ì— ëŒ€í•´ ë³€í™”ëŸ‰ì´ ì‘ë‹¤.
- edge : í•œ ë°©í–¥ìœ¼ë¡œë§Œ ë³€í™”ëŸ‰ì´ ì‘ë‹¤.
- corner : ëª¨ë“  ë°©í–¥ìœ¼ë¡œì˜ ë³€í™”ëŸ‰ì´ í¬ë‹¤.


<br>


# ğŸ“¹ Mathematics of Harris Detector

ì •ë¦¬í•˜ìë©´ cornerë¥¼ ì°¾ê¸° ìœ„í•´ì„œëŠ” í•œ ì ì— ëŒ€í•´ ì£¼ë³€ìœ¼ë¡œì˜ ë³€í™”ëŸ‰ì„ ê³„ì‚°í•´ì•¼ í•œë‹¤. ì´ëŠ” windowë¥¼ ì‚¬ìš©í•˜ë©´ ê°„ë‹¨íˆ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤. í•µì‹¬ì€ ì–´ëŠ ë°©í–¥ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ë³€í•˜ëƒëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ìœ„í•´ ë³€í™”ëŸ‰ í•¨ìˆ˜ë¥¼ 1ì°¨ Taylor seriesë¡œ ê·¼ì‚¬í•˜ê³ , ëŒ€ê°í™”ë¥¼ ì§„í–‰í•œë‹¤. (ëŒ€ê°í™”ì— ëŒ€í•´ì„œëŠ” ì„ í˜•ëŒ€ìˆ˜ í¬ìŠ¤íŒ…ì— ì˜ ì •ë¦¬ë˜ì–´ ìˆë‹¤.) 

<br>

$$ E(u,v) = \sum_{(x,y)\in W}^{}\begin{bmatrix} I(x+u, y+v) - I(x,y)\end{bmatrix}^{2} $$

<br>

$$ \begin{align*} 
I(x+u, y+v) &= I(x,y) + \frac{\partial I}{\partial x} u + \frac{\partial I}{\partial y} v + \textit{higher order term...} \\ &\approx I(x,y) + \frac{\partial I}{\partial x} u + \frac{\partial I}{\partial y} v \\ &= I(x,y) + \begin{bmatrix}I_{x} \, I_{y}\end{bmatrix}\begin{bmatrix} u \\v \end{bmatrix}
\end{align*} $$

<br>

$$ \begin{align*}
E(u,v) &\approx \sum_{(x,y)\in W}^{}\begin{bmatrix} I(x,y) + \begin{bmatrix}
I_{x} & I_{y} \end{bmatrix}\begin{bmatrix} u \\ v \end{bmatrix}
- I(x, y)
\end{bmatrix}^{2} \\ 
&= \sum_{(x,y) \in W}^{} \begin{bmatrix} \begin{bmatrix}
I_{x} & I_{y} \end{bmatrix} \begin{bmatrix} u \\ v \end{bmatrix}
\end{bmatrix}^{2} \\
&= \sum_{(x,y) \in W}^{} \begin{bmatrix} u & v \end{bmatrix} \begin{bmatrix}
I_{x}^{2} & I_{x} I_{y} \\ I_{y} I_{x} & I_{y}^{2} \end{bmatrix}
\begin{bmatrix} u \\ v \end{bmatrix} \\
&= \begin{bmatrix} u & v \end{bmatrix} 
\left ( \sum_{(x,y) \in W}^{} \begin{bmatrix}
I_{x}^{2} & I_{x} I_{y} \\
I_{y} I_{x} & I_{y}^{2} \\
\end{bmatrix} \right )
\begin{bmatrix} u \\ v \end{bmatrix} \\
&= \begin{bmatrix} u & v \end{bmatrix} 
\mathbf{M}
\begin{bmatrix} u \\ v \end{bmatrix}
\end{align*} $$

<br>

ì¦‰, (u,v)ì—ì„œì˜ ë³€í™”ëŸ‰ì€ matrix Mì— ì˜í•´ ê²°ì •ëœë‹¤. ì´ë•Œ ì£¼ëª©í•  ì ì€ Mì´ symmetric í•˜ê¸° ë•Œë¬¸ì— ëŒ€ê°í™”ê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì´ê³ , Mì˜ eigen valueì— ë”°ë¼ ì„ì˜ì˜ ë°©í–¥ì— ëŒ€í•œ ë³€í™”ìœ¨ì´ ê²°ì •ëœë‹¤. <br>

$$ \begin{align*}
\mathbf{M} &= \sum_{(x,y) \in W}^{} \begin{bmatrix}
I_{x}^{2} & I_{x} I_{y} \\ I_{y} I_{x} & I_{y}^{2} 
\end{bmatrix} \\
&= X \begin{bmatrix}
\lambda_{1} & 0 \\ 0 & \lambda_{2} 
\end{bmatrix}
X^{T}
\end{align*} $$

<br>

![eigenvalue](https://user-images.githubusercontent.com/96368476/196435479-d965456b-51be-45ad-a0eb-92dc7eb5cd8b.png)
{: width="60%" height="70%" .align-center}

- Î»1 & Î»2ê°€ ëª¨ë‘ ì‘ìŒ : ëª¨ë“  ë°©í–¥ìœ¼ë¡œì˜ ë³€í™”ìœ¨ì´ ì‘ìŒ â†’ Flat
- Î»1ê³¼ Î»2 ì¤‘ í•˜ë‚˜ëŠ” í¬ê³  í•˜ë‚˜ëŠ” ì‘ìŒ : íŠ¹ì • ë°©í–¥ìœ¼ë¡œë§Œ ë³€í™”ìœ¨ì´ í¼ â†’ Edge
- Î»1 & Î»2ê°€ ëª¨ë‘ í¼ : ëª¨ë“  ë°©í–¥ìœ¼ë¡œì˜ ë³€í™”ìœ¨ì´ í¼ â†’ Corner

<br>

## R score

ìš°ë¦¬ê°€ í•„ìš”í•œ ê±´ Î»1ê³¼ Î»2ì˜ êµ¬ì²´ì ì¸ ê°’ì´ ì•„ë‹ˆë¼, ëŒ€ëµì ì¸ í¬ê¸°ì™€ ë¹„ìœ¨ì´ë‹¤. ë”°ë¼ì„œ Determinantì™€ Traceì˜ ì„±ì§ˆì„ ì´ìš©í•˜ë©´ ì§ì ‘ ëŒ€ê°í™”ë¥¼ í•˜ì§€ ì•Šê³ ë„ ê°„í¸íˆ êµ¬í•  ìˆ˜ ìˆë‹¤.




<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}