---
title:  "[CV] Canny Edge Detection" 

categories:
  -  Vision
tags:
  - [CS]

toc: true
toc_sticky: true

date: 2022-10-27
last_modified_at: 2022-10-27
---

<br>

**Main Reference: <br>- [Canny Edge Detection Step by Step in Python â€” Computer Vision](https://towardsdatascience.com/canny-edge-detection-step-by-step-in-python-computer-vision-b49c3a2d8123)**
{: .notice--warning}

# ğŸ“¹ Introduction

| Original Image | Canny Edge Detection |
|:-:|:-:|
|![1_image](https://user-images.githubusercontent.com/96368476/198345323-88f3c335-d2b4-416b-a246-c942b9b45d2c.jpg)|![1_OpenCV_Canny](https://user-images.githubusercontent.com/96368476/198345329-229ef3dd-0b78-43fb-bc4c-3c9deb75c481.jpg)
|

Canny Edge DetectiorëŠ” 1986ë…„ Cannyê°€ ì œì•ˆí•œ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ìƒê°ë³´ë‹¤ í›¨ì”¬ ì˜¤ë˜ëœ ì•Œê³ ë¦¬ì¦˜ì„ì—ë„ ë„ˆë¬´ ì˜ ì‘ë™í•´ì„œ ê¹œì§ ë†€ëë‹¤. ì‚¬ì‹¤ 2D visionì´ë¼ í•˜ë©´ deep learningì— ë°€ë ¤ë‚œ ë’·ë°© ëŠ™ì€ì´ì¸ ì¤„ë§Œ ì•Œì•˜ëŠ”ë°, visionì„ ê³µë¶€í•˜ë©´ í•  ìˆ˜ë¡ êµ‰ì¥íˆ ê±´ë°©ì§„ ìƒê°ì´ì—ˆë‹¤ëŠ” ë°˜ì„±ì„ í•˜ê²Œëœë‹¤. ì•„ë¬´íŠ¼ ì˜¤ëŠ˜ì€ ë‚´ê°€ ì¢‹ì•„í•˜ëŠ” ê¸°ì°¨ ì‚¬ì§„ìœ¼ë¡œ Canny Edge Detection ê³¼ì •ì„ ë”°ë¼ê°€ ë³´ì.

<br>

## Algorithm

1. Noise Reduction
2. Gradient Calculation
3. Non-Maximum Suppression
4. Double Threshold
5. Edge Tracking


<br>


# ğŸ“¹ Noise Reduction

| Original Image | RGB to Gray | Gaussian Blurring |
|:-:|:-:|:-:|
|![train](https://user-images.githubusercontent.com/96368476/198351762-5f5e3478-9da7-4521-8343-4de8c87bfc70.jpeg)|![image](https://user-images.githubusercontent.com/96368476/198351779-e1372a28-7ace-405b-b06c-04683570fb2b.jpg)|![gaussian](https://user-images.githubusercontent.com/96368476/198351786-30363a61-b91c-400f-a4df-8c53e90ef986.jpg)|

Canny Edge Detectionì€ gradientë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— ë¨¼ì € ì´ë¯¸ì§€ë¥¼ í‘ë°±ìœ¼ë¡œ ë°”ê¿”ì¤˜ì•¼ í•œë‹¤. ë˜í•œ í”½ì…€ ë‹¨ìœ„ì—ì„œ gradient ê°’ì„ ë‹¤ë£¨ë¯€ë¡œ noiseì—ë„ ì·¨ì•½í•˜ë‹¤. ë”°ë¼ì„œ gaussian blurringì„ í†µí•´ ì´ë¯¸ì§€ë¥¼ ë¶€ë“œëŸ½ê²Œ ë§Œë“¤ì–´ noiseì˜ ì˜í–¥ì„ ì¤„ì—¬ì¤€ë‹¤. í˜„ì¬ ì˜ˆì‹œì—ì„œëŠ” ì´ë¯¸ì§€ì˜ ì‚¬ì´ì¦ˆê°€ ì»¤ blurring íš¨ê³¼ê°€ ì˜ ëŠê»´ì§€ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ ì„±ëŠ¥ì—ëŠ” í° ì°¨ì´ë¥¼ ë³´ì´ê¸° ë•Œë¬¸ì— êµ‰ì¥íˆ ì¤‘ìš”í•œ ì‘ì—…ì´ë‹¤.


<br>

# ğŸ“¹ Gradient Calculation

| Blurred Image | Gradient Intensity |
|:-:|:-:|
|![gaussian](https://user-images.githubusercontent.com/96368476/198351786-30363a61-b91c-400f-a4df-8c53e90ef986.jpg)|![sobel](https://user-images.githubusercontent.com/96368476/198354252-371c8383-d88b-4c91-906b-c7755a09ff59.jpg)|


$$ dx = \begin{bmatrix}
1 & 0 & -1 \\
2 & 0 & -2 \\
1 & 0 & -1 \\
\end{bmatrix}

\textbf{    ,   }

dy = \begin{bmatrix}
1 & 2 & 1 \\
0 & 0 & 0 \\
-1 & -2 & -1 \\
\end{bmatrix}  $$

$$ \left| \textbf{G} \right| = \sqrt{I_{x}^{2} + I_{y}^{2}} \\
\Theta (x, y) = \textbf{arctan}\left ( \frac{I_{y}}{I_{x}} \right ) $$

- gradientëŠ” sobel operatorë¥¼ ì´ìš©
- í”½ì…€ ë‹¨ìœ„ë¡œ gradientì˜ í¬ê¸°, ë°©í–¥ì„ ê³„ì‚°
- gradientì˜ ë°©í–¥ì€ ì´í›„ Non-Maximum Suppression ë‹¨ê³„ì—ì„œ ì‚¬ìš©




<br>


# ğŸ“¹ Non-Maximum Suppression

| Gradient Intensity | Gradient Intensity |
|:-:|:-:|
|![sobel](https://user-images.githubusercontent.com/96368476/198354252-371c8383-d88b-4c91-906b-c7755a09ff59.jpg)|![edge](https://user-images.githubusercontent.com/96368476/198356109-4b5fea0e-cf0a-43fc-88a7-e9140a16d4fb.png)|

ì•ì—ì„œ êµ¬í•œ gradient intensity mapì„ ë³´ë©´ edgeë“¤ì´ êµ‰ì¥íˆ ì§„í•˜ê³  ë‘ê»ë‹¤. ì´ê²Œ ì–´ë–¤ ì˜ë¯¸ì¸ê°€ í•˜ë©´ ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì²˜ëŸ¼ í•˜ë‚˜ì˜ edgeê°€ ì—¬ëŸ¬ í”½ì…€ì„ ì§€ë‚˜ê°€ëŠ” ìƒí™©ì´ë‹¤. ì •êµí•œ íƒì§€ë¥¼ ìœ„í•´ í•˜ë‚˜ì˜ edgeëŠ” í•˜ë‚˜ì˜ í”½ì…€ë‹¨ìœ„ë¡œ ì§€ë‚˜ë‹¤ë…”ìœ¼ë©´ ì¢‹ê² ë‹¤. ì´ë¥¼ ìœ„í•´ non-Maximum Suppression ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤.

<br>

![direction](https://user-images.githubusercontent.com/96368476/198357443-de917165-8128-4a17-aac3-5ed139932b3e.jpg){:.align-center}

ìš°ì„  í•˜ë‚˜ì˜ ê°€ì •ì´ í•„ìš”í•œë°, gradientì˜ ë°©í–¥ì€ ìœ„ì™€ ê°™ì´ 4ê°€ì§€ ë°©í–¥ìœ¼ë¡œë§Œ ì¡´ì¬í•œë‹¤. ì–¼í• ìƒê°í•˜ë©´ ê³¼ê²©í•œ ê°€ì •ì´ë¼ ìƒê°í•  ìˆ˜ ìˆëŠ”ë°, ì–´ì°¨í”¼ EdgeëŠ” í”½ì…€ ë‹¨ìœ„ë¡œ ì§€ë‚˜ê¸° ë•Œë¬¸ì— í•©ë¦¬ì ì¸ ê°€ì •ì´ë‹¤.

<br>

![direction2](https://user-images.githubusercontent.com/96368476/198358486-8795b1f2-d015-4653-9f31-a8a9fca9e961.png){: width="60%" height="50%" .align-center}

ìœ„ì™€ ê°™ì´ (i,j)í”½ì…€ì—ì„œ 3pi/4 ë°©í–¥ì˜ edgeê°€ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì. ë¨¼ì € (i,j)í”½ì…€ì—ì„œ edgeì˜ ë°©í–¥ì€ gradient ë°©í–¥ì— ìˆ˜ì§í•œë‹¤ëŠ” ê²ƒì„ ì´í•´í•´ì•¼ í•œë‹¤. Gradientì˜ ìˆ˜í•™ì  ì˜ë¯¸ë¥¼ ìƒê°í•´ë³´ë©´ ê°„ë‹¨í•˜ë‹¤. Gradient vectorëŠ” í•´ë‹¹ ì§€ì ì—ì„œ ê°€ì¥ ë³€í™”ìœ¨ì´ í° ë°©í–¥ì„ í–¥í•œë‹¤. ê·¸ë¦¬ê³  Edgeë¼ëŠ” ê²ƒì€ edgeë¥¼ ì§€ë‚  ë•Œ ê°’ì´ í™• ë°”ë€ŒëŠ” ì§€ì ì´ë¼ ì •ì˜í–ˆë‹¤. ë”°ë¼ì„œ (i,j)í”½ì…€ì—ì„œì˜ gradientëŠ” edgeì™€ ìˆ˜ì§ì¸ ë°©í–¥ì„ í–¥í•  ê²ƒì´ë‹¤.  <br>ì´ì œ NMS ê³¼ì •ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë³´ì. ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê²ƒì€ ë‘êº¼ìš´ edgeê°€ ì–‡ì•„ì¡Œìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ edgeì™€ ìˆ˜ì§ì¸ ë°©í–¥ì˜ ê°’ë“¤ì„ ë¹„êµí•˜ì—¬ ë‚˜ë³´ë‹¤ ì‘ìœ¼ë©´ 0ìœ¼ë¡œ ì••ì¶•í•´ë²„ë¦°ë‹¤. ê·¸ë˜ì•¼ edgeì˜ ë‘ê»˜ê°€ ì–‡ì•„ì§ˆ ê²ƒì´ë‹¤. ìœ„ ê·¸ë¦¼ì„ ì˜ˆë¡œ ë“¤ë©´, edgeë°©í–¥ì¸ íŒŒë€ìƒ‰ ë°•ìŠ¤ê°€ ì•„ë‹ˆë¼ edgeë°©í–¥ê³¼ ìˆ˜ì§ì¸ ì¢Œì¸¡ìƒë‹¨, ìš°ì¸¡í•˜ë‹¨ì˜ í”½ì…€ ê°’ë“¤ê³¼ ë¹„êµí•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë§Œì•½ í•´ë‹¹ ê°’ë“¤ì´ (i,j)í”½ì…€ì˜ ê°’ë³´ë‹¤ ì‘ìœ¼ë©´ 0ìœ¼ë¡œ ê°’ì„ ë°”ê¿”ì£¼ê³ , (i,j)í”½ì…€ì˜ ê°’ë³´ë‹¤ ë†’ì€ ê°’ì´ ì¡´ì¬í•œë‹¤ë©´ (i,j)í”½ì…€ì˜ ê°’ì„ 0ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤.



<br>



# ğŸ“¹ Double Threshold

![threshold](https://user-images.githubusercontent.com/96368476/198365422-004112ab-a5c4-4db1-ac63-4d66292bf59c.png){:.align-center}

ì´ì œ edgeì˜ ë‘ê»˜ëŠ” ê· ì¼í•˜ê²Œ ë§ì¶”ì—ˆê³ , í•„ìš”ì—†ëŠ” í›„ë³´ë“¤ì„ ì œì™¸í•˜ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤. ë³´í†µ ì´ëŸ° ìƒí™©ì—ì„œëŠ” thresholdê°’ì„ ì •í•´ í•´ë‹¹ ê°’ë³´ë‹¤ ì‘ìœ¼ë©´ í›„ë³´ì—ì„œ ì œì™¸ì‹œí‚¤ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•˜ëŠ”ë°, canny detectorëŠ” íŠ¹ì´í•˜ê²Œë„ 2ê°€ì§€ thresholdê°’ì„ ì‚¬ìš©í•œë‹¤. ì‘ë™ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- High thresholdê°’ë³´ë‹¤ ë†’ì€ edge í›„ë³´ë“¤ì€ ìœ ì§€í•œë‹¤. â†’ A, B ìœ ì§€
- Low thresholdê°’ë³´ë‹¤ ì‘ì€ edge í›„ë³´ë“¤ì€ ì œì™¸í•œë‹¤. â†’ D ì œì™¸
- ë‘ threshold ì‚¬ì´ì— ì¡´ì¬í•˜ëŠ” edge í›„ë³´ë“¤ì€ high thresholdê°’ë³´ë‹¤ ë†’ì€ edgeì™€ ì—°ê²°ëœ ê²½ìš°ì—ë§Œ ìœ ì§€í•œë‹¤. â†’ C ìœ ì§€ & E ì œì™¸


<br>

| Before NMS | After NMS + Double Threshold |
|:-:|:-:|
|![sobel](https://user-images.githubusercontent.com/96368476/198354252-371c8383-d88b-4c91-906b-c7755a09ff59.jpg)|![canny](https://user-images.githubusercontent.com/96368476/198362678-13477228-e139-46ae-9fe2-e6f391f6bc1d.jpg)|



<br>

# ğŸ“¹ Edge Tracking

![tracking](https://user-images.githubusercontent.com/96368476/198368286-cd3ca46a-62e7-43c7-83c8-cda2b6427a7e.png){: width="60%" height="50%" .align-center}

ë§ˆì§€ë§‰ìœ¼ë¡œ í”½ì…€ ë‹¨ìœ„ë¡œ ì¡´ì¬í•˜ëŠ” edgeë“¤ì„ ì—°ê²°í•˜ëŠ” ê³¼ì •ì´ë‹¤. í•„ìš” ì—†ëŠ” edge í›„ë³´ë“¤ì€ ì œì™¸ì‹œí‚¤ê³ , ì‹¤ì§ˆì ì¸ edgeë“¤ë§Œ ì„œë¡œ ì—°ê²°ì‹œì¼œì£¼ëŠ” ê°„ë‹¨í•œ ì‘ì—…ì´ë‹¤. ì‘ë™ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. ì™¼ìª½ ê·¸ë¦¼ì²˜ëŸ¼ í•´ë‹¹ í”½ì…€ ì£¼ë³€ì— ì‚´ì•„ë‚¨ì€ í›„ë³´ê°€ ì—†ì„ ê²½ìš° edgeì—ì„œ ì œì™¸ì‹œí‚¨ë‹¤. ë°˜ë©´ ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì²˜ëŸ¼ í•´ë‹¹ í”½ì…€ ì£¼ë³€ì— ì‚´ì•„ë‚¨ì€ í›„ë³´ê°€ í•˜ë‚˜ë¼ë„ ì¡´ì¬í•  ê²½ìš°ì—ëŠ” edgeë¡œ í™•ì •í•œë‹¤.

| Before Tracking | After Tracking |
|:-:|:-:|
|![canny](https://user-images.githubusercontent.com/96368476/198362678-13477228-e139-46ae-9fe2-e6f391f6bc1d.jpg)|![OpenCV_Canny](https://user-images.githubusercontent.com/96368476/198369363-72dc734d-092f-462d-98b7-0f2e7eaa1bb2.jpg)|




<br>


# ğŸ“¹ Results

| Original Image | Canny Edge Detection |
|:-:|:-:|
|![image](https://user-images.githubusercontent.com/96368476/198351779-e1372a28-7ace-405b-b06c-04683570fb2b.jpg)|![OpenCV_Canny](https://user-images.githubusercontent.com/96368476/198369363-72dc734d-092f-462d-98b7-0f2e7eaa1bb2.jpg)|





<br>




[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}