---
title:  "[CV] Canny Edge Detection" 

categories:
  -  Vision
tags:
  - [CS]

toc: true
toc_sticky: true

date: 2022-10-27
last_modified_at: 2022-10-27
---

<br>

**Main Reference: <br>- [Canny Edge Detection Step by Step in Python — Computer Vision](https://towardsdatascience.com/canny-edge-detection-step-by-step-in-python-computer-vision-b49c3a2d8123)**
{: .notice--warning}

# 📹 Introduction

| Original Image | Canny Edge Detection |
|:-:|:-:|
|![1_image](https://user-images.githubusercontent.com/96368476/198345323-88f3c335-d2b4-416b-a246-c942b9b45d2c.jpg)|![1_OpenCV_Canny](https://user-images.githubusercontent.com/96368476/198345329-229ef3dd-0b78-43fb-bc4c-3c9deb75c481.jpg)
|

Canny Edge Detectior는 1986년 Canny가 제안한 알고리즘이다. 생각보다 훨씬 오래된 알고리즘임에도 너무 잘 작동해서 깜짝 놀랐다. 사실 2D vision이라 하면 deep learning에 밀려난 뒷방 늙은이인 줄만 알았는데, vision을 공부하면 할 수록 굉장히 건방진 생각이었다는 반성을 하게된다. 아무튼 오늘은 내가 좋아하는 기차 사진으로 Canny Edge Detection 과정을 따라가 보자.

<br>

## Algorithm

1. Noise Reduction
2. Gradient Calculation
3. Non-maximum Suppression
4. Double Threshold
5. Edge Tracking


<br>


# 📹 Noise Reduction

| Original Image | RGB to Gray | Gaussian Blurring |
|:-:|:-:|:-:|
|![train](https://user-images.githubusercontent.com/96368476/198351762-5f5e3478-9da7-4521-8343-4de8c87bfc70.jpeg)|![image](https://user-images.githubusercontent.com/96368476/198351779-e1372a28-7ace-405b-b06c-04683570fb2b.jpg)|![gaussian](https://user-images.githubusercontent.com/96368476/198351786-30363a61-b91c-400f-a4df-8c53e90ef986.jpg)|

Canny Edge Detection은 gradient를 기반으로 작동하기 때문에 먼저 이미지를 흑백으로 바꿔줘야 한다. 또한 픽셀 단위에서 gradient 값을 다루므로 noise에도 취약하다. 따라서 gaussian blurring을 통해 이미지를 부드럽게 만들어 noise의 영향을 줄여준다. 현재 예시에서는 이미지의 사이즈가 커 blurring 효과가 잘 느껴지지 않는다. 하지만 성능에는 큰 차이를 보이기 때문에 굉장히 중요한 작업이다.


<br>

# 📹 Gradient Calculation

| Blurred Image | Gradient Intensity |
|:-:|:-:|
|![gaussian](https://user-images.githubusercontent.com/96368476/198351786-30363a61-b91c-400f-a4df-8c53e90ef986.jpg)|![sobel](https://user-images.githubusercontent.com/96368476/198354252-371c8383-d88b-4c91-906b-c7755a09ff59.jpg)|





$$ dx = \begin{bmatrix}
1 & 0 & -1 \\
2 & 0 & -2 \\
1 & 0 & -1 \\
\end{bmatrix}

\textbf{    ,   }

dy = \begin{bmatrix}
1 & 2 & 1 \\
0 & 0 & 0 \\
-1 & -2 & -1 \\
\end{bmatrix}  $$

$$ \left| \textbf{G} \right| = \sqrt{I_{x}^{2} + I_{y}^{2}} \\
\Theta (x, y) = \textbf{arctan}\left ( \frac{I_{y}}{I_{x}} \right ) $$

- gradient는 sobel operator를 이용
- 픽셀 단위로 gradient의 크기, 방향을 계산
- gradient의 방향은 이후 Non-maximum Suppression 단계에서 사용



<br>




[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}