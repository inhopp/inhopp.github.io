---
title:  "[CV] Scale-Invariant Feature Transform (SIFT)" 

categories:
  -  Vision
tags:
  - [CS]

toc: true
toc_sticky: true

date: 2022-10-20
last_modified_at: 2022-10-20
---

<br>

# ğŸ“¹ Introduction to SIFT

![intro](https://user-images.githubusercontent.com/96368476/196869485-f829988f-e00f-4d64-9867-151ea3e71443.png){: width="60%" height="70%" .align-center}

<br>

![result](https://user-images.githubusercontent.com/96368476/196872462-ccbd8c6d-c272-44ac-996d-4fe595cf16fc.png){: width="60%" height="70%" .align-center}

SIFTëŠ” key pointë¥¼ ì°¾ì•„ descriptorë¥¼ ë¶™ì´ëŠ” ë‹¨ê³„, descriptorë¥¼ ì´ìš©í•´ ì›ë³¸ ì´ë¯¸ì§€ì™€ ë³€í™˜ ì´ë¯¸ì§€ì˜ key pointë¥¼ ë§¤ì¹­í•˜ëŠ” ë‹¨ê³„, ì´ ë‘ ë‹¨ê³„ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. SIFTë¡œ ë½‘ì€ key pointì˜ íŠ¹ì§•ìœ¼ë¡œëŠ” Scale, Rotation, Illumunation, Noise ì— Invariantí•˜ë‹¤.

<br>

## Scaling Problem

| Original Image | Zoomed Image |
|:-:|:-:|
|![example1](https://user-images.githubusercontent.com/96368476/196873407-760393ae-9b6a-4a0d-819a-b329a9ace459.png)|![example2](https://user-images.githubusercontent.com/96368476/196873399-23f9a2ac-500d-4d52-ac18-4a676bc7ae0f.png)|

Harris Corner Detectorì—ì„œ ë³´ì•˜ë“¯ì´ ê¸°ì¡´ detectorëŠ” ê°™ì€ ì½”ë„ˆë¥¼ ê²€ì¶œí•œë‹¤ í•˜ë”ë¼ë„ ëŒ€ìƒì˜ scaleì— ë”°ë¼ ë‹¤ë¥¸ detectorë¥¼ ì‚¬ìš©í•´ì•¼ í–ˆë‹¤. ì‹¤ì œ ì´ë¯¸ì§€ì—ì„œ ë¬¼ì²´ì˜ í¬ê¸°ëŠ” ì¹´ë©”ë¼ë¡œë¶€í„° ì–¼ë§ˆë‚˜ ë–¨ì–´ì ¸ ìˆëƒì— ì˜ì¡´í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìœ„ ê·¸ë¦¼ì˜ ì˜¤ë¥¸ìª½ ì´ë¯¸ì§€ëŠ” ì™¼ìª½ ì´ë¯¸ì§€ì˜ ì¼ë¶€ë¶„ì„ í™•ëŒ€í•œ ê²ƒì— ë¶ˆê³¼í•˜ë‹¤. ì™¼ìª½ ê³„ë‹¨ê³¼ ì˜¤ë¥¸ìª½ ê³„ë‹¨ì´ ë™ì¼í•œ ëŒ€ìƒì„ì—ë„ ì„œë¡œ ë‹¤ë¥¸ detectorë¥¼ ì‚¬ìš©í•´ì•¼ ì´ë“¤ì„ íƒì§€í•  ìˆ˜ ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. <br>SIFTëŠ” 'Gaussian Pyramid'ë¼ëŠ” ê¸°ë²•ìœ¼ë¡œ ì´ë¥¼ ë©‹ì§€ê²Œ í•´ê²°í•œë‹¤. MLì˜ object detectionì„ ê³µë¶€í•  ë•Œ ë³´ì•˜ë˜ Spatial Pyramid Pooling ê¸°ë²•ì´ë‘ ë§¤ìš° ìœ ì‚¬í•œë° SIFTëŠ” ë¬´ë ¤ 2004ë…„ì— ë°œí‘œëœ ë…¼ë¬¸ì´ë‹¤. Vision ë¶„ì•¼ë„ ì •ë§ ë˜‘ë˜‘í•œ ì‚¬ëŒë“¤ì´ ë§ì•˜êµ¬ë‚˜ ì‹¶ë‹¤.


<br>

## Algorithm

1. Detect Scale-Space Extrema
2. Accurate Key Point
3. Assign Orientation
4. Key Point Descriptor
5. Key Matching


<br>


# ğŸ“¹ Detect Scale-Space Extrema

![pyramid](https://user-images.githubusercontent.com/96368476/196880606-f2b73d29-d348-4845-9946-9db697536915.png){: width="60%" height="70%" .align-center}

ë¨¼ì € Scale-Invariant íŠ¹ì„±ì„ ìœ„í•´ Gaussian Pyramid ê¸°ë²•ì„ ì´ìš©í•œë‹¤. Bolb Detection ì—ì„œ ë´¤ë“¯ì´ íŠ¹ì • í¬ê¸°ì˜ featureë¥¼ íƒì§€í•˜ê¸° ìœ„í•´ì„œëŠ” Laplacian of Gaussian(LoG) ë˜ëŠ” Difference of Gaussian(DoG)ë¥¼ ì´ìš©í•´ì•¼ í•œë‹¤. ì´ë•Œ Gaussianì˜ Ïƒ, ë‹¤ì‹œ ë§í•´ kernel scaleì´ blob scaleê³¼ ì¼ì¹˜í•´ì•¼ blobì„ íƒì§€í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ê°™ì€ ì´ë¯¸ì§€ í¬ê¸°(same octave)ì—ì„œ Ïƒë¥¼ ë³€ê²½í•´ê°€ë©° blobì„ íƒì§€í•˜ê³ , ì´ë¯¸ì§€ ì „ì²´ë¥¼ down-sampling(next octave)í•œ í›„ ë‹¤ì‹œ Ïƒë¥¼ ë³€ê²½í•´ê°€ë©° blobì„ íƒì§€í•´ë‚˜ê°„ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ì„ì˜ì˜ scaleì— ëŒ€í•œ blob detectionì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì¸ë°, Ïƒë¥¼ ì•„ì£¼ ë¯¸ì„¸í•˜ê²Œ ë‚˜ëˆ„ëŠ” ê²ƒë³´ë‹¤ í›¨ì”¬ íš¨ìœ¨ì ì¸ ë°©ì‹ì´ë¼ í•  ìˆ˜ ìˆë‹¤. <br>

![laplacian pyramid](https://user-images.githubusercontent.com/96368476/196890002-8588a98d-0040-4ade-af88-096ca962ff8b.png){: width="60%" height="70%" .align-center}

ìœ„ ê·¸ë¦¼ì€ í•œ octave ë‚´ì—ì„œ, DoGì˜ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚¸ ê²ƒì´ë‹¤. Ïƒê°€ ì‘ì€ ê²½ìš° ì‘ì€ blobì— ë°˜ì‘í•˜ë©°, Ïƒê°€ ì ì  ì»¤ì§ì— ë”°ë¼ í° blobì— ë°˜ì‘í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ëŸ° ë°©ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ ì „ì²´ì—ì„œ ì„ì˜ì˜ í¬ê¸°ì— ëŒ€í•œ bolbì„ ë¨¼ì € íƒì§€í•˜ê²Œ ëœë‹¤.

<br>

## Find Candidate Key Points

![find_extrema](https://user-images.githubusercontent.com/96368476/196891295-8e1eccaa-1d4c-42e2-997f-9533c3bb9a3b.png){: width="60%" height="70%" .align-center}

ë‹¨ìˆœíˆ Bolb Detectorì— ë°˜ì‘í•œë‹¤ê³  í•´ì„œ blobìœ¼ë¡œ ì¡ì•„ë²„ë¦¬ë©´ ìˆ˜ë§ì€ ì¤‘ë³µ íƒì§€ í˜„ìƒì´ ë‚˜íƒ€ë‚  ê²ƒì´ë‹¤. ë”°ë¼ì„œ Non-max suppressionê³¼ ê°™ì´ ì¤‘ë³µëœ íƒì§€ë¥¼ ì œê±°í•´ì•¼ í•˜ëŠ”ë° Gaussian Pyramidì˜ ê²½ìš° DoGì˜ ìƒìœ„ ì¸µê³¼ í•˜ìœ„ ì¸µê¹Œì§€ ëª¨ë‘ í•©ì³(3ì°¨ì› cube í˜•íƒœ) ì£¼ë³€ 26ê°œì˜ pixelë³´ë‹¤ í° ê²½ìš°ì—ë§Œ blobìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤. ì´ ê³¼ì • ì´í›„ ì‚´ì•„ë‚¨ì€ blobë“¤ì„ key point í›„ë³´ë“¤ë¡œ ê°„ì£¼í•˜ì—¬ ë‹¤ìŒ ìŠ¤í…ìœ¼ë¡œ ë„˜ê¸´ë‹¤.


<br>


# ğŸ“¹ Accurate Key Point

ìœ„ ê³¼ì •ì—ì„œ êµ¬í•œ key pointì˜ í›„ë³´ë“¤ì€ local maximum ê¸°ì¤€ì´ë‹¤. ì´ì œ ì—¬ê¸°ì—ì„œ ë‘ ê°€ì§€ ê²½ìš°ë¥¼ ì œì™¸í•  ê²ƒì´ë‹¤. ì²«ì§¸, local maximum ê°’ì´ íŠ¹ì • ê°’(threshold)ë³´ë‹¤ ì‘ì€ ê²½ìš°. ë‘˜ì§¸, í•´ë‹¹ key pointê°€ featureë¡œì„œì˜ ê°€ì¹˜ê°€ ì ì€ edgeì¸ ê²½ìš°.

<br>

## Remove under threshold vaule

ì´ ì§€ì ì—ì„œ ìš°ë¦¬ê°€ ì•Œê³  ì‹¶ì€ ê²ƒì€ local maximunì˜ ì‹¤ì œ ê°’ì´ë‹¤. í•˜ì§€ë§Œ ì£¼ì–´ì§„ DoG ê°’ì€ pixelë³„ë¡œ ì£¼ì–´ì§„ discreteí•œ ê°’ë“¤ì´ë‹¤. ë”°ë¼ì„œ 2ì°¨ Taylor ì „ê°œë¡œ interpolationí•¨ìœ¼ë¡œì„œ ì—°ì† í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ ì£¼ê³  ì´ í•¨ìˆ˜ì—ì„œì˜ maximun ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.

$$ D(X) = D + \frac{\partial D^{T}}{\partial X} X + \frac{1}{2}X^{T}\frac{\partial ^{2}D}{\partial X^{2}}X $$

$$ \hat{X} = -\frac{\partial ^{2} D^{-1}}{\partial X^{2}} \frac{\partial D}{\partial X} $$

$$ D(\hat{X}) = D + \frac{1}{2}\frac{\partial D^{T}}{\partial \hat(X)} $$

$$ if \; \left| D(\hat{X}) \right| < 0.03 \to \textit{Discard key} $$

- Taylor ì „ê°œë¥¼ í†µí•´ DoG í‘œí˜„
- Dë¥¼ ë¯¸ë¶„í•´ì„œ 0 ë‚˜ì˜¤ëŠ” x_hat ì°¾ê¸°
- x_hat ëŒ€ì…í•´ì„œ ìµœëŒ“ê°’ êµ¬í•˜ê¸°
- ìµœëŒ“ê°’ì´ 0.03ë³´ë‹¤ ì‘ìœ¼ë©´ key point í›„ë³´ì—ì„œ ì œì™¸

<br>

## Remove Edge Response

Edge ì œê±°ëŠ” ì´ì „ì— í¬ìŠ¤íŒ…í•œ Harris Corner Detectorë¥¼ ì´ìš©í•˜ë©´ ëœë‹¤. í•´ë‹¹ key pointì˜ R scoreê°€ ì ë‹¹í•œ thresholdë³´ë‹¤ ì‘ì€ ê²½ìš° key point í›„ë³´ì—ì„œ ì œê±°í•œë‹¤.

<br>

## Result

![keypoint](https://user-images.githubusercontent.com/96368476/196965654-d138f2f3-edc7-49ed-b3ad-90ec2db94888.png){: width="70%" height="80%" .align-center}

- (a) : Original Image
- (b) : Original imageì—ì„œ ì°¾ì€ key point í›„ë³´ (832ê°œ)
- (c) : ìµœëŒ“ê°’ì´ thresholdë³´ë‹¤ ì‘ì€ key point í›„ë³´ ì œê±° (729ê°œ)
- (d) : Harris Detectorë¡œ ì°¾ì€ Edge key point ì œê±° (536ê°œ)



<br>




[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}