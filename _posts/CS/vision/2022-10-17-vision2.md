---
title:  "[CV] Bolb Detection (DoG & LoG)" 

categories:
  -  Vision
tags:
  - [CS]

toc: true
toc_sticky: true

date: 2022-10-17
last_modified_at: 2022-10-17
---

**Main Reference: <br>- [Scale-Invariant-Feature Transform(SIFT) - í•œêµ­ê³¼í•™ê¸°ìˆ ì› ì „ê¸° ë° ì „ìê³µí•™ê³¼ ìµœì„±í•„](https://trekhleb.dev/blog/2021/content-aware-image-resizing-in-javascript/)**
{: .notice--warning}


<br>

# ğŸ“¹ Convolution vs Correlation

ë¨¼ì € vision ë¶„ì•¼ì—ì„œ ê³„ì† ë“±ì¥í•˜ëŠ” convolutionì˜ ê°œë…ì— ëŒ€í•´ ê°„ë‹¨íˆ ì‚´í´ë³´ì. MLì„ ê³µë¶€í•˜ë©´ì„œ ë§‰ì—°í•˜ê²Œ ì•Œê³  ìˆë˜ ê°œë…ì¸ë° ê½¤ë‚˜ ì¤‘ìš”í•œ ìˆ˜í•™ì  ì˜ë¯¸ë¥¼ ê°€ì§€ê³  ìˆì—ˆë‹¤. Correlationê³¼ ë¹„êµë¥¼ í†µí•´ ì´ë¥¼ ì•Œì•„ë³´ì.

$$\mathbf{Convolution  \quad  G = H \star F }$$

$$\textbf{G}\begin{bmatrix}i, j\end{bmatrix}= \sum_{u=-k}^{k}\sum_{v=-k}^{k}H[u,v]F[i-u, j-v]$$

<br>

$$\mathbf{Correlation  \quad  G = H \otimes F }$$

$$\textbf{G}\begin{bmatrix}i, j\end{bmatrix}= \sum_{u=-k}^{k}\sum_{v=-k}^{k}H[u,v]F[i+u, j+v]$$

<br>

![conv](https://user-images.githubusercontent.com/96368476/196095317-327b3280-26c3-4f7d-b68c-6dfd293c3c90.png){: width="40%" height="50%" .align-center}

ì‰½ê²Œ ì´ì•¼ê¸°í•˜ë©´ convolutionì€ filterê°€ ë’¤ì§‘ì–´ì§„ ìƒíƒœë¡œ ì§€ë‚˜ê°„ë‹¤ê³  ë³´ë©´ ëœë‹¤(2Dì˜ ê²½ìš° ìœ„ì•„ë˜ë¡œ ë’¤ì§‘ê³ , ì–‘ì˜†ìœ¼ë¡œ ë’¤ì§‘ê³ ). ì´ê²Œ ì™œ ì¤‘ìš”í•œê°€ ì‹¶ì§€ë§Œ Convolutionì€ Correlationì—ì„œ ì„±ë¦½í•˜ì§€ ì•ŠëŠ” êµí™˜ë²•ì¹™, ê²°í•©ë²•ì¹™ì´ ë³´ì¥ëœë‹¤. 


<br>


# ğŸ“¹ Edge Detection

ê°„ë‹¨í•œ Edge Detection ê³¼ì •ì„ ìƒê°í•´ë³´ì. ì§ê´€ì ìœ¼ë¡œ Edgeë€ ê¸°ìš¸ê¸°ê°€ ê¸‰ê²©í•˜ê²Œ ë³€í•˜ëŠ” ë¶€ë¶„ì„ ì°¾ìœ¼ë©´ ë  ê²ƒ ê°™ë‹¤. ì¦‰, graientì˜ í¬ê¸°ê°€ ì»¤ì§€ëŠ” ì§€ì ì¼ ê²ƒì´ë‹¤. ê°„ë‹¨í•˜ì§€ë§Œ í•©ë¦¬ì ì´ë¡œ ë³´ì´ëŠ” ì´ ë°©ë²•ì´ ì˜ ì‘ë™í• ê¹Œ? ì•„ì‰½ì§€ë§Œ ê·¸ë ‡ì§€ ì•Šë‹¤.

![noise](https://user-images.githubusercontent.com/96368476/196155065-04956a71-0de1-406b-b126-aaf74e7b411d.png){: width="60%" height="70%" .align-center}

ì‹¤ì œ ë°ì´í„°ì—ì„œëŠ” ìˆ˜ë§ì€ ë…¸ì´ì¦ˆê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— edge ë¶€ë¶„ì—ì„œë§Œ ê°’ì´ ì»¤ì§€ì§€ëŠ” ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ìš°ì„  Gaussian blurring(smoothing)ì„ í†µí•´ ë…¸ì´ì¦ˆë¥¼ ì œê±°í•œ ë’¤ gradientë¥¼ êµ¬í•´ì•¼ í•œë‹¤. ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì£¼ì–´ì§„ ì‹ í˜¸ë¥¼ gaussian filterì™€ convolutioní•œ í›„ì— ë¯¸ë¶„ì„ ì·¨í•˜ê²Œ ë˜ë©´ edgeë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.

![blurring](https://user-images.githubusercontent.com/96368476/196156057-44ecb7ac-75b7-4dd2-8f1b-39fbb54002f7.png){: width="60%" height="70%" .align-center}

<br>

$$\frac{d}{dx}\begin{pmatrix}f(x)\star g(x)\end{pmatrix} = \begin{pmatrix}\frac{d}{dx}f(x)\end{pmatrix}\star g(x)$$

Convolutionì€ ìœ„ì™€ ê°™ì€ íŠ¹ì´í•œ ë¯¸ë¶„ ë²•ì„ ê°€ì§€ê³  ìˆë‹¤. ë”°ë¼ì„œ gaussian filterì™€ fë¥¼ convolutioní•˜ê³  ë¯¸ë¶„ì„ ì·¨í•˜ëŠ” ê²ƒê³¼, gaussian filterì˜ ë¯¸ë¶„ê³¼ fë¥¼ convolutioní•œ ê²°ê³¼ê°€ ê°™ë‹¤. ì¦‰, gaussianì„ ë¯¸ë¦¬ ë¯¸ë¶„í•´ë†“ìœ¼ë©´ 2ë²ˆ ì—°ì‚°í•  ì¼ì„ 1ë²ˆë§Œ ì—°ì‚°í•˜ê³ ë„ êµ¬í•  ìˆ˜ ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤(convolution&derivative -> convolution).

<br>

![smoothing](https://user-images.githubusercontent.com/96368476/196164287-7845fc18-76f9-40aa-a90d-a932de515b37.png)


<br>

# ğŸ“¹ Sharpening Filter

Blurringì„ ì´ìš©í•œ ì¬ë°ŒëŠ” ì‘ìš©ì´ ìˆë‹¤. ë°ì´í„°ì—ëŠ” í•­ìƒ ë…¸ì´ì¦ˆê°€ ë¼ì–´ ìˆë‹¤. ë‹¤ë¥¸ ë§ë¡œ í•˜ë©´ ë°ì´í„°ëŠ” ë””í…Œì¼ íŒŒíŠ¸ì™€ ë…¸ì´ì¦ˆ íŒŒíŠ¸ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ë§Œì•½ ì›ë³¸ ë°ì´í„°ì— ë…¸ì´ì¦ˆê°€ ì œê±°ëœ ë””í…Œì¼ íŒŒíŠ¸ë¥¼ ë”í•´ì¤€ë‹¤ë©´ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚ ê¹Œ? ì •ë‹µì€ ë””í…Œì¼ ë¶€ë¶„ì´ ê°•ì¡°ëœë‹¤. ì´ë¥¼ **Sharpening** ê¸°ë²•ì´ë¼ í•œë‹¤.

| Filter | Sharpening |
|:-:|:-:|
|![sharpening filter](https://user-images.githubusercontent.com/96368476/196190380-f3d31c10-617c-440d-b1d5-db22bb6721b0.png)|![sharpening](https://user-images.githubusercontent.com/96368476/196190389-63718e1a-fa46-4ff7-a51d-d774959148bb.png)|



<br>

# ğŸ“¹ Blob Detection

<br>

## Laplacian of Gaussian (LoG)

| Laplacian of Gaussian | Blob Scale |
|:-:|:-:|
|![LoG](https://user-images.githubusercontent.com/96368476/196193254-36509e9e-9265-46c3-bb37-7dd31261cfec.png)|![blob_scale](https://user-images.githubusercontent.com/96368476/196194712-38e11656-6d0a-484c-8cc9-ebccaae94a6d.png)|

Blobì´ë€ ì´ë¯¸ì§€ ë‚´ì—ì„œ ì£¼ë³€ì— ë¹„í•´ íŠ¹íˆ ë°ì•„ì§€ê±°ë‚˜ ì–´ë‘ì›Œì§€ëŠ” ë¶€ë¶„ì„ ë§í•œë‹¤. ì£¼ë¡œ featureì˜ í¬ê¸°ë¥¼ ê²°ì •í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤(SIFTì—ì„œ ë‹¤ì‹œ ë“±ì¥). ë³´í†µ Blobì„ íƒì§€í•  ë•Œì—ëŠ” ê°€ìš°ì‹œì•ˆ í•¨ìˆ˜ë¥¼ ë‘ ë²ˆ ë¯¸ë¶„í•œ, Laplacian of Gaussian (LoG) Filterë¥¼ ì´ìš©í•œë‹¤. ê°€ìš°ì‹œì•ˆì€ ì–´ì©œ ì´ë¦¬ ë§ŒëŠ¥ì¼ê¹Œ.. ì´ë•Œ Blob Detectionì—ì„œ ì£¼ì˜í•  ì§€ì ì´ ìˆë‹¤. Blob scaleì— ë”°ë¼ ê°€ìš°ì‹œì•ˆì˜ Ïƒ ê°’ì„ ì¡°ì ˆí•´ ì£¼ì–´ì•¼ í•œë‹¤. ì¦‰, í° blobì˜ ê²½ìš° Ïƒê°€ í° ëš±ëš±í•œ ê°€ìš°ì‹œì•ˆì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ë²ˆê±°ë¡­ì§€ë§Œ íƒì§€í•œ featureì˜ scaleì„ ê²°ì •í•˜ê¸° ìœ„í•´ì„œëŠ” Ïƒë¥¼ ë³€ê²½í•´ê°€ë©° blob detectionì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.

<br>

## Difference of Gaussian (DoG)

LoG ê¸°ë²•ì€ blobì„ ê¸°ê°€ ë§‰íˆê²Œ ì°¾ì§€ë§Œ ë‹¨ì ì´ ì¡´ì¬í•œë‹¤. ë°”ë¡œ Laplacian of Gaussianì„ Ïƒë¥¼ ë°”ê¿”ê°€ë©° convolution í•´ì•¼í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë‹¤ ì¢‹ì€ë° ë„ˆë¬´ ë¹„ì‹¸ë‹¤. ê·¸ëŸ°ë° ì´ë¥¼ ê¸°ê°€ ë§‰íˆê²Œ ìš°íšŒí•˜ëŠ” ë°©ë²•, Difference of Gaussian (DoG) ê¸°ë²•ì´ ì¡´ì¬í•œë‹¤. 

<br>

| Graph | LoG vs DoG |
|:-:|:-:|
|![graph-dog](https://user-images.githubusercontent.com/96368476/196207112-7c329bc5-2700-4384-9068-83fb832db610.png){: width="70%" height="80%" .align-center}|![DoG](https://user-images.githubusercontent.com/96368476/196207113-4688a320-5de0-4344-a547-f94dcdc20a32.png)|


Difference of Gaussianì€ ë§ ê·¸ëŒ€ë¡œ ë‘ gaussianì˜ ì°¨ë¥¼ ì´ìš©í•˜ì—¬ Laplacianì„ ê³„ì‚°í•˜ê² ë‹¤ëŠ” ê²ƒì´ë‹¤. ì™¼ìª½ ê·¸ë¦¼ì˜ ë¹¨ê°„ ê·¸ë˜í”„ëŠ” Laplcian of Gaussianì´ë‹¤. ê·¸ë˜í”„ì—ì„œ ë‘êº¼ìš´ ê°€ìš°ì‹œì•ˆì—ì„œ ì–‡ì€ ê°€ìš°ì‹œì•ˆì„ ë¹¼ë©´ ë¹¨ê°„ ê·¸ë˜í”„ ëª¨ì–‘ì´ ë‚˜ì˜¨ë‹¤ëŠ” ê²ƒì„ ìœ ì¶”í•  ìˆ˜ ìˆë‹¤. (ì´ëŸ° ë‚´ìš©ì„ ì–´ë–»ê²Œ ë°œê²¬í–ˆì„ê¹Œ?) ì¦‰, ìš°ë¦¬ëŠ” Gaussianì˜ ë³µì¡í•œ laplacianì„ ê³„ì‚°í•˜ì§€ ì•Šê³ ë„ laplacian ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤! ì´ ë‚´ìš©ì´ ë°”ë¡œ  SIFTì—ì„œ ë“±ì¥í•  Gaussian Pyramidì˜ í•µì‹¬ ê°œë…ì´ë‹¤.


<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}