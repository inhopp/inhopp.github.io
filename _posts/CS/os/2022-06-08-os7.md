---
title:  "Chapter7. êµì°©ìƒíƒœ" 

categories:
  -  OS
tags:
  - [CS, OS]

toc: true
toc_sticky: true

date: 2022-06-08
last_modified_at: 2022-06-08
---

ìœ íŠœë¸Œì— ìˆëŠ” ê¹€ë•ìˆ˜ êµìˆ˜ë‹˜ì˜ **[Operating System](https://www.youtube.com/watch?v=EdTtGv9w2sA&list=PLBrGAFAIyf5rby7QylRc6JxU5lzQ9c4tN)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.<br>
ì¤‘ê°„ì— ë“±ì¥í•˜ëŠ” ppt ë‚´ìš©ë“¤ì€ ëª¨ë‘ ê°•ì˜ìë£Œë¥¼ ìº¡ì²˜í•œ ê²ƒì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ”§ êµì°©ìƒíƒœ (Deadlock)

![7-1](https://user-images.githubusercontent.com/96368476/172558656-6aa9e4ba-889d-444c-8c01-f89e203ff00d.jpeg){: width="60%" height="70%" .align-center}

**Deadlock State**
- í”„ë¡œì„¸ìŠ¤ê°€ ë°œìƒ ê°€ëŠ¥ì„±ì´ ì—†ëŠ” ì´ë²¤íŠ¸ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ìƒíƒœ
  - í”„ë¡œì„¸ìŠ¤ê°€ deadlock ìƒíƒœì— ìˆìŒ
- ì‹œìŠ¤í…œ ë‚´ì— deadlockì— ë¹ ì ¸ìˆëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ìˆëŠ” ê²½ìš°
  - ì‹œìŠ¤í…œì´ deadlock ìƒíƒœì— ìˆìŒ


<br>


## Deadlock vs Starvation

![7-2](https://user-images.githubusercontent.com/96368476/172558663-7172c1b1-adb8-4f65-a123-dc02a296a46f.png){: width="70%" height="80%" .align-center}

- deadlock ìƒíƒœì— ë¹ ì§„ í”„ë¡œì„¸ìŠ¤ê°€ ê¸°ë‹¤ë¦¬ëŠ” ì´ë²¤íŠ¸ëŠ” ë°œìƒ ê°€ëŠ¥ì„±ì´ ì—†ìŒ
- starvation ìƒíƒœì— ë¹ ì§„ í”„ë¡œì„¸ìŠ¤ëŠ” ìˆœì„œê°€ ê³„ì† ë°€ë¦¬ëŠ” ìƒí™© (ì–¸ì  ê°€ëŠ” ë°œìƒ)



<br>


# ğŸ”§ Types of Resources (ìì›ì˜ ë¶„ë¥˜)

> ì¼ë°˜ì ìœ¼ë¡œëŠ” HW resources & SW resources

<br>

## ì„ ì  ê°€ëŠ¥ ì—¬ë¶€ì— ë”°ë¥¸ ë¶„ë¥˜

- **Preemptible resources**
  - ì¤‘ê°„ì— ì„ ì  ë‹¹í•œ í›„(ëºê¸´ í›„) ëŒì•„ì™€ë„ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” ìì›
  - ex) Processor, Memory, ...

<br>

- **Non-preemptible resources**
  - ì„ ì  ë‹¹í•˜ë©´ ì´í›„ ì§„í–‰ì— ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ìì›
    - Rollbackì´ í•„ìš”í•˜ë‹¤ê±°ë‚˜, restartê°€ í•„ìš”í•˜ë‹¤ê±°ë‚˜, ...
  - ex) Disk, Drive, ...


<br>


## í• ë‹¹ ë‹¨ìœ„ì— ë”°ë¥¸ ë¶„ë¥˜

- **Total allocation resources**
  - ìì› ì „ì²¸ë¥¼ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹
  - ex) Processor, Disk, Drive, ...

<br>

- **Partitioned allocation resources**
  - í•˜ë‚˜ì˜ ìì›ì„ ì—¬ëŸ¬ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ë“¤ì—ê²Œ í• ë‹¹
  - ex) Memory, ...


<br>


## ë™ì‹œ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ì— ë”°ë¥¸ ë¶„ë¥˜

- **Exclusive allocation resources**
  - ë™ì‹œì— í•œ í”„ë¡œì„¸ìŠ¤ë§Œ ì‚¬ìš© ê°€ëŠ¥í•œ ìì›
  - ex) Processor, Memory, Disk, Drivve, ...

<br>

- **Shared allocation resources**
  - ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ì‚¬ìš© ê°€ëŠ¥í•œ ìì›
  - ex) Program(SW), shared data, ...


<br>


## ì¬ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ì— ë”°ë¥¸ ë¶„ë¥˜

- **Serially-reusable resources (SR)**
  - ì‹œìŠ¤í…œ ë‚´ì— í•­ìƒ ì¡´ì¬í•˜ëŠ” ìì›
  - ì‚¬ìš©ì´ ëë‚˜ë©´ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ì‚¬ìš© ê°€ëŠ¥
  - ex) Processor, Memory, Disk, Program, ...

<br>

- **Consumable resources (CR)**
  - í”„ë¡œì„¸ìŠ¤ê°€ ì‚¬ìš©í•œ í›„ì— ì‚¬ë¼ì§€ëŠ” ìì›
  - ex) signal, message, ...



<br>


## Deadlock ê³¼ Resource type

- **Deadlockì„ ë°œìƒì‹œí‚¬ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ìì›ì˜ í˜•íƒœ**
  - Non-preemptible resources
  - Exclusive allocation resources
  - Serially reusable resources
  - (í• ë‹¹ ë‹¨ìœ„ëŠ” ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠìŒ)

<br>

- ì´ë•Œ CRì„ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” Deadlock ëª¨ë¸ì€ ë„ˆë¬´ ë³µì¡í•´ì„œ ë‹¤ë£¨ì§€ ì•ŠìŒ



<br>


# ğŸ”§ Deadlock ë°œìƒ í•„ìš” ì¡°ê±´

> 4 ê°€ì§€ ì¡°ê±´ì´ ëª¨ì£¼ ë§Œì¡±ë˜ì–´ì•¼ deadlock ë°œìƒ

![7-5](https://user-images.githubusercontent.com/96368476/172558651-238d5c84-fa4e-4a61-b6bc-286c7cf1e766.png){: width="70%" height="80%" .align-center}


<br>


# ğŸ”§ Deadlock í•´ê²° ë°©ë²•

- Deadlock **prevention** methods (ì˜ˆë°©)
- Deadlock **avoidance** methods (íšŒí”¼)
- Deadlock **detection** and deadlock **recovery** methods (íƒì§€ ë° ë³µêµ¬)


<br>


## Deadlock prevention

- 4ê°œì˜ deadlock ë°œìƒ í•„ìš” ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¥¼ ì œê±°
  - Exclusive use of resources
  - Non-preemptible resources
  - Hold and wait (Partial allocation)
  - Circular wait
- Deadlock ì ˆëŒ€ ë°œìƒí•˜ì§€ ì•ŠìŒ
- **<span style="color:red">ì‹¬ê°í•œ ìì› ë‚­ë¹„ ë°œìƒ</span>**
- ë¹„í˜„ì‹¤ì 


<br>


## Deadlock avoidance

- ì‹œìŠ¤í…œì˜ ìƒíƒœë¥¼ ê³„ì† ê°ì‹œ
  - ì‹œìŠ¤í…œì„ í•­ìƒ safe stateë¡œ ìœ ì§€
  - ëª¨ë“  í”„ë¡œì„¸ìŠ¤ê°€ ì •ìƒì  ì¢…ë£Œê°€ ê°€ëŠ¥í•œì§€
  - deadlock ë°œìƒ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ìì›ì€ ì‹œìŠ¤í…œì´ í• ë‹¹ ìš”ì²­ì„ ë³´ë¥˜

<br>

- Deadlock ë°œìƒì„ ë§‰ì„ ìˆ˜ ìˆìŒ
- High overhead
  - ì‹œìŠ¤í…œì„ í•­ìƒ ê°ì‹œí•˜ê³  ìˆì–´ì•¼ í•¨
- Low resource utilizatioon
  - safe state ìœ ì§€ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ìì›ì´ ì¡´ì¬
- ì—¬ëŸ¬ê°€ì§€ ê°€ì •ì´ í•„ìš”í•¨ (ë¹„í˜„ì‹¤ì )
  - í”„ë¡œì„¸ìŠ¤ ìˆ˜, ìì› ìˆ˜ ê³ ì •
  - í•„ìš”í•œ ìµœëŒ€ ìì› ìˆ˜ë¥¼ ì•Œê³ ìˆìŒ
  - ë“±...


<br>


# ğŸ”§ Deadlock detection and recovery

## Deadlock datection

- Deadlock ë°©ì§€ë¥¼ ìœ„í•œ ì‚¬ì „ ì‘ì„ í•˜ì§€ ì•ŠìŒ
- ì£¼ê¸°ì ìœ¼ë¡œ deadlock ë°œìƒ ì—¬ë¶€ í™•ì¸
  - ì‹œìŠ¤í…œì´ deadlock ìƒíƒœì¸ê°€?
  - ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ê°€ deadlock ìƒíƒœì¸ê°€?
- Resource Allocation Graph (RAG) ì‚¬ìš©
- High overhead
  - ê²€ì‚¬ ì£¼ê¸°ì— ì˜í–¥ì„ ë°›ìŒ
  - Nodeì˜ ìˆ˜ê°€ ë§ì€ ê²½ìš°

<br>

## Resource Allocation Graph (RAG)

![7-6](https://user-images.githubusercontent.com/96368476/172572755-7bf800cb-a73b-4872-82e0-e7f512294550.png){: width="50%" height="60%" .align-center}

- Graph reduction
  - í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ìš”ì²­í•œ ìì›ì„ ëª¨ë‘ í• ë‹¹ ë°›ì„ ìˆ˜ ìˆìœ¼ë©´ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ì™€ ì—°ê²°ëœ ëª¨ë“  edge ì œê±°
  - ë°˜ë³µ
- **Completely reduced**
  - ëª¨ë“  edgeê°€ ì œê±°ë¨
  - deadlockì— ë¹ ì§„ í”„ë¡œì„¸ìŠ¤ê°€ ì—†ìŒ
- **Irreducible**
  - ì§€ìš¸ ìˆ˜ ì—†ëŠ” edgeê°€ ì¡´ì¬
  - deadlockì— ë¹ ì§„ í”„ë¡œì„¸ìŠ¤ê°€ í•˜ë‚˜ ì´ìƒ ì¡´ì¬


<br>

| Completely reduced | Irreducible |
|:-:|:-:|
| ![7-7](https://user-images.githubusercontent.com/96368476/172572759-c61bb224-9215-4953-80df-332e49d89d51.png) | ![7-8](https://user-images.githubusercontent.com/96368476/172572745-dad070cf-26ef-4e06-9e2b-c723d2e16c95.png) |



<br>


## Deadlock recovery

- **Deadlock recovery methods**
  - Process termination
    - Deadlock ìƒíƒœì— ìˆëŠ” í”„ë¡œì„¸ìŠ¤ ê°•ì œ ì¢…ë£Œ
    - ì¢…ë£Œëœ í”„ë¡œì„¸ìŠ¤ëŠ” ì´í›„ ì¬ì‹œì‘
  - Resource preemption
    - Deadlock ìƒíƒœ í•´ê²°ì„ ìœ„í•´ ì„ ì í•  ì €ì› ì„ íƒ
    - ì„ ì • ëœ ìì›ì„ ê°€ì§€ê³  ìˆëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ê°•ì œ ì¢…ë£Œì‹œí‚¤ê³  ìì›ì„ ë¹¼ì•—ìŒ


<br>


### Process termination

- **Termination cost model**
  - Process priority (ìš°ì„ ìˆœìœ„)
  - Process type (ì¢…ë¥˜)
  - Accumulated execution time of the process (ì´ ìˆ˜í–‰ ì‹œê°„)
  - Remaining time of the process (ë‚¨ì€ ìˆ˜í–‰ ì‹œê°„)
  - Accounting cost (ì¢…ë£Œ ë¹„ìš©)
  - Etc...

<br>

- **Lowest-termination cost process first**
  - cost ì œì¼ ë‚®ì€ ë†ˆ ì„ íƒí•´ì„œ ì¢…ë£Œ
  - simple / low overhead
  - ë¶ˆí•„ìš”í•œ í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì¢…ë£Œ ë  ê°€ëŠ¥ì„±ì´ ë†’ìŒ
  - (êµ³ì´ ëŒ í•„ìš” ì—†ëŠ”)
- **Minimum cost recovery**
  - ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ ê³ ë ¤ / O(2^n)
  - ìµœì†Œ ë¹„ìš©ìœ¼ë¡œ deadlock ìƒíƒœë¥¼ í•´ì†Œí•  ìˆ˜ ìˆëŠ” í”„ë¡œì„¸ìŠ¤ ì„ íƒ
  - complex / high overhead



<br>


### Resource preemption

- Process terminationê³¼ ë§ˆì°¬ê°€ì§€ë¡œ
  - Preemption cost model ì •ì˜
  - Minimum cost recovery method ì‚¬ìš©


<br>


### Checkpoint-restart method

![7-9](https://user-images.githubusercontent.com/96368476/172577691-76a0b32b-884f-4662-963a-d545a256365d.png){: width="70%" height="80%" .align-center}

- ì¢…ë£Œëœ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•  ë•Œ Rollbackì„ ìœ„í•´ ì‚¬ìš©
- í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜í–‰ ì¤‘ íŠ¹ì • ì§€ì (checkpoint) ë§ˆë‹¤ context ì €ì¥
- ê°€ì¥ ìµœê·¼ì˜ checkpointì—ì„œ ì¬ì‹œì‘ 







<br>




[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}