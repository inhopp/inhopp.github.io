---
title:  "Chapter6. ë™ê¸°í™” & ìƒí˜¸ë°°ì œ" 

categories:
  -  OS
tags:
  - [CS, OS]

toc: true
toc_sticky: true

date: 2022-06-07
last_modified_at: 2022-06-07
---

ìœ íŠœë¸Œì— ìˆëŠ” ê¹€ë•ìˆ˜ êµìˆ˜ë‹˜ì˜ **[Operating System](https://www.youtube.com/watch?v=EdTtGv9w2sA&list=PLBrGAFAIyf5rby7QylRc6JxU5lzQ9c4tN)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.<br>
ì¤‘ê°„ì— ë“±ì¥í•˜ëŠ” ppt ë‚´ìš©ë“¤ì€ ëª¨ë‘ ê°•ì˜ìë£Œë¥¼ ìº¡ì²˜í•œ ê²ƒì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ”§ ë™ê¸°í™”  (Synchronization)

![6-1](https://user-images.githubusercontent.com/96368476/172198100-5d5bd0d4-019f-4c73-95d2-980810ebe522.png){: width="70%" height="80%" .align-center}


**Multi Programming System**
- ì—¬ëŸ¬ ê°œì˜ í”„ë¡œì„¸ìŠ¤ë“¤ ì¡´ì¬
- ê° í”„ë¡œì„¸ìŠ¤ë“¤ì€ ì„œë¡œ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘
- **<span style="color:red">ì—¬ëŸ¬ ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ê³µìœ  ë°ì´í„°ì— ì ‘ê·¼í•  ë•Œ ë¬¸ì œ ë°œìƒ ê°€ëŠ¥</span>**
- **<span style="color:red">ìì›ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìš”ì²­&ë°°ë¶„í•˜ê¸° ìœ„í•´ì„œëŠ” ê° í”„ë¡œì„¸ìŠ¤ë“¤ì˜ ì •ë³´ ê³µìœ ê°€ í•„ìš”í•¨</span>**

## ìš©ì–´ ì •ë¦¬

- Shared data (or Critical data)
  - ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ë“¤ì´ ê³µìœ í•˜ëŠ” ë°ì´í„°
- Critical Section
  - ê³µìœ  ë°ì´í„°ì— ì ‘ê·¼í•˜ëŠ” ì½”ë“œ ì˜ì—­ (code segment)
- Concurrent (ë³‘í–‰)
  - ì—¬ëŸ¬ ê°œì˜ í”„ë¡œì„¸ìŠ¤ë“¤ì´ ë™ì‹œì— ì‹œìŠ¤í…œì— ì¡´ì¬

<br>

- Synchronization (ë™ê¸°í™”)
  - í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì„œë¡œ ë™ì‘ì„ ë§ì¶¤
  - í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì„œë¡œ ì •ë³´ë¥¼ ê³µìœ 
- Asynchronization (ë¹„ë™ê¸°í™”)
  - í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì„œë¡œì— ëŒ€í•´ ëª¨ë¦„



<br>


# ğŸ”§ ìƒí˜¸ë°°ì œ (Mutual Exclusion)

| ì½”ë“œ | ì‹¤ì œ ê¸°ê³„ì–´ ë™ì‘ |
|:-:|:-:|
| ![6-1](https://user-images.githubusercontent.com/96368476/172198100-5d5bd0d4-019f-4c73-95d2-980810ebe522.png) | ![6-2](https://user-images.githubusercontent.com/96368476/172198101-819b5652-cda1-422b-a23b-86624736d3a8.png) |


- í”„ëŸ¬ì„¸ìŠ¤ piì˜ ê¸°ê³„ì–´ ëª…ë ¹ ì‚¬ì´ì— í”„ë¡œì„¸ì„œë¥¼ ëºê¸°ë©´ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ
- +1 í–ˆëŠ”ë° +2 ê²°ê³¼ë¡œ ë‚˜ì˜¬ ìˆ˜ë„.. (addì™€ store ì‚¬ì´ì—ì„œ í”„ë¡œì„¸ì„œ pjê°€ ë‚œì…)
- **<span style="color:red">ì´ëŸ° ìƒí™©ì„ ë§‰ê¸° ìœ„í•´ ë‘˜ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— critical sectionì— ì§„ì…í•˜ëŠ” ê²ƒì„ ë§‰ìŒ â†’ ìƒí˜¸ ë°°ì œ</span>**


<br>

## Mutual exclusion methods

![6-0](https://user-images.githubusercontent.com/96368476/172200659-450b684e-21bf-455a-8b31-83c373e34e3e.png){: width="60%" height="70%" .align-center}

**Mutual exclusion primitives**
- enterCS() primitive
  - Critical section ì§„ì… ì „ í™•ì¸
  - ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ critical section ì•ˆì— ìˆëŠ”ì§€ í™•ì¸
- exitCS() primitive
  - Critical section ë²—ì–´ë‚  ë•Œ í›„ì²˜ë¦¬
  - Critical section ë²—ì–´ë‚¬ìŒì„ ì‹œìŠ¤í…œì— ì•Œë¦¼



<br>


## Requirments for ME primitives

Mutual exclusion primitivesê°€ ë˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•¨ (ì‰½ì§€ ì•Šë‹¤)

- **Mutual exclusion**
  - Critical section(CS)ì— í”„ë¡œì„¸ìŠ¤ê°€ ìˆìœ¼ë©´ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì˜ ì§„ì…ì„ ê¸ˆì§€
- **Progress**
  - CS ì•ˆì— ìˆëŠ” í”„ë¡œì„¸ìŠ¤ ì™¸ì—ëŠ” ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ CSì— ì§„ì…í•˜ëŠ” ê²ƒì„ ë°©í•´í•˜ë©´ ì•ˆë¨
  - CS ë°–ì—ì„œ ì´ë˜ë¼ ì €ë˜ë¼ í•˜ë©´ ì•ˆë¨
- **Bounded waiting (í•œì •ëŒ€ê¸°)**
  - í”„ë¡œì„¸ìŠ¤ì˜ CS ì§„ì…ì„ ë¬´í•œí•˜ê²Œ ê¸°ë‹¤ë¦¬ë©´ ì•ˆë¨




<br>



# ğŸ”§ Mutual exclusion solutions

- SW solution
  - Dekker's algorithm (Peterson's algorithm)
  - Dijkstra's algorithm
- HW solution
  - TestAndSet(TAS) instruction
- OS supported SW solution
  - Spinlock
  - Semaphore
  - Eventcount/sequencer
- Language-Level solution


<br>


## SW solution

### Dekker's algorithm

![6-3](https://user-images.githubusercontent.com/96368476/172198107-1e14a5e0-7e90-49ce-a838-6ae9b3660a26.png){: width="70%" height="80%" .align-center}

- Two process MEë¥¼ ë³´ì¥í•˜ëŠ” ìµœì´ˆì˜ ì•Œê³ ë¦¬ì¦˜
- flagë§Œìœ¼ë¡œëŠ” MEì˜ ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ì§€ ëª»í•¨
- flag & turn ì‚¬ìš©
- Peterson's algorithm : Dekker's algorithm ë³´ë‹¤ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„


<br>


### Dijkstra's algorithm
![6-4](https://user-images.githubusercontent.com/96368476/172198110-d881ede5-5fea-4c54-b0f2-24b55ac0f8e9.png){: width="70%" height="80%" .align-center}

- flag[] ë³€ìˆ˜
  - idle: CSì§„ì… ì‹œë„í•˜ê³  ìˆì§€ ì•ŠìŒ
  - want-in: CS ì§„ì… ì‹œë„ 1ë‹¨ê³„ 
    - (ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ì“°ê³ ìˆìœ¼ë©´ ëë‚  ë•Œê¹Œì§€ ê³„ì† ì²´í¬í•˜ë©´ì„œ ëŒ€ê¸°)
  - in-CS: CS ì§„ì… ì‹œë„ 2ë‹¨ê³„ or CS ë‚´ì— ìˆì„ ë•Œ
- nê°œì˜ í”„ë¡œì„¸ìŠ¤ ìƒí˜¸ë°°ì œ ë¬¸ì œë¥¼ í•´ê²°í•œ ìµœì´ˆì˜ ì•Œê³ ë¦¬ì¦˜


<br>


### SW solutionì˜ í•œê³„

- ME primitive ì‹¤í–‰ ì¤‘ preemption ë°©ì§€í•˜ê¸° í˜ë“¬
  - ëŠë ¤ì§€ê³  êµ¬í˜„ì´ ë³µì¡
- Busy waiting problem
  - ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ëë‚  ë•Œ ê¹Œì§€ ê³„ì† ì²´í¬
  - ë¹„íš¨ìœ¨ì  


<br>


## HW solution

![6-6](https://user-images.githubusercontent.com/96368476/172209323-5fd364eb-f1ea-41d8-b378-e5b8bc69e9c8.png){: width="60%" height="70%" .align-center}

- Testì™€ setì„ í•œë²ˆì— ìˆ˜í–‰í•˜ëŠ” ê¸°ê³„ì–´
- ê¸°ê³„ì–´ ì‹¤í–‰ ì¤‘ inturrupt (preemption)ë¥¼ í•˜ë“œì›¨ì–´ê°€ ë§‰ì•„ì¤Œ
- ì¥ì : êµ¬í˜„ì´ ê°„ë‹¨
- ë‹¨ì : Busy waiting problem


<br>


## OS supported SW solution

> Preemptionì„ OSê°€ ë§‰ì•„ì¤€ë‹¤!


### Spinlock

![6-7](https://user-images.githubusercontent.com/96368476/172214600-953ca221-d1ce-4bf7-a49b-ecef02690ef4.png){: width="70%" height="80%" .align-center}

- active = 1: CS ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì—†ìŒ
- active = 0: CS ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ìˆìŒ
- P(S): ë‚´ê°€ ì“´ë‹¤ (ìë¬¼ì‡  ì ê¸ˆ)
- V(S): ì˜ ë†€ë‹¤ ê°‘ë‹ˆë‹¤ (ì ê¸ˆ í•´ì œ)
- **Busy waiting problem ì—¬ì „í•¨**


<br>


## Semaphor 

| semaphor | P(), V() |
|:-:|:-:|
| ![6-8](https://user-images.githubusercontent.com/96368476/172214602-99d82872-2088-4d6c-84d5-c92f5f571cb8.png) | ![6-9](https://user-images.githubusercontent.com/96368476/172216992-97a62b33-11da-4db8-a217-77cfd700b21c.png) |

- 1965ë…„ Dijkstraê°€ ì œì•ˆ
- **<span style="color:red">Busy waiting problem í•´ê²°!</span>**
  - ëŒ€ë¶€ë¶„ì˜ osê°€ ì‚¬ìš©
- ìŒì´ ì•„ë‹Œ ì •ìˆ˜í˜• ë³€ìˆ˜ S
  - ì´ˆê¸°í™”, P(), V()ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥
  - P: Probern (ê²€ì‚¬)
  - V: Verhogen (ì¦ê°€)
  - S í•˜ë‚˜ ë‹¹ ready queue í•˜ë‚˜ í• ë‹¹


<br>


### Process synchronization

![6-10](https://user-images.githubusercontent.com/96368476/172216997-0a4eae8c-6c6d-4e76-ae8a-d0706856ef4a.png){: width="70%" height="80%" .align-center}

- ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë“¤ì˜ ì‹¤í–‰ ìˆœì„œ ë§ì¶”ê¸°
- Syncë¼ëŠ” semaphoreë³€ìˆ˜ ì„ ì–¸ (CSì²˜ëŸ¼ ë‹¤ë£¨ê¸°)



<br>


### Producer-Consumer problem

![6-11](https://user-images.githubusercontent.com/96368476/172217002-9c0e4595-e818-47f4-b832-06c1efb77f71.png){: width="70%" height="80%" .align-center}

- Producer í”„ë¡œì„¸ìŠ¤
  - ë©”ì‹œì§€ë¥¼ ìƒì„±í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹
- Cosumer í”„ë¡œì„¸ìŠ¤
  - ë©”ì‹œì§€ë¥¼ ì „ë‹¬ë°›ëŠ” í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹
- ë©”ì‹œì§€ ìƒì‚°ì´ ëë‚˜ê¸° ì „ì— ì†Œë¹„í•˜ë©´ ì•ˆë¨
- bufferë¥¼ CSì²˜ëŸ¼ ë‹¤ë£¸


<br>


### Producer-Consumer problem with N-buffers

![6-12](https://user-images.githubusercontent.com/96368476/172217004-de5126ce-47f7-4839-8ca5-85d0e24287cd.png){: width="70%" height="80%" .align-center}

<br>

![6-13](https://user-images.githubusercontent.com/96368476/172217005-5c122738-a039-4b10-a56d-ee34e4b98723.png){: width="70%" height="80%" .align-center}


<br>


### Reader-Writer problem

![6-14](https://user-images.githubusercontent.com/96368476/172217006-77092fb1-a0f7-4377-9966-9153ad61acdd.png){: width="70%" height="80%" .align-center}

- Reader: ë°ì´í„° ì½ê¸° ì—°ì‚°ë§Œ ìˆ˜í–‰
- Writer: ë°ì´í„° ê°±ì‹  ì—°ì‚°ì„ ìˆ˜í–‰
- Readerë“¤ì€ ë™ì‹œì— ì ‘ê·¼ ê°€ëŠ¥
- Writerë¼ë¦¬ or Readerì™€ Writer ë™ì‹œ ì ‘ê·¼ì€ ìƒí˜¸ë°°ì œ(ë™ê¸°í™”) í•„ìš”
  - reader/writer ìš°ì„ ê¶Œ ë¶€ì—¬
  - ìœ„ ì˜ˆì‹œëŠ” reader preference solution



<br>


### Semaphore íŠ¹ì§•

- No busy waiting
  - ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ëŠ” block(asleep)ìƒíƒœê°€ ë¨
  - ê³„ì† í™•ì¸í•  í•„ìš” X (ëŒ€ê¸°ì‹¤ì—ì„œ í¸í•˜ê²Œ ëŒ€ê¸°)
- Semaphore queueì— ëŒ€í•œ wake-up ìˆœì„œëŠ” ë¹„ê²°ì •ì 
  - Starvation problem ìƒê¸¸ ìˆ˜ ìˆìŒ
  - ëŒ€ê¸° ì¤‘ì¸ë° ê³„ì† ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ ë“¤ì–´ì˜¤ë©´..


<br>


## Eventcount / Sequencer

- ì€í–‰ì˜ ë²ˆí˜¸í‘œ ê°œë…
- Sequencer (í‘œ ë½‘ì•„ì£¼ëŠ” ê¸°ê³„)
  - ì •ìˆ˜í˜• ë³€ìˆ˜
  - ìƒì„±ì‹œ ì´ˆê¸°ê°’ 0, ì¦ê°€ë§Œ í•¨
  - ë°œìƒ ì´ë²¤íŠ¸ë“¤ì˜ ìˆœì„œ ìœ ì§€
  - ticket() ì—°ì‚°ìœ¼ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ticket(S)
  - í˜„ì¬ê¹Œì§€ ticket() ì—°ì‚°ì´ í˜¸ì¶œëœ íšŸìˆ˜ ë°˜í™˜
  - Indivisible operation (os supported)

<br>

### Primitives

![6-15](https://user-images.githubusercontent.com/96368476/172221781-6921f5df-c275-4103-803c-02a487531444.png){: width="60%" height="70%" .align-center}

- Eventcount
  - sequencer
  - read(E), advance(E), await(E) ì—°ì‚°ìœ¼ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥
- read(E)
  - í˜„ì¬ Eventcount ê°’ ë°˜í™˜
- advance(E)
  - E â† E + 1
  - E ê¸°ë‹¤ë¦¬ê³  ìˆëŠ” í”„ë¡œì„¸ìŠ¤ ê¹¨ì›€(wake-up)
  - ëµë™
- await(E,v)
  - vëŠ” ì •ìˆ˜í˜• ë³€ìˆ˜
  - if(E< v) ì´ë©´ Eì— ì—°ê²°ê´¸ queue(E)ì— í”„ë¡œì„¸ìŠ¤ ì „ë‹¬(push) ë° CPU scheduler í˜¸ì¶œ
  - queue: ëŒ€ê¸°ì‹¤ & ë‚´ ë²ˆí˜¸ ì˜¤ë©´ ê¹¨ì›Œë‹¬ë¼ê³  schedularì— ë¶€íƒ


<br>


### Producer-Cunsumer problem

![6-16](https://user-images.githubusercontent.com/96368476/172221785-080810e1-c04f-4892-bc55-380474cb4ba5.png){: width="70%" height="80%" .align-center}

<br>


### Eventcount / Sequencer íŠ¹ì§•

- No busy waiting
- No starvation
  - FIFO scheduling for Q(E)
- Semaphore ë³´ë‹¤ ë” low-level control ê°€ëŠ¥


<br>



## Monitor

> Language-level solution (ì‚¬ìš©ì´ ì‰½ë‹¤)

| Monitor | Pseudo-code |
|:-:|:-:|
| ![6-17](https://user-images.githubusercontent.com/96368476/172224305-9c994dd4-f49d-429f-bd64-67bbe5015619.png) | ![6-18](https://user-images.githubusercontent.com/96368476/172530933-214ad55e-1485-4e69-ba52-769cafd168e8.png) |


- Monitor: ê³µìœ  ë°ì´í„°ì™€ critical sectionì˜ ì§‘í•©
  - ëª¨ë‹ˆí„° ë‚´ì—ëŠ” í•­ìƒ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì§„ì… ê°€ëŠ¥
  - ê³µìœ  ë°ì´í„°ëŠ” ëª¨ë‹ˆí„° ë‚´ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- Entry queue (ì§„ì… í)
  - ëŒ€ê¸°ì¤‘ì¸ Procedures(functions)
- Condition queue (ì¡°ê±´ í)
  - ëª¨ë‹ˆí„° ë‚´ì˜ íŠ¹ì • ì´ë²¤íŠ¸ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” í”„ë¡œì„¸ìŠ¤ ëŒ€ê¸°
- Signal queue (ì‹ í˜¸ í)
  - ì‘ì—…ì´ ëë‚œ í”„ë¡œì„¸ìŠ¤ë¥¼ ë°˜ë‚©í•  ë•Œ releaseì—ì„œ ë°”ë¡œ ë°˜ë‚©í•  ìˆ˜ ì—†ìŒ (ëª¨ë‹ˆí„° ë‚´ì—ëŠ” í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì¡´ì¬í•˜ê¸° ë•Œë¬¸)
  - signalì„ ê±°ì³ì„œ ì‘ì—…ì´ ëë‚¬ìŒì„ ì•Œë¦¬ê³  ë°˜ë‚©


<br>




[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}