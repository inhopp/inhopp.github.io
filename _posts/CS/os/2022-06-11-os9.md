---
title:  "Chapter9. ê°€ìƒ ë©”ëª¨ë¦¬" 

categories:
  -  OS
tags:
  - [CS, OS]

toc: true
toc_sticky: true

date: 2022-06-11
last_modified_at: 2022-06-11
---

ìœ íŠœë¸Œì— ìˆëŠ” ê¹€ë•ìˆ˜ êµìˆ˜ë‹˜ì˜ **[Operating System](https://www.youtube.com/watch?v=EdTtGv9w2sA&list=PLBrGAFAIyf5rby7QylRc6JxU5lzQ9c4tN)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.<br>
ì¤‘ê°„ì— ë“±ì¥í•˜ëŠ” ppt ë‚´ìš©ë“¤ì€ ëª¨ë‘ ê°•ì˜ìë£Œë¥¼ ìº¡ì²˜í•œ ê²ƒì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ”§ Virtual Memory (ê°€ìƒ ë©”ëª¨ë¦¬)

| Virtual address | Address mapping |
|:-:|:-:|
| ![9-2](https://user-images.githubusercontent.com/96368476/173106488-7320be71-a5a4-49a4-9e64-bfc68292e4a4.png) | ![9-1](https://user-images.githubusercontent.com/96368476/173106480-e4d3ad12-e092-46ce-bf54-de5bde45fbcc.png) |

- ì‚¬ìš©ì í”„ë¡œê·¸ë¨ì„ ì—¬ëŸ¬ ê°œì˜ blockìœ¼ë¡œ ë¶„í• 
- í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì‹œ, í•„ìš”í•œ blockë“¤ë§Œ ë©”ëª¨ë¦¬ì— ì ì¬
- ë‚˜ë¨¸ì§€ blockë“¤ì€ swap deviceì— ì¡´ì¬
- Non-continuous allocation
  - Virtual address (Logical address)
    - <span style="color:red">ì—°ì†ëœ ë©”ëª¨ë¦¬ í• ë‹¹ì„ ê°€ì •</span>
  - Real address (Physical address)
    - ì‹¤ì œ ë©”ëª¨ë¦¬ì— ì ì¬ëœ ì£¼ì†Œ
  - Address mapping = virtual address â†’ real address
- ê¸°ë²•ë“¤
  - Paging sysem
  - Segmentation system
  - Hybrid system



<br>


## Block mapping

| Block Map Table | Mapping |
|:-:|:-:|
| ![9-4](https://user-images.githubusercontent.com/96368476/173106493-b319e84e-ddb2-4efb-83c4-0b69e5e7059d.png) | ![9-3](https://user-images.githubusercontent.com/96368476/173106490-b06c699f-5200-4696-a457-f2e4d5a83322.png) |

- virtual address v = (b,d)
  - b : block number
  - d : displacement(offset) in a block
- Block map table (BMT)
  - ì»¤ë„ ê³µê°„ì— í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ í•˜ë‚˜ì˜ BMT ê°€ì§
  - residence bit: í•´ë‹¹ ë¸”ë¡ì´ ë©”ëª¨ë¦¬ì— ì ì¬ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ (1/0)
- í•„ìš”í•œ ë¸”ë¡ì´ ë©”ëª¨ë¦¬ì— ìˆë‹¤ë©´
  - ì‹¤ì œ ì£¼ì†Œ (a + d) ì—ì„œ ë©”ëª¨ë¦¬ ì ‘ê·¼
- í•„ìš”í•œ ë¸”ë¡ì´ ë©”ëª¨ë¦¬ì— ì—†ë‹¤ë©´
  - swap deviceì—ì„œ ë¸”ë¡ì„ ë©”ëª¨ë¦¬ì— ê°€ì ¸ì˜¨ í›„ ì‹¤ì œ ì£¼ì†Œ ë‹¤ì‹œ ê³„ì‚°



<br>


# ğŸ”§ Paging System

![9-5](https://user-images.githubusercontent.com/96368476/173106496-1804f977-404e-42ca-bcd4-9953e39a8c2d.png){: width="60%" height="70%" .align-center}

- í”„ë¡œê·¸ë¨ì„ ê°™ì€ í¬ê¸°ì˜ ë¸”ë¡ìœ¼ë¡œ ë¶„í• 
  - page: ë¶„í• ëœ block
  - page frame: ë©”ëª¨ë¦¬ì˜ ë¶„í•  ì˜ì—­ (pageì™€ ê°™ì€ í¬ê¸°)
- ë…¼ë¦¬ì  ë¶„í• ì´ ì•„ë‹˜ (ê°™ì€ í•¨ìˆ˜ê°€ ìª¼ê°œì§ˆ ìˆ˜ ìˆìŒ)
  - Page sharing(ê³µìœ ) ë° protection(ë³´í˜¸) ê³¼ì •ì´ ë³µì¡
- ê°„ë‹¨í•˜ê³  ë¹ ë¦„
- Extenal fragmentation ì—†ìŒ
- Intenal fragmentation ë°œìƒ ê°€ëŠ¥ (ë§¨ ë§ˆì§€ë§‰ ê¼­ë‹¤ë¦¬)
- Swap deviceë¥¼ ì–´ë””ë¡œ ì„¤ì •í•˜ëŠëƒì— ë”°ë¼ ì„±ëŠ¥ ì°¨ì´ (ì‹¤ì œ ìœˆë„ìš°ì—ì„œ ì„¤ì • ê°€ëŠ¥)


<br>


## Address mapping

- Page Map Table (PMT) ì‚¬ìš©
- Direct mapping
- Associative mapping
- Hybrid mapping


<br>

## Direct mapping

| PMT | Mapping |
|:-:|:-:|
| ![9-6](https://user-images.githubusercontent.com/96368476/173117092-bd06ec91-f2dd-40f6-bf11-0cf7fcfadccf.png) | ![9-7](https://user-images.githubusercontent.com/96368476/173117096-10626191-abb1-4525-9468-669636f5a3c0.png) |

- Block mappingê³¼ ê°™ì€ ë°©ë²•
- Residence bit = 0 ì¸ ê²½ìš° (swap deviceì—ì„œ í˜ì´ì§€ ê°€ì ¸ì™€ì•¼ í•¨)
  - **<span style="color:red">page fault ë°œìƒ</span>**
  - Context switching ë°œìƒ (overhead)
  - page fault ì¤„ì´ëŠ” ê²ƒì´ ì„±ëŠ¥ì„ ê²°ì •ì§“ëŠ” ì¤‘ìš”í•œ ìš”ì†Œ
- ë¬¸ì œì 
  - ë©”ëª¨ë¦¬ ì ‘ê·¼ íšŸìˆ˜ê°€ 2ë°° (PMT í™•ì¸, ì‹¤ì œ ë©”ëª¨ë¦¬ ì ‘ê·¼)
  - PMTë¥¼ ìœ„í•œ ë©”ëª¨ë¦¬ ê³µê°„ í•„ìš” (ì»¤ë„ì— ì¡´ì¬)



<br>


## Associative mapping

![9-10](https://user-images.githubusercontent.com/96368476/173117102-4c8c10f4-0e1c-4f57-8073-c9bf298c0eca.png){: width="70%" height="80%" .align-center}

- Translation Look-aside Buffer (TLB)ì— PMT ì ì¬ (ë³€í™˜ ìƒ‰ì¸ ë²„í¼)
- PMT ì „ìš© í•˜ë“œì›¨ì–´ (ìºì‹œ)
  - PMT ë³‘ë ¬ íƒìƒ‰
  - Low overhead & high speed
- **Expensive**


<br>


## Hybrid mapping

![9-11](https://user-images.githubusercontent.com/96368476/173117104-f26fc450-df8e-4c94-9115-bf82c6bb68e7.png){: width="70%" height="80%" .align-center}

- Direct + Associative í˜¼í•©
- ì‘ì€ í¬ê¸°ì˜ TLB ì‚¬ìš©
  - PMT: ë©”ëª¨ë¦¬(ì»¤ë„)ì— ì €ì¥
  - TLB: PMT ì¤‘ ì¼ë¶€ entryë“¤ë§Œ ì ì¬
    - ìµœê·¼ì— ì‚¬ìš©ëœ pageë“¤ ì €ì¥
    - **Locality ì›ë¦¬**
- ë¨¼ì € TLB íƒìƒ‰, TLBì— ì—†ìœ¼ë©´ PMT íƒìƒ‰


<br>


## Memory management

![9-12](https://user-images.githubusercontent.com/96368476/173120412-389c4090-f6a1-4436-8511-9ebbbad2ab13.png){: width="40%" height="50%" .align-center}

- Frame table
  - ë©”ëª¨ë¦¬ë¥¼ pageì™€ ê°™ì€ í¬ê¸°ë¡œ ë¯¸ë¦¬ ë¶„í• í•˜ì—¬ ê´€ë¦¬/ì‚¬ìš©
  - FPMê³¼ ìœ ì‚¬
  - ë¹„ì–´ìˆëŠ” ê³µê°„ì„ linked listë¡œ ì €ì¥
- êµ¬ì„±
  - Allocated/Available : í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ ë˜ì—ˆë‚˜
  - PID : ì–´ë–¤ í˜ì´ì§€ê°€ ì˜¬ë¼ì™”ëŠëƒ
  - Link : ì‚¬ìš© ê°€ëŠ¥í•œ ê³µê°„ (ë¹ˆ ê³µê°„) í¬ì¸í„°
  - AV : ë¹ˆ ê³µê°„ì˜ ì‹œì‘ì 



<br>


## Page sharing

![9-13](https://user-images.githubusercontent.com/96368476/173120416-13a80cb2-9907-4bcb-aa27-f04ae78d4295.png){: width="70%" height="80%" .align-center}

- Non-continuous allocation ì´ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ê°€ íŠ¹ì • page ê³µìœ  ê°€ëŠ¥
  - procedure page (Pure code)
  - data page
    - read-only data
    - read-write data (concurrency ì œì–´ í•˜ì—ì„œë§Œ ê°€ëŠ¥)

<br>

### page sharing ë¬¸ì œì 

| Data page | Procedure page |
|:-:|:-:|
| ![9-14](https://user-images.githubusercontent.com/96368476/173120418-655f9331-5ab6-4779-b48e-bb3a236bf676.png) | ![9-15](https://user-images.githubusercontent.com/96368476/173120400-8ee32125-11fd-44fd-99b4-b61961ab683a.png) |

- Data page sharingì—ì„œëŠ” í° ë¬¸ì œ ì—†ìŒ
- Procedure pageì˜ ê²½ìš° í˜ì´ì§€ ì¤‘ê°„ìœ¼ë¡œ ì´ë™í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìƒê¹€ (if, switch, ...)
  - ì´ë•Œ í…Œì´ë¸”ì— ë”°ë¼ ì£¼ì†Œê°€ ë‹¤ë¥´ê²Œ í‘œí˜„ë˜ê¸° ë•Œë¬¸ì— ì–´ë””ë¡œ ê°€ì•¼í•˜ëŠ”ì§€ ì•Œë ¤ì¤„ ìˆ˜ê°€ ì—†ìŒ
- **<span style="color:red">ë”°ë¼ì„œ í”„ë¡œì„¸ìŠ¤ë“¤ì´ pageë¥¼ ê³µìœ í•˜ë©´ PMTì˜ ê°™ì€ entryì— ì €ì¥í•˜ë„ë¡ ë§ì¶°ì¤Œ (ex. kë²ˆì§¸ entryë¡œ í†µì¼)</span>**


<br>


## Page protection

![9-16](https://user-images.githubusercontent.com/96368476/173120407-2624c7ec-4312-48db-9bca-bcfd20930d60.png){: width="60%" height="70%" .align-center}

- í˜ì´ì§€ë¥¼ ê³µìœ í•  ë•Œ PMTì— protection bit ì‚¬ìš©
  - V : ë©”ëª¨ë¦¬ì— ì ì¬ ì—¬ë¶€
  - R : ì½ê¸° ì—¬ë¶€
  - W : ìˆ˜ì • ì—¬ë¶€
  - E : ì‹¤í–‰ ì—¬ë¶€




<br>


# ğŸ”§ Segmentation System

![9-17](https://user-images.githubusercontent.com/96368476/173132588-2b79b945-a5ea-481d-bb2e-cf82875f75bf.png){: width="60%" height="70%" .align-center}

- í”„ë¡œê·¸ë¨ì„ ë…¼ë¦¬ì  blockìœ¼ë¡œ ë¶„í• 
  - Blockì˜ í¬ê¸°ê°€ ì„œë¡œ ë‹¤ë¦„
  - ex) stack, heap, main procedure, shared lib, ...
- ë©”ëª¨ë¦¬ë¥¼ ë¯¸ë¦¬ ë¶„í• í•˜ì§€ ì•ŠìŒ (VPMê³¼ ìœ ì‚¬)
- Segment sharing/protectionì´ ìš©ì´í•¨
- Address mapping ë° ë©”ëª¨ë¦¬ ê´€ë¦¬ overhead í¼
- Internal fragmentation ì—†ìŒ


<br>

## Address mapping (Direct mapping)

| Segment Map Table | Direct Mapping |
|:-:|:-:|
| ![9-18](https://user-images.githubusercontent.com/96368476/173132590-ce2889f4-c681-46bb-b0b0-4571faffe561.png) | ![9-19](https://user-images.githubusercontent.com/96368476/173132596-e92044a3-afac-498c-85b0-eda31688d73a.png) |

- Segment Map Table (SMT) ì´ìš©
  - segment length ì¡´ì¬
- residence bitê°€ 0ì¸ ê²½ìš° : segment fault
- offset dê°€ segement lengthë³´ë‹¤ í° ê²½ìš° : segment overflow


<br>


## Memory management

| Partition Table (State Table) | Sharing & Protection |
|:-:|:-:|
| ![9-20](https://user-images.githubusercontent.com/96368476/173132581-1598cb15-c08a-4e9b-8ada-e8b5840e5e24.png) | ![9-21](https://user-images.githubusercontent.com/96368476/173132585-2f5dddbe-b6a8-40b9-b9b7-72621293271d.png) |

- Segment ì ì¬ ì‹œ, í¬ê¸°ì— ë§ì¶”ì–´ ë¶„í•  í›„ ì ì¬
- VPMê³¼ ìœ ì‚¬
- ë…¼ë¦¬ì  ë¶„í• ì´ê¸° ë•Œë¬¸ì— ê³µìœ  ë° ë³´í˜¸ê°€ ìš©ì´í•¨




<br>



# ğŸ”§ Hybrid Paging & Segmentation System

![9-22](https://user-images.githubusercontent.com/96368476/173136154-09b47835-c81c-4d62-a65e-d9e9d54b1efd.png){: width="50%" height="60%" .align-center}

- paging systemì˜ ì¥ì : ê´€ë¦¬ê°€ í¸í•¨
- segmentation systemì˜ ì¥ì : ë©”ëª¨ë¦¬ì˜ íš¨ìœ¨ì  í™œìš©
- Hybrid System
  - 1. ë…¼ë¦¬ ë‹¨ìœ„ì˜ segemtë¡œ ë¶„í• 
  - 2. ê° segmentë¥¼ ê³ ì •ëœ í¬ê¸°ì˜ pageë¡œ ë¶„í• 
- Pageë‹¨ìœ„ë¡œ ë©”ëª¨ë¦¬ì— ì ì¬


<br>


## Address mapping

| PMT & SMT | Direct Mapping |
|:-:|:-:|
| ![9-23](https://user-images.githubusercontent.com/96368476/173136158-1812dc60-238e-47b1-aae7-b76a1c066643.png) | ![9-24](https://user-images.githubusercontent.com/96368476/173136160-b519ede8-2743-4126-bf9d-8f3fac5e6726.png) |

- Virtual address : v = (s, p, d)
- SMTì™€ PMT ëª¨ë‘ ì‚¬ìš©
  - ê° í”„ë¡œì„¸ìŠ¤ë§ˆë‹¤ í•˜ë‚˜ì˜ SMT
  - ê° segmentë§ˆë‹¤ í•˜ë‚˜ì˜ PMT
- ì¥ì 
  - page sharing/protectionì´ ì‰¬ì›€
  - ë©”ëª¨ë¦¬ ê´€ë¦¬ overhead ì‘ìŒ
- ë‹¨ì 
  - address mapping ê³¼ì •ì´ ë³µì¡í•¨ (3ë°°)
  - ë©”ëª¨ë¦¬ ì†Œëª¨ê°€ í¼



<br>




[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}