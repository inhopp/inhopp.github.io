---
title:  "[Paper Review] StarGAN : Unified Generative Adversarial Networks for Multi-Domain Image-to-Image Translation" 

categories:
  -  Paper
tags:
  - [ML, Generative]

toc: true
toc_sticky: true

date: 2023-06-09
last_modified_at: 2023-06-09
---

**Main Reference: <br>- [CycleGAN Paper](https://arxiv.org/abs/1711.09020)**
{: .notice--primary}

<br>


# ğŸš€ Introduction

![1](https://github.com/inhopp/inhopp/assets/96368476/06caf43c-723b-4df2-a06d-da8dd8a0a288){: width="60%" height="70%" .align-center}

Image-to-Image translation for two domains ì‘ì—…ì€ ì´ì „ì— ë¦¬ë·°í•œ pix2pix, CycleGAN ë“± ì¢‹ì€ ì„±ê³¼ë¥¼ ë‚´ê³ ìˆë‹¤. í•˜ì§€ë§Œ ê¸°ì¡´ ëª¨ë¸ë“¤ì€ domain pairë§ˆë‹¤ ë³„ë„ì˜ Generator & Discrimatorë¥¼ í›ˆë ¨ì‹œì¼œì•¼ í•˜ê¸° ë•Œë¬¸ì— scalability&robustnessì— í•œê³„ê°€ ì¡´ì¬í•œë‹¤. ë‹¤ì‹œ ë§í•´ kê°œì˜ multi-domainì„ í•™ìŠµí•˜ë ¤ë©´ k(k-1)ê°œì˜ Generator, Discriminatorê°€ í•„ìš”í•œ ê²ƒì´ë‹¤. í•œí¸ ì„œë¡œ ë‹¤ë¥¸ domainë“¤ì´ ê³µí†µì ìœ¼ë¡œ ê°–ëŠ” featureê°€ ì¡´ì¬í•¨ì—ë„, ê°ê°ì˜ datasetë“¤ì€ ë¶€ë¶„ì ìœ¼ë¡œ ë¼ë²¨ë§ ë˜ì–´ìˆë‹¤. ì´ëŸ¬í•œ partially labeled ëœ datasetë“¤ì„ jointly training í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë¹„íš¨ìœ¨ì ì¸ í•™ìŠµ ë°©ë²•ì´ë¼ ë§í•  ìˆ˜ ìˆë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” ì•ì„œ ì–¸ê¸‰í•œ ë¬¸ì œë“¤ì„ í•´ê²°í•˜ê¸° ìœ„í•´ í•˜ë‚˜ì˜ Generatorë¡œ multi-domainì„ í•™ìŠµí•  ìˆ˜ ìˆëŠ” StarGAN ëª¨ë¸ì„ ì œì•ˆí•œë‹¤. 



<br>


# ğŸš€ Star Generative Adversarial Networks

![2](https://github.com/inhopp/inhopp/assets/96368476/0d14d00e-84e8-4aca-8e14-e008278cd5b1){: width="60%" height="70%" .align-center}

StarGANì˜ ëª©ì ì€ í•˜ë‚˜ì˜ Generatorê°€ multiple-domain ì‚¬ì´ì˜ ë§¤í•‘ì„ í•™ìŠµí•˜ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ìœ„í•´ Discriinatorì— Auxiliary Classifierë¥¼ ì¶”ê°€í–ˆê³ , target domain labelì„ ì •í•´ conditionalë¡œ Generatorë¥¼ í•™ìŠµí–ˆë‹¤.

## Objective Function

$$ \textbf{Adversarial Loss : } \quad \textbf{L}_{adv} =  \mathbb{E}_{x}[logD_{src}(x)] + \mathbb{E}_{x,c}[log(1 - D_{src}(G(x,c)))] $$

$$ \textbf{Domain Classification Loss : } \quad \textbf{L}_{cls}^{r} = \mathbb{E}_{x,c'}[ - log(D_{cls}(c'|x))] $$

$$ \textbf{Reconstruction Loss : } \quad \textbf{L}_{rec} = \mathbb{E}_{x,c,c'}[\left\| x - G(G(x, c), c') \right\|_{1}] $$

$$ \textbf{L}_{D} = - \textbf{L}_{adv} + \lambda_{cls}  \textbf{L}_{cls}^{r} $$ 

$$ \textbf{L}_{G} = \textbf{L}_{adv} + \lambda_{cls}  \textbf{L}_{cls}^{f} + \lambda_{rec}  \textbf{L}_{rec} $$

- Discriminator, Generator Lossì— ëª¨ë‘ classification lossë¥¼ ë°˜ì˜
- c : labels of target domain  &  c' : labels of original domain
- Adversarial lossë‚˜ Classification lossë§Œìœ¼ë¡œëŠ” ë°”ê¾¼ label ì´ì™¸ì˜ contentë“¤ì´ ë³´ì¡´ë˜ëŠ” ê²ƒì„ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.
  - ë”°ë¼ì„œ Generator lossì— cycle consistency loss(Reconstruction Loss)ë¥¼ ì¶”ê°€
- ëŒë‹¤ê°’ë“¤ì€ datasetë§ˆë‹¤ ë‹¤ë¥¸ë° ì €ìë“¤ì€ cls:1, rec:10 ì‚¬ìš©


## Mask Vector

Multiple datasetsì„ í•™ìŠµí•  ë•Œ ë°œìƒí•˜ëŠ” ì´ìŠˆëŠ” label ì •ë³´ê°€ datasetì˜ ì¼ë¶€ ì •ë³´ë§Œì„ í¬í•¨í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ celeb datasetì— í¬í•¨ë˜ëŠ” ì´ë¯¸ì§€ëŠ” í‘œì •ì— ëŒ€í•œ labelì„ ê°€ì§€ê³  ìˆì§€ ì•ŠëŠ” ìƒí™©ì´ë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë“¤ì„ í•´ê²°í•˜ê¸° ìœ„í•´ unspecified labelì„ ë¬´ì‹œí•˜ê³ , ì•Œë ¤ì§„ íŠ¹ì • labelë“¤ì— ì§‘ì¤‘í•˜ê²Œ í•´ì£¼ëŠ” mask vectorë¥¼ ë„ì…í–ˆë‹¤. One-hot vector ì•„ì´ë””ì–´ë¥¼ ì´ìš©í•œ ë‹¨ìˆœí•œ ê°œë…ì´ë‹¤.

<br>


## Training Strategy

![3](https://github.com/inhopp/inhopp/assets/96368476/680c5ba2-da6b-4ef9-809f-b64cd08a15d1){: width="60%" height="70%" .align-center}



<br>


# ğŸš€ Implementation

## Improved GAN Training

$$ \textbf{L}_{adv} =  \mathbb{E}_{x}[logD_{src}(x)] + \mathbb{E}_{x,c}[D_{src}(G(x,c))] - \lambda_{gp} \mathbb{E}_{\hat{x}}[(\left\| \bigtriangledown_{\hat{x}} D_{src}(\hat{x}) \right\|_{2} - 1 )^{2}] $$

ì•ˆì •ì ì¸ í•™ìŠµì„ ìœ„í•´ gradient panaltyë¥¼ ì´ìš©í•œ Wasserstein GAN lossë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤(lambda=10).

<br>

## Network Architecture

![4](https://github.com/inhopp/inhopp/assets/96368476/b2636bb4-192b-410c-ab9d-4aa7da4008b7){: width="60%" height="70%" .align-center}



<br>



# ğŸš€ Experiments

| Celeb A Dataset | AMT Score |
|:-:| :-: |
| ![5](https://github.com/inhopp/inhopp/assets/96368476/2e989af0-dbba-40e2-af13-b5e1cc37f338) | ![6](https://github.com/inhopp/inhopp/assets/96368476/22643f63-0141-436e-8ed4-65760af93b5c) |

- ë‹¨ì¼ Dataset ë‚´ì—ì„œë„ StarGANì˜ AMT socreê°€ ê°€ì¥ ë†’ìŒ (ì •ëŸ‰ì  í‰ê°€)


<br>


![7](https://github.com/inhopp/inhopp/assets/96368476/65edf28b-99f9-472b-8a4e-f78875423930){: width="60%" height="70%" .align-center}

- SNG(single training)ë³´ë‹¤ JNT(joint training) ë°©ë²•ì´ ë” high quality ì´ë¯¸ì§€ ìƒì„±



<br>



# ğŸš€ Code

> [StarGAN from scartch (pytorch)](https://github.com/inhopp/StarGAN)

| Original Hair | Black Hair |
|:-:| :-: |
| ![1](https://github.com/inhopp/inhopp/assets/96368476/a0269bfb-849c-4923-ac3c-aafc41996df2) | ![2](https://github.com/inhopp/inhopp/assets/96368476/63b6281c-e838-4bbd-90fc-dd08672dd38b) |


<br>
<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}