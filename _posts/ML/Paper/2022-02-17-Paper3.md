---
title:  "[논문 리뷰] Rich feature hierarchies for accurate object detection and semantic segmentation (R-CNN)" 

categories:
  -  Paper
tags:
  - [ML, Paper]

toc: true
toc_sticky: true

date: 2022-02-18
last_modified_at: 2022-02-18
---

**Main Reference: <br>- [Deep Learning for Computer Vision](https://www.youtube.com/watch?v=dJYGatp4SvA&list=PL5-TkQAfAZFbzxjBHtzdVCWE0Zbhomg7r) <br>- [Life Time Study](https://www.youtube.com/watch?v=VYILt52ETqw)**
{: .notice--warning}


**Paper: <br>- [Rich feature hierarchies for accurate object detection and semantic segmentation](https://github.com/inhopp/inhopp/files/8081058/RCNN.paper.pdf))**
{: .notice--primary}


**[R-CNN 배경지식](https://inhopp.github.io/paper/Paper2/) : 본 논문을 이해하는데 필요한 배경지식을 정리한 포스팅 입니다.**
{: .notice--success}



<br>

# 🚀 Abstract

![2](https://user-images.githubusercontent.com/96368476/154619532-c342913a-181a-44bd-b430-89cea695fabd.png){: width="70%" height="80%" .align-center}

(R-CNN 논문이 처음 나온 2013년 기준) 최근 몇 년 Object Detection의 성능은 정체기에 들어섰다. 가장 성능이 좋은 모델은 기존의 복잡한 모델들을 앙상블 한 것이었다. 우리가 제안하는 모델은 기존 최고 성능의 모델보다 30% 향상된 53.3% mAP를 달성했다. 뿐만 아니라 비교적 간단하고, data set이 달라져도 확장이 쉽다. <br>우리 모델의 key point는 다음 두 가지이다.
- Detection 분야에 CNN 접목
- annotated data가 부족한 상황에서 기존의 패러다임을 전환



<br>

# 🚀 Introduction

**샤라웃 CNN!** Intro에서 저자들은 CNN의 발전 과정, Image Classification 분야의 성공을 짚어준다. 그러면서 CNN의 등장이 Detection 분야에 활력을 넣어주었다고 말한다. CNN을 어떻게 확장시켜야 detection에 접목할 수 있는지 많은 논의가 이루어졌고, 본 논문은 처음으로 CNN을 활용하여 드라마틱한 성능 향상을 이끌어냈다.
<br>

![4](https://user-images.githubusercontent.com/96368476/154625195-e94406e1-1f1b-460a-89de-ac98be55f37d.jpg){: width="50%" height="60%" .align-center}

우리의 주요 관심사는 다음 두 가지였다.
- Localizing object
- Small quantity of annotated detection data


<br>

## Localizing

Detection은 classify와 다르게 localizing이 필요하다. 우리는 localizing 방법으로 세 가지 접근을 고려했다.
- Localization as a regression problem
  - 논문 하나를 reference로 두면서 현실적이지 않다고 한다.
- Sliding-window detector
  - object detection의 Input은 high resolution Image이어야 함 (고해상도 이미지)
  - Image size가 크기 때문에 conv, pool 과정을 여러 번 해야하는데, 그러면 receptive field가 너무 커지는 문제 발생
  - ![5](https://user-images.githubusercontent.com/96368476/154627009-cf83638e-48b1-423f-94c7-e32ece00371d.png){: width="50%" height="60%"}<br>
- Recognition using regions
  - object가 존재할 만한 후보 영역을 제안해주는 region proposal 알고리즘 사용
  - region proposal & cnn 궁합이 아주 좋음
  - 본 논문 이전 최고 성능은 sliding-window 방식의 overfeat 모델 (우리 방법은 overfeat의 mAP 30% 향상시킴)
  - 논문 제목 나두고 왜 R-CNN이라 불러요?
  - **<span style="color:red">We call our method R-CNN : Regions with CNN</span>**
  - 날 조커라고 소개해주겠어요..?
  - ![1](https://user-images.githubusercontent.com/96368476/154628296-6d1983cc-1b81-4561-b2d3-6bfa2be0facb.jpg){: width="40%" height="50%"}


<br>

## 부족한 annotated data

![1](https://user-images.githubusercontent.com/96368476/154297787-d69ddfd6-6e34-4b5e-a361-af5149b909bf.png){: width="60%" height="70%" .align-center}

하나의 사진. 수 많은 object들. 이 많은 data set을 누가 다 labeling 했을까.(대학원 가지 마?) <br>아무튼 저자들은 data가 부족할 때 흔히 사용하는 기존의 방식과 다른 접근을 시도했다고 한다.
- 기존의 모델들은 unsupervised pre-training → fine-tuning
- 하지만 우리는 패러다임을 전환했음
- classification에 사용된 data set으로 supervised pre-training
- 부족한 detecting data로 fine-tuning
- **<span style="color:red">즉, supervised pre-training → fine-tuning</span>**
- 이 방법을 사용하니 mAP가 8%나 향상되었다.


<br>

## 우리 모델의 장점
- CNN의 모든 parameters가 공유되기 때문에 기존 모델들 덕지덕지 붙인 앙상블보다 훨씬 가벼움
- Region-based라 segmatation하기도 좋음
- 간단한 box-regression 추가했더니 localizing도 아주 잘함



<br>

# 🚀 Model Architecture


<br>
<br>

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}