---
title:  "[ë…¼ë¬¸ ë¦¬ë·°] Rich feature hierarchies for accurate object detection and semantic segmentation (R-CNN)" 

categories:
  -  Paper
tags:
  - [ML, Paper, Object Detection]

toc: true
toc_sticky: true

date: 2022-02-18
last_modified_at: 2022-02-18
---

**Main Reference: <br>- [Deep Learning for Computer Vision](https://www.youtube.com/watch?v=dJYGatp4SvA&list=PL5-TkQAfAZFbzxjBHtzdVCWE0Zbhomg7r) <br>- [Life Time Study](https://www.youtube.com/watch?v=VYILt52ETqw)**
{: .notice--warning}


**Paper: <br>- [Rich feature hierarchies for accurate object detection and semantic segmentation](https://github.com/inhopp/inhopp/files/8081058/RCNN.paper.pdf)**
{: .notice--primary}


**[Object Detection ë°°ê²½ì§€ì‹](https://inhopp.github.io/paper/Paper2/) : ë³¸ ë…¼ë¬¸ì„ ì´í•´í•˜ëŠ”ë° í•„ìš”í•œ ë°°ê²½ì§€ì‹ì„ ì •ë¦¬í•œ í¬ìŠ¤íŒ… ì…ë‹ˆë‹¤.**
{: .notice--success}



<br>

# ğŸš€ Abstract

![2](https://user-images.githubusercontent.com/96368476/154619532-c342913a-181a-44bd-b430-89cea695fabd.png){: width="70%" height="80%" .align-center}

(R-CNN ë…¼ë¬¸ì´ ì²˜ìŒ ë‚˜ì˜¨ 2013ë…„ ê¸°ì¤€) ìµœê·¼ ëª‡ ë…„ Object Detectionì˜ ì„±ëŠ¥ì€ ì •ì²´ê¸°ì— ë“¤ì–´ì„°ë‹¤. ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ì€ ëª¨ë¸ì€ ê¸°ì¡´ì˜ ë³µì¡í•œ ëª¨ë¸ë“¤ì„ ì•™ìƒë¸” í•œ ê²ƒì´ë‹¤. ìš°ë¦¬ê°€ ì œì•ˆí•˜ëŠ” ëª¨ë¸ì€ ê¸°ì¡´ ìµœê³  ì„±ëŠ¥ì˜ ëª¨ë¸ë³´ë‹¤ 30% í–¥ìƒëœ 53.3% mAPë¥¼ ë‹¬ì„±í–ˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ ë¹„êµì  ê°„ë‹¨í•˜ê³ , data setì´ ë‹¬ë¼ì ¸ë„ í™•ì¥ì´ ì‰½ë‹¤. ìš°ë¦¬ ëª¨ë¸ì˜ key pointëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ì´ë‹¤.
- Detection ë¶„ì•¼ì— CNN ì ‘ëª©
- annotated dataê°€ ë¶€ì¡±í•œ ìƒí™©ì—ì„œ ê¸°ì¡´ì˜ íŒ¨ëŸ¬ë‹¤ì„ì„ ì „í™˜



<br>

# ğŸš€ Introduction

**ìƒ¤ë¼ì›ƒ CNN!** Introì—ì„œ ì €ìë“¤ì€ CNNì˜ ë°œì „ ê³¼ì •, Image Classification ë¶„ì•¼ì˜ ì„±ê³µì„ ì§šì–´ì¤€ë‹¤. ê·¸ëŸ¬ë©´ì„œ CNNì˜ ë“±ì¥ì´ Detection ë¶„ì•¼ì— í™œë ¥ì„ ë„£ì–´ì£¼ì—ˆë‹¤ê³  ë§í•œë‹¤. CNNì„ ì–´ë–»ê²Œ í™•ì¥ì‹œì¼œì•¼ detectionì— ì ‘ëª©í•  ìˆ˜ ìˆëŠ”ì§€ ë§ì€ ë…¼ì˜ê°€ ì´ë£¨ì–´ì¡Œê³ , ë³¸ ë…¼ë¬¸ì€ ì²˜ìŒìœ¼ë¡œ CNNì„ í™œìš©í•˜ì—¬ ë“œë¼ë§ˆí‹±í•œ ì„±ëŠ¥ í–¥ìƒì„ ì´ëŒì–´ëƒˆë‹¤.
<br>

![4](https://user-images.githubusercontent.com/96368476/154625195-e94406e1-1f1b-460a-89de-ac98be55f37d.jpg){: width="50%" height="60%" .align-center}

ìš°ë¦¬ì˜ ì£¼ìš” ê´€ì‹¬ì‚¬ëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ì˜€ë‹¤.
- Localizing object
- Small quantity of annotated detection data


<br>

## Localizing

Detectionì€ classifyì™€ ë‹¤ë¥´ê²Œ localizingì´ í•„ìš”í•˜ë‹¤. ìš°ë¦¬ëŠ” localizing ë°©ë²•ìœ¼ë¡œ ì„¸ ê°€ì§€ ì ‘ê·¼ì„ ê³ ë ¤í–ˆë‹¤.
- Localization as a regression problem
  - ë…¼ë¬¸ í•˜ë‚˜ë¥¼ referenceë¡œ ë‘ë©´ì„œ í˜„ì‹¤ì ì´ì§€ ì•Šë‹¤ê³  í•œë‹¤.
- Sliding-window detector
  - object detectionì˜ Inputì€ high resolution Imageì´ì–´ì•¼ í•¨ (ê³ í•´ìƒë„ ì´ë¯¸ì§€)
  - Image sizeê°€ í¬ê¸° ë•Œë¬¸ì— conv, pool ê³¼ì •ì„ ì—¬ëŸ¬ ë²ˆ í•´ì•¼í•˜ëŠ”ë°, ê·¸ëŸ¬ë©´ receptive fieldê°€ ë„ˆë¬´ ì»¤ì§€ëŠ” ë¬¸ì œ ë°œìƒ
  - ![5](https://user-images.githubusercontent.com/96368476/154627009-cf83638e-48b1-423f-94c7-e32ece00371d.png){: width="50%" height="60%"}<br>
- Recognition using regions
  - objectê°€ ì¡´ì¬í•  ë§Œí•œ í›„ë³´ ì˜ì—­ì„ ì œì•ˆí•´ì£¼ëŠ” region proposal ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
  - region proposal & cnn ê¶í•©ì´ ì•„ì£¼ ì¢‹ìŒ
  - ë³¸ ë…¼ë¬¸ ì´ì „ì— ë‚˜ì˜¨ overfeat ëª¨ë¸ì€ sliding-window ë°©ì‹ (ìš°ë¦¬ê°€ mAP í›¨ì”¬ ë†’ìŒ)
  - ë…¼ë¬¸ ì œëª© ë‚˜ë‘ê³  ì™œ R-CNNì´ë¼ ë¶ˆëŸ¬ìš”?
  - **<span style="color:red">"We call our method R-CNN : Regions with CNN"</span>**


<br>

## ë¶€ì¡±í•œ annotated data

![1](https://user-images.githubusercontent.com/96368476/154297787-d69ddfd6-6e34-4b5e-a361-af5149b909bf.png){: width="60%" height="70%" .align-center}

í•˜ë‚˜ì˜ ì‚¬ì§„. ìˆ˜ ë§ì€ objectë“¤. ì´ ë§ì€ data setì„ ëˆ„ê°€ ë‹¤ labeling í–ˆì„ê¹Œ.(ëŒ€í•™ì› ê°€ì§€ ë§ˆ?) <br>ì €ìë“¤ì€ training dataê°€ ë¶€ì¡±í•  ë•Œ ì „í†µì ìœ¼ë¡œ í•´ì˜¤ë˜ ë°©ì‹ê³¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í–ˆë‹¤ê³  í•œë‹¤.
- ê¸°ì¡´ì˜ ëª¨ë¸ë“¤ì€ unsupervised pre-training â†’ fine-tuning
- í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” íŒ¨ëŸ¬ë‹¤ì„ì„ ì „í™˜í–ˆìŒ
- classificationì— ì‚¬ìš©ëœ data setìœ¼ë¡œ supervised pre-training
- ë¶€ì¡±í•œ detecting dataë¡œ fine-tuning
- **<span style="color:red">ì¦‰, supervised pre-training â†’ fine-tuning</span>**
- ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë‹ˆ mAPê°€ 8%ë‚˜ í–¥ìƒë˜ì—ˆë‹¤.


<br>

## ìš°ë¦¬ ëª¨ë¸ì˜ ì¥ì 
- CNNì˜ ëª¨ë“  parametersê°€ ê³µìœ ë˜ê¸° ë•Œë¬¸ì— ê¸°ì¡´ ëª¨ë¸ë“¤ ë•ì§€ë•ì§€ ë¶™ì¸ ì•™ìƒë¸”ë³´ë‹¤ í›¨ì”¬ ê°€ë²¼ì›€
- Region-basedë¼ segmatationí•˜ê¸°ë„ ì¢‹ìŒ
- ê°„ë‹¨í•œ box-regression ì¶”ê°€í–ˆë”ë‹ˆ localizingë„ ì•„ì£¼ ì˜í•¨



<br>

# ğŸš€ Model Architecture

![7](https://user-images.githubusercontent.com/96368476/154653268-df2674f8-5001-4802-89bc-b87184b04b67.jpg){: width="80%" height="90%" .align-center}
![8](https://user-images.githubusercontent.com/96368476/154653275-29ad07aa-a907-478a-b0b2-ac532baa4d0c.jpg){: width="80%" height="90%" .align-center}

R-CNNì€ 3ê°€ì§€ ëª¨ë“ˆë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.
- Category-independent region proposals
   - ìµœê·¼ Region proposalì— ê´€í•œ ë…¼ë¬¸ì´ ë§ì´ ë‚˜ì˜¤ì§€ë§Œ ìš°ë¦¬ëŠ” selective search ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í–ˆë‹¤.
- Convolutional Neural Networks
  - Caffe Framework ì‚¬ìš© (ë²„í´ë¦¬ì—ì„œ ë§Œë“  í”„ë ˆì„ì›Œí¬, C++ ê¸°ë°˜)
  - AlexNet ì‚¬ìš©
- A set of class-specific linear SVMs
  - Region ë³„ë¡œ binary-classify
    - Dog? no
    - Cat? no
    - Person? yes
    - ...
<br>

## Appendix A : object proposal transformation

Selective Search ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ region proposalì„ ë°›ìœ¼ë©´ ì œì•ˆë°›ì€ ì˜ì—­ì˜ ëª¨ì–‘ì€ ì œë©‹ëŒ€ë¡œì¼ ê²ƒì´ë‹¤. ì´ ì˜ì—­ë“¤ë¡œ CNNì„ ëŒë¦¬ë ¤ë©´ 227x227ë¡œ ì‚¬ì´ì¦ˆë¥¼ ë§ì¶°ì¤˜ì•¼ í•˜ëŠ”ë° ì´ ê³¼ì •ì„ 'object proposal transformation' ì´ë¼ í•œë‹¤. ìš°ë¦¬ëŠ” ì—¬ëŸ¬ ë°©ë²• ì¤‘ ê°€ì¥ ê°„ë‹¨í•œ **Warping** ì„ íƒí–ˆë‹¤. ë‹¤ìŒ ê·¸ë¦¼ì€ ì—¬ëŸ¬ê°€ì§€ transformì— ëŒ€í•œ ì˜ˆì‹œì´ë‹¤.

![10](https://user-images.githubusercontent.com/96368476/154661185-d077616f-6399-433a-8407-2fda8c8e4931.png){: width="70%" height="80%" .align-center}

- (A) : ì œì•ˆë°›ì€ ì˜ì—­
- (B) : tightest square with context 
  - ì›ë³¸ ì´ë¯¸ì§€ì—ì„œ ì˜ì—­ì„ í¬í•¨í•˜ëŠ” ê°€ì¥ ì‘ì€ ì •ì‚¬ê°í˜• ì„ íƒ
  - 227x227ë¡œ resize
- (C) : (B)ì—ì„œ ë°°ê²½ ì§€ìš°ê¸°
- (D) : Warping (ì˜ì—­ ê·¸ëŒ€ë¡œ resize)

ì´ë•Œ ê·¸ë¦¼ì˜ ì•„ë˜ rowëŠ” í…Œë‘ë¦¬ì— 16 pixelì”© paddingí•œ ê²ƒì´ë‹¤. íŒ¨ë”©í•œ ì˜ì—­ì€ ì£¼ë³€ pixelê°’ì˜ í‰ê· ìœ¼ë¡œ ì±„ì› ë‹¤. Padding ì¶”ê°€ì‹œ mAPê°€ 3-5% ì¦ê°€í•˜ë”ë¼.



<br>

# ğŸš€ Training

1. ImageNet ëŒ€íšŒì—ì„œ ì“°ë˜ data set(ILSVRC2012 Classification)ìœ¼ë¡œ CNN <u>Supervised pre-training</u>
2. Annotated detection dataë¡œ <u>fine-tuning</u>
   - ì´ë•Œ (N+1) ê°œì˜ Category Classification
   - N : number of object classes
   - +1 : backgorund
   - ì¦‰, objectê°€ ì•„ë‹Œ ì˜ì—­ì´ ë“¤ì–´ì˜¤ë©´ 'ì´ê±´ ë°°ê²½ì´ì•¼' ë¼ê³  training

ì—¬ê¸°ì„œ íŠ¹ì´í•œ ì ì€ CNNìœ¼ë¡œ feature vertorë¥¼ ë½‘ì€ í›„ì— linear SVMìœ¼ë¡œ classify í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì €ìë“¤ë„ softmax ì“°ë©´ ë” ê¹”ë”í•´ì§€ëŠ” ê±° ì•Œê³  ìˆë‹¤ê³  ë§í•œë‹¤. ê·¸ëŸ°ë°ë„ SVMì„ ì‚¬ìš©í•œ ì´ìœ ëŠ” Appendix Bì— ì í˜€ìˆë‹¤.

<br>

## Appendix B : about positive & negative example

![12](https://user-images.githubusercontent.com/96368476/154704886-45d2c2e8-b52e-43ea-92d2-df8c845e8cc2.png){: width="80%" height="90%" .align-center}

ê¸°ì¡´ì˜ ì „ëµì€ IoU 0.5ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ positive, negativeë¥¼ êµ¬ë¶„í•˜ëŠ” ê²ƒì´ë‹¤. ê·¸ í›„ positivie exampleì€ í•´ë‹¹ classë¡œ, negative exampleì€ background classë¡œ training í•œë‹¤. í•˜ì§€ë§Œ ì´ë ‡ê²Œ í•˜ë‹ˆ ë¬¸ì œê°€ ë°œìƒí•˜ë”ë¼.

- í´ë˜ìŠ¤ ë¶ˆê· í˜• (background regionì´ í›¨ì”¬ ë§ìŒ)
- ì• ë§¤í•˜ê²Œ ê²¹ì¹œ regionë“¤ì´ ì˜¤íˆë ¤ í›ˆë ¨ì„ ë°©í•´ 

### Hard negative example
<br>

![13](https://user-images.githubusercontent.com/96368476/154705469-a53c8d02-a201-4a88-a88b-6adb82f67ec7.png){: width="70%" height="80%" .align-center}

ë”°ë¼ì„œ ì €ìë“¤ì€ IoU 0.5ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ postive/negativeë¥¼ ë‚˜ëˆ„ì§€ ì•Šì•˜ë‹¤. ì¤‘ê°„ì— íšŒìƒ‰ì§€ëŒ€ (gray zone)ë¥¼ ë§Œë“¤ê³  ì´ë“¤ì„ í›ˆë ¨ë°ì´í„°ì—ì„œ ì œì™¸ì‹œì¼°ë‹¤. softmaxëŠ” positive ì•„ë‹ˆë©´ ë¬´ì¡°ê±´ negativeì´ê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ì‘ì—…ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
- hard negativeì˜ IoU ê¸°ì¤€ ê°’ 0.3ì€ ê·¸ë¦¬ë“œ ì„œì¹˜ë¡œ ì°¾ì€ í•˜ì´í¼ íŒŒë¼ë¯¸í„°ë‹¤.
- ì´ ê°’ì´ ìƒê°ë³´ë‹¤ ì¤‘ìš”í•˜ë”ë¼
  - 0.5ë¡œ ì„¤ì •í•˜ë©´ mAP 5% ê°ì†Œ
  - 0ìœ¼ë¡œ ì„¤ì •í•˜ë©´ mAP 4% ê°ì†Œ


ì´ë ‡ê²Œ ë½‘ì€ hard negative region 96ê°œ, positive region 32ê°œ (ì´ 128ê°œ) ë¡œ minibatch í›ˆë ¨ì‹œì¼°ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ mAPë„ í–¥ìƒë˜ê³ , ìˆ˜ë ´ ì†ë„ë„ ë¹¨ë¼ì¡Œë‹¤.



<br>

# ğŸš€ Bounding-box regression

ìš°ë¦¬ëŠ” ì´ì „ ëª¨ë¸ì—ì„œ ì˜ê°ì„ ë°›ì•„ bounding box regression ëª¨ë“ˆì„ ì¶”ê°€í–ˆë‹¤. ë³µì¡í•œ ìˆ˜ì‹ìœ¼ë¡œ í‘œí˜„ë˜ì–´ ìˆì§€ë§Œ ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

![14](https://user-images.githubusercontent.com/96368476/154708578-0a7beec3-53d1-47ab-9f2b-65fe744f17ea.jpg){: width="80%" height="90%" .align-center}

- boxëŠ” xì¢Œí‘œ, yì¢Œí‘œ, ë„“ì´, ë†’ì´ë¡œ ì£¼ì–´ì§
- selective searchê°€ ì˜ˆì¸¡í•œ predict box
- xì¢Œí‘œ, yì¢Œí‘œ : í‰í–‰ì´ë™ ë³€í™˜
- ë„“ì´, ë†’ì´ : ì›ë˜ ê°’ ë¹„ë¡€í•´ì„œ ë³€í™˜
- ë³€í™˜ í›„ boxê°€ Ground-truth box (ì‹¤ì œ box)ì™€ ê°™ì•„ì§€ë„ë¡ training
- ë³€í™˜ ê°’ë“¤ì€ class ë³„ë¡œ 4ê°œì”© training

<br>

## bounding-box regressionì€ ì™œ í•„ìš”í• ê¹Œ?

> ê°œì¸ì ì¸ ìƒê°ì…ë‹ˆë‹¤. ë…¼ë¬¸ì— ë‚˜ì˜¤ëŠ” ë‚´ìš©ì€ ì•„ë‹ˆë‹ˆ ì°¸ê³ í•´ì£¼ì„¸ìš”.

![15](https://user-images.githubusercontent.com/96368476/154710253-9ac5a6c1-b124-44f3-8b35-142e46befe1c.png){: width="80%" height="90%" .align-center}

<br>

## Appendix C : about box regression

![16](https://user-images.githubusercontent.com/96368476/154716153-94353411-4c01-4768-8f09-05791ea7ac3f.png){: width="70%" height="80%" .align-center}

- box regression term + lasso ê·œì œ term
- ëŒë‹¤ ê°’ 1000ìœ¼ë¡œ ê·œì œ êµ‰ì¥íˆ ê°•í•˜ê²Œ í•¨
  - ë¯¸ì„¸ ì¡°ì • 
- ë‹¨ìˆœí•œ positive boxê°€ ì•„ë‹Œ ì§„ì§œ ê°€ê¹Œìš´ boxë“¤ë¡œë§Œ í›ˆë ¨
  - IoU 0.6 ì´ìƒ
- box regression trainingí•˜ë‹ˆ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ í–¥ìƒë˜ì—ˆìŒ
- í…ŒìŠ¤íŠ¸ íƒ€ì„ì—ì„œ box regression ë°˜ë³µì€ ì˜ë¯¸ ì—†ì—ˆìŒ. box ì¡°ì •ì€ í•œ ë²ˆë§Œ


<br>

# ğŸš€ Detection data set

ë³¸ ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ detection data setì€ ILSVRC2013ì´ë‹¤. ì´ data setì€ 200ê°€ì§€ ì¢…ë¥˜ì˜ í´ë˜ìŠ¤ë“¤ì„ ê°€ì§€ê³  ìˆê³ , train(395,918), val(20,121), test(40,152)ê°œë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ê·¼ë° data setì— ë¬¸ì œê°€ ìˆì—ˆë‹¤.

- Training dataì˜ annotationì´ ë¶ˆì™„ì „í•˜ë‹¤
  - ì´ëŸ¬ë©´ objectë¥¼ backgroundë¡œ ì¸ì‹í•´ë²„ë¦¬ê¸° ë•Œë¬¸ì— ë¶ˆì™„ì „í•œ train data ë“¤ì€ ëª¨ë‘ ì œê±°í•¨
  - ê²°ê³¼ì ìœ¼ë¡œ training dataê°€ ë¶€ì¡±í•˜ì—¬ validation dataë¡œë„ í›ˆë ¨ì„ ì§„í–‰í•¨
- Input imageì˜ sizeë²”ìœ„ê°€ ì•„ì£¼ ì‘ì€ ê²ƒë¶€í„° mega-pixelê¹Œì§€ ë§¤ìš° í¼
  - region proposalì— ì˜í–¥ì„ ì£¼ì–´ì„œ widthë¥¼ 500ìœ¼ë¡œ ë¹„ìœ¨ ë§ì¶”ê³  ì‹œì‘í–ˆìŒ


<br>

## Data setì— ë”°ë¥¸ ì„±ëŠ¥ ë¹„êµ

![17](https://user-images.githubusercontent.com/96368476/154723339-1a30c3c2-09d9-45bc-9d16-5141df8aa7b4.png){: width="80%" height="90%" .align-center}

1. training set ê°œìˆ˜ë¥¼ 5000ê°œ ëŠ˜ë ¤ì£¼ë‹ˆ ì„±ëŠ¥ í–¥ìƒ
2. training set 5000ê°œ ë” ì¶”ê°€í–ˆë”ë‹ˆ ì˜í–¥ ì—†ì—ˆìŒ
3. CNN fine-tuning í•´ì£¼ë‹ˆ ì„±ëŠ¥ í–¥ìƒ
4. fine tuning í•  ë•Œ training set ê°œìˆ˜ ëŠ˜ë ¤ì£¼ë‹ˆ ì„±ëŠ¥ í–¥ìƒ
5. box regressioní•˜ë‹ˆ ì„±ëŠ¥ í–¥ìƒ





<br>

# ğŸš€ Conclusion

ìš°ë¦¬ëŠ” Computer Vision ë¶„ì•¼ì— Deep Learning ê¸°ìˆ ì„ ì„±ê³µì ìœ¼ë¡œ ê²°í•©ì‹œì¼°ë‹¤! 




<br>
<br>

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}