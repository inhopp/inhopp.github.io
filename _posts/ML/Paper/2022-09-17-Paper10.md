---
title:  "[ë…¼ë¬¸ ë¦¬ë·°] Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks" 

categories:
  -  Paper
tags:
  - [ML, Object Detection]

toc: true
toc_sticky: true

date: 2022-09-17
last_modified_at: 2022-09-17
---

**Paper: <br>- [Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks](https://github.com/inhopp/inhopp/files/9591173/Faster.RCNN.pdf)**
{: .notice--primary}


<br>

# ğŸš€ Abstract

![inference time](https://user-images.githubusercontent.com/96368476/190867158-1f7d3867-45c4-4e47-9a12-40e8fc3fe96d.png){: width="60%" height="70%" .align-center}

R-CNNì—ì„œ ì‹œì‘í•´ Fast R-CNNê¹Œì§€, Detection ëª¨ë¸ì˜ inference timeì„ ë¹„êµí•˜ë©´ ì •ë§ ë§ì´ ë°œì „í–ˆë‹¤. í•˜ì§€ë§Œ ì—¬ì „íˆ real-timeì´ë¼ ë³´ê¸°ëŠ” í˜ë“¤ë‹¤. ìœ„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ inference timeì˜ ëŒ€ë¶€ë¶„ì´ region proposalì— ì†Œìš”ëœë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ê¸°ì¡´ì˜ region proposal ë°©ì‹ì€ CPUì—ì„œ ì§„í–‰ë˜ëŠ” Selective Search ë°©ë²•ì´ë‹¤. ìš°ë¦¬ëŠ” GPUì—ì„œ ì‘ë™í•˜ë©´ì„œ ì´ë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” CNN, Region Proposal Network(RPN)ë¥¼ ì œì•ˆí•œë‹¤. ì´ë¥¼ í†µí•´ ê¸°ì¡´ì˜ ë°©ì‹ë³´ë‹¤ í›¨ì”¬ ë¹ ë¥´ê²Œ ì˜ì—­ì„ ì œì•ˆí•˜ê³ , Detection ë„¤íŠ¸ì›Œí¬ì™€ ì„±ê³µì ìœ¼ë¡œ ê²°í•©ì‹œì¼œ End-to-End í•™ìŠµë„ ê°€ëŠ¥í•˜ë‹¤. 



<br>


# ğŸš€ Introduction

ê¸°ì¡´ì˜ Object Detection ëª¨ë¸ì€ region proposal ê¸°ë²•ê³¼, region based cnnì˜ ê²°í•©ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. R-CNNì˜ ê²½ìš° ì˜ì—­ë§ˆë‹¤ ë§¤ìš° ë¬´ê±°ìš´ region based cnnì„ ìˆ˜í–‰í–ˆëŠ”ë°, ì´í›„ convolution ì—°ì‚°ì„ ë¨¼ì € í•¨ìœ¼ë¡œì„œ ìˆ˜ë§ì€ ì˜ì—­ë“¤ì´ feature mapì„ ê³µìœ í•˜ê²Œ ë§Œë“¤ì—ˆë‹¤. ê·¸ ê²°ê³¼ ì—°ì‚° ë¹„ìš©ì„ í¬ê²Œ ê°ì†Œì‹œí‚¤ëŠ”ë° ì„±ê³µí–ˆì§€ë§Œ real-timeì´ë¼ í•˜ê¸°ì—ëŠ” ì•„ì§ ê°ˆ ê¸¸ì´ ë©€ì—ˆë‹¤. ë¬¸ì œì˜ ì›ì¸ì€ ì´ë¯¸ì§€ë‹¹ ë¬´ë ¤ 2ì´ˆë‚˜ ì†Œìš”í•˜ëŠ” region proposal method, Selective Search ê¸°ë²•ì´ë‹¤. Selective Search methodëŠ” DNNê¸°ë°˜ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ê¸°ë³¸ì ìœ¼ë¡œ ëŠë¦¬ê³ , CPUì—ì„œ ìˆ˜í–‰í•´ì•¼ í•œë‹¤ëŠ” ì ë„ ë˜ í•˜ë‚˜ì˜ ë‹¨ì ì´ë‹¤. <br> 
Region proposalë„ DNN ê¸°ë°˜ìœ¼ë¡œ gpuì—ì„œ ëŒë¦¬ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì§€ë§Œ ë‘ ê°œì˜ ë„¤íŠ¸ì›Œí¬ê°€ ì„œë¡œ featureë“¤ì„ ê³µìœ í•˜ê³  í•˜ë‚˜ì˜ ë„¤íŠ¸ì›Œí¬ë¡œ ê²°í•©í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•œ ì¼ì´ ì•„ë‹ˆì—ˆì„ ê²ƒì´ë‹¤. ë³¸ ë…¼ë¬¸ì€ ì´ ë¶€ë¶„ì„ ì˜ í•´ê²°í–ˆìœ¼ë©° ê²°ê³¼ì ìœ¼ë¡œ ê¸°ì¡´ì˜ ëª¨ë¸ë³´ë‹¤ mAPë„ ìƒìŠ¹í•˜ê³  ì´ˆë‹¹ 5 fps ì •ë„ê¹Œì§€ ì†ë„ë¥¼ í–¥ìƒì‹œì¼°ë‹¤. ì •ë¦¬í•˜ìë©´ ë³¸ ë…¼ë¬¸ì˜ í•µì‹¬ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- ì²«ì§¸, ë‹¤ì–‘í•œ í¬ê¸°ì™€ ë¹„ìœ¨ì„ ê³ ë ¤í•´ê°€ë©° íš¨ìœ¨ì ìœ¼ë¡œ region proposalì„ ìˆ˜í–‰í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ RPNì„ ì œì•ˆí–ˆë‹¤.
- ë‘˜ì§¸, RPNê³¼ ê¸°ì¡´ì˜ region-based cnnì„ íš¨ê³¼ì ìœ¼ë¡œ ê²°í•©ì‹œì¼œ real-time, end-to-end ëª¨ë¸ì„ ì™„ì„±í–ˆë‹¤.


<br>


# ğŸš€ Related Work

ì™¸ë¶€ì˜ ë…ë¦½ì ì¸ ëª¨ë“ˆì„ ì´ìš©í•´ region proposalì„ í•˜ëŠ” ë°©ì‹ì˜ ë¬¸ì œì¸ì‹ì€ ì´ë¯¸ ì¡´ì¬í–ˆë‹¤. OverFeat, MultiBox methodì™€ ê°™ì´ DNNê¸°ë°˜ì˜ region proposal ë°©ì‹ì´ ëª‡ ì œì•ˆë˜ì—ˆìœ¼ë‚˜, ì´ë“¤ì€ region based cnnê³¼ì˜ featureë“¤ì„ ê³µìœ í•˜ì§€ ëª»í–ˆë‹¤.



<br>


# ğŸš€ Faster R-CNN

![faster-rcnn](https://user-images.githubusercontent.com/96368476/190868489-15045da0-2e26-42f6-9c2d-5738fe9baa28.png){: width="50%" height="60%" .align-center}

Faster R-CNNì€ region proposalì„ ë‹´ë‹¹í•˜ëŠ” RPN, region based cnnì„ ë‹´ë‹¹í•˜ëŠ” fast r-cnn(exept SS module) ë‘ ëª¨ë“ˆë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. RPNì€ ë§ˆì¹˜ Attention ë©”ì»¤ë‹ˆì¦˜ì²˜ëŸ¼ fast r-cnnì´ ì–´ë””ë¥¼ ë´ì•¼í•˜ëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” ì—­í• ì„ í•˜ê³ , ë‘ ëª¨ë“ˆì€ í•˜ë‚˜ì˜ í†µí•©ëœ ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬ì„±í•œë‹¤.


<br>


## Region Proposal Networks (RPN)

![rpn_](https://user-images.githubusercontent.com/96368476/190888727-a05643e9-e6bc-499d-be65-e27f51048ff8.png){: width="60%" height="70%" .align-center}

RPNì€ windowê°€ ì›€ì§ì´ë©´ì„œ kê°œì˜ ë‹¤ì–‘í•œ ì˜ì—­ì— ëŒ€í•´ region proposalì„ ìˆ˜í–‰í•œë‹¤. ë„¤íŠ¸ì›Œí¬ëŠ” ì´ë¯¸ì§€ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ìœ¼ë©° 2k socres(objectê°€ ìˆëŠ”ì§€ ì—¬ë¶€), 4k coordinates(bounding box coordinates)ë¥¼ ë°˜í™˜í•œë‹¤. <br>


![anchorbox](https://user-images.githubusercontent.com/96368476/190888372-1a5b3b42-d34f-4915-a6a5-448e3ff76ada.jpeg){: width="50%" height="60%" .align-center}

"Anchor"ë¼ ë¶ˆë¦¬ìš°ëŠ” ë‹¤ì–‘í•œ ì˜ì—­ í›„ë³´ëŠ” 3ê°€ì§€ í¬ê¸°, 3ê°€ì§€ ë¹„ìœ¨ ì´ 9ê°€ì§€ë¡œ êµ¬ì„±ëœë‹¤. 


<br>


### Translation-Invariant Anchors

![anchor2](https://user-images.githubusercontent.com/96368476/190889002-9331648c-dcdc-49bf-980a-7293da7b1905.png){: width="50%" height="60%" .align-center}

ê¸°ì¡´ ë°©ì‹ë“¤ê³¼ ë‹¬ë¦¬ anchorê¸°ë°˜ region proposalì€ translation invariantí•˜ë‹¤. ì¦‰, ê°™ì€ ì´ë¯¸ì§€ ìœ„ì—ì„œ objectì˜ ìœ„ì¹˜ê°€ ë°”ë€Œë”ë¼ë„ RPNì€ ì˜í–¥ì„ ë°›ì§€ ì•Šê³  ì˜ ì°¾ì•„ë‚¸ë‹¤. ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì€ anchorë“¤ì´ ì´ë¯¸ì§€ì˜ ì–´ë–¤ ì˜ì—­ë“¤ì„ ì‚´í”¼ëŠ”ì§€ë¥¼ ë¶‰ì€ìƒ‰ ì„ ìœ¼ë¡œ í‘œí˜„í•œ ê²ƒì´ë‹¤. ì¡°ê¸ˆì˜ ëª¨ì„œë¦¬ ë¶€ë¶„ì„ ì œì™¸í•˜ê³  ì´ë¯¸ì§€ ì „ì²´ë¥¼ ê³¨ê³ ë£¨ ì‚´í´ë³´ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ Translation-Invariantí•œ ì„±ì§ˆ ë•ë¶„ì— RPNì€ overffiting riskë„ ì ê³  ë„¤íŠ¸ì›Œí¬ë„ í›¨ì”¬ ê°€ë²¼ì›Œì¡Œë‹¤.


<br>


### Multi-Scale Anchors as Regression References

![anchor3](https://user-images.githubusercontent.com/96368476/190889231-d14d70c0-33fb-4e20-a64b-835815379d08.png){: width="50%" height="60%" .align-center}

Multi-scale predictionì—ëŠ” ì„¸ ê°€ì§€ ë°©ë²•ì´ ì¡´ì¬í•œë‹¤. ì²«ì§¸, ê·¸ë¦¼ (a)ì—ì„œ ë³´ì—¬ì£¼ëŠ” image/feature pyramid ë°©ì‹ì´ë‹¤. ì´ ë°©ë²•ì€ íš¨ê³¼ì ì„ ìˆ˜ ìˆìœ¼ë‚˜ ì‹œê°„ì´ë‚˜ ë©”ëª¨ë¦¬ ì¸¡ë©´ì—ì„œ í˜„ì‹¤ì ì¸ ì–´ë ¤ì›€ì´ ì¡´ì¬í•œë‹¤. ë‘˜ì§¸, (b)ì—ì„œ ë³´ì—¬ì£¼ëŠ” pyramid of flters ë°©ì‹. ì´ ë°©ë²•ì€ image pyramidë°©ì‹ë³´ë‹¤ íš¨ìœ¨ì ì´ì§€ë§Œ ìœ„ì¹˜ë³„ë¡œ ë‹¤ì–‘í•œ í•„í„°ê°€ í•„ìš”í•˜ë‹¤. ë”°ë¼ì„œ region-based cnnê³¼ featureë¥¼ ê³µìœ í•  ìˆ˜ ì—†ë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” ìœ„ ë‘ ë¬¸ì œë¥¼ ëª¨ë‘ í•´ê²°í•˜ëŠ” pyramid of anchors ë°©ì‹ì„ ì‚¬ìš©í–ˆë‹¤.



<br>



### Loss Function

![rpn](https://user-images.githubusercontent.com/96368476/190888612-c24d1f89-6dde-443e-b91a-4c2f6062bd77.png){: width="50%" height="60%" .align-center}

RPNì˜ ê° anchor boxë§ˆë‹¤ objectê°€ ì¡´ì¬í•˜ëŠ”ì§€ë¥¼ ì˜ë¯¸í•˜ëŠ” binary class labelì´ ì¡´ì¬í•œë‹¤. ì´ë•Œ positive labelì„ ì£¼ëŠ” ê²½ìš°ëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ì´ë‹¤.

- 1) ground truth boxì™€ IoUê°€ ê°€ì¥ ë†’ì€ anchor box
- 2) ground truth boxì™€ì˜ IoUê°€ 0.7 ì´ìƒì¸ ê²½ìš°

ì—¬ê¸°ì„œ ì£¼ëª©í•  ì ì€ ground truth box í•˜ë‚˜ê°€ ì—¬ëŸ¬ê°œì˜ anbchor boxë¥¼ positive labelë¡œ ì„ íƒí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ë³´í†µì€ 2ë²ˆ ì¡°ê±´ìœ¼ë¡œ ê²°ì •ëœ positive label anchor boxê°€ 1ë²ˆ ì¡°ê±´ê³¼ ê²¹ì¹˜ì§€ë§Œ, 2ë²ˆ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” anchor boxê°€ ì—†ëŠ” ê²½ìš° 1ë²ˆ ì¡°ê±´ìœ¼ë¡œ positive anchor boxë¥¼ ì°¾ê²Œëœë‹¤. ë°˜ëŒ€ë¡œ ground truth boxì™€ì˜ IoUê°€ 0.3 ì´í•˜ì¸ ê²½ìš°ì—ë§Œ negative labelì„ ë¶€ì—¬í•˜ë©° negativeë„ positiveë„ ì•„ë‹Œ anchorì— ëŒ€í•´ì„œëŠ” í•™ìŠµì„ ì§„í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.


<br>


$$ \mathbf{L}(\left\{p_{i} \right\}, \left\{t_{i} \right\}) = \frac{1}{\mathbf{N}_{cl}}\sum_{i}^{}\mathbf{L}_{cls}\left ( p_{i}, p_{i}^{*} \right ) + \lambda \frac{1}{\mathbf{N}_{reg}}\sum_{i}^{}p_{i}^{*}\mathbf{L}_{reg}\left ( t_{i}, t_{i}^{*} \right ) $$

- i : index of anchor in mini-batch
- p_i : anchor ë‚´ object ìˆì„ í™•ë¥ 
- p_i* : ground truth label
- t_i : vector associated with predicted bounding box coordinates
- t_i* : vector associated with ground truth box coordinates
- L_cls : log loss
- L_reg : smooth L1 loss
- N_cls : size of mini-batch (default=256)
- N_reg : the number of anchor location
- Î» : balancing parameter (default=10)


<br>


## Training RPNs

ëª¨ë“  Region proposal methodê°€ ê·¸ë ‡ë“¯ì´ RPNë˜í•œ positive label anchor ë³´ë‹¤ negative label anchorê°€ í›¨ì”¬ ë§ì„ ê²ƒì´ë‹¤. ë”°ë¼ì„œ ëª¨ë“  anchor boxë“¤ì„ í•™ìŠµì‹œí‚¤ë©´ negative labelì— í¬ê²Œ ì¹˜ìš°ì¹œ í•™ìŠµì„ ì§„í–‰í•œë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë§‰ê¸° ìœ„í•´ ê° ë¯¸ë‹ˆë°°ì¹˜ì—ì„œ positive/negative ë¹„ìœ¨ì„ 1:1ë¡œ ë§ì¶°ê°€ë©° anchor boxë“¤ì„ ìƒ˜í”Œë§í•œë‹¤. 




<br>
<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}