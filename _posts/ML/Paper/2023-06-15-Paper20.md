---
title:  "[Paper Review] PGGAN : Progressive Growing of GANs for Improved Quality, Stability, and Variation" 

categories:
  -  Paper
tags:
  - [ML, Generative]

toc: true
toc_sticky: true

date: 2023-06-15
last_modified_at: 2023-06-15
---

**Main Reference: <br>- [PGGAN Paper](https://arxiv.org/abs/1710.10196)**
{: .notice--primary}

<br>


# ğŸš€ Introduction

ìµœê·¼ ì£¼ëª©ë°›ê³  ìˆëŠ” ìƒì„±ëª¨ë¸ë“¤ì˜ ì¥ë‹¨ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- Autoregressive model (ex. Pixel CNN) : produce sharp image / slow to evaluate / no latent space
- VAE : easy to train / produce blurry image
- GAN : produce sharp image / unstable training / low resolution & limited variation

íŠ¹íˆ GANì˜ ê²½ìš° ëª‡ ê°€ì§€ ë¬¸ì œê°€ ì¡´ì¬í•œë‹¤. ë¨¼ì €, GeneratorëŠ” KL-Divergenceë¥¼ ì´ìš©í•´ training distributionê³¼ generated distributionì„ ê°™ì•„ì§€ê²Œ í•˜ëŠ” ê²ƒì´ ëª©ì ì´ë‹¤. ì´ë•Œ ë‘ ë¶„í¬ì˜ ê²¹ì¹˜ëŠ” ë¶€ë¶„ì´ ì ë‹¤ë©´(í•™ìŠµ ì´ˆë°˜) graidnetê°€ ëœë¤í•œ ë°©í–¥ì„ ê°€ë¦¬í‚¤ê²Œ ëœë‹¤. ìµœê·¼ì—ëŠ” KL-Divergence ëŒ€ì‹  least-square, absolute deviation, ë˜ëŠ” Wasserstein distanceë¥¼ ì´ìš©í•´ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. ë³¸ ë…¼ë¬¸ì˜ ê²½ìš° Wasserstein lossë¥¼ ì¡°ê¸ˆ ê°œëŸ‰í•´ì„œ ì‚¬ìš©í•˜ì˜€ë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ GANì˜ ê²½ìš° High resolution ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê¸°ê°€ ì–´ë µë‹¤. ê·¸ ì´ìœ ëŠ” high resolutionìœ¼ë¡œ ê°ˆìˆ˜ë¡ training imageì™€ generated image ì‚¬ì´ì˜ ê±°ë¦¬ê°€ ë©€ì–´ì§€ê¸° ë•Œë¬¸ì´ë‹¤. ì´ëŸ° ê²½ìš° gradientê°€ í¬ê²Œí¬ê²Œ ì›€ì§ì´ë¯€ë¡œ ì•ˆì •ì ìœ¼ë¡œ í•™ìŠµí•˜ê¸°ê°€ ì–´ë ¤ì›Œì§„ë‹¤. ë˜í•œ resolutionì´ ì»¤ì§€ë©´ ë©”ëª¨ë¦¬ ì´ìŠˆë•Œë¬¸ì— batch sizeê°€ ì‘ì•„ì§€ê³ (stableí•œ í•™ìŠµì„ ìœ„í•´ì„œë„ ë‚®ì€ batch sizeê°€ ìœ ë¦¬), í•™ìŠµì´ ì˜¤ë˜ ê±¸ë¦¬ê²Œ ëœë‹¤. ë³¸ ë…¼ë¬¸ì˜ ê²½ìš° Generatorì™€ Discriminator ëª¨ë‘ progressiveí•˜ê²Œ í•™ìŠµí•˜ì—¬ í•™ìŠµ ì†ë„ì™€ ìƒì„±ëœ ì´ë¯¸ì§€ì˜ í€„ë¦¬í‹°ë¥¼ ëª¨ë‘ í–¥ìƒì‹œì¼°ë‹¤.



<br>


# ğŸš€ Progressive Growing of GANs

![1](https://github.com/inhopp/inhopp/assets/96368476/6d4d90b7-c5e9-4ac7-8938-7b9e36ee5033){: width="70%" height="80%" .align-center}

PGGANì˜ í•µì‹¬ ì•„ì´ë””ì–´ëŠ” 4x4 low resolutionìœ¼ë¡œ ì‹œì‘í•´ high resolution ë””í…Œì¼ë“¤ì„ ìƒì„±í•˜ëŠ” layerë“¤ì„ ì¶”ê°€í•´ì£¼ëŠ” ê²ƒì´ë‹¤. ì´ëŸ° ì ì§„ì ì¸ ë°©ì‹ì€ ë™ì‹œì— ëª¨ë“  ìŠ¤ì¼€ì¼ì„ í•™ìŠµí•˜ì§€ ì•Šê³ , ë¨¼ì € large-scale stuructureë¥¼ í•™ìŠµí•œ ë’¤ ë””í…Œì¼ë“¤ì„ í•™ìŠµí•˜ê²Œ ëœë‹¤. 


![2](https://github.com/inhopp/inhopp/assets/96368476/59422153-67d2-440a-871c-7fd49b3f4655){: width="70%" height="80%" .align-center}

ì´ë•Œ ìƒˆë¡œìš´ layerëŠ” ìì—°ìŠ¤ëŸ¬ìš´ fade-in ë°©ì‹ìœ¼ë¡œ ì¶”ê°€í•´ì¤€ë‹¤. ìœ„ ë°©ì‹ì€ ê¸°ì¡´ì˜ ì˜ í›ˆë ¨ëœ row resolution layerê°€ ê°‘ìê¸° í° ì¶©ê²©ì„ ë°›ëŠ” ê²ƒì„ ë°©ì§€í•´ì¤Œìœ¼ë¡œì¨ í›ˆë ¨ì„ ì•ˆì •ì ìœ¼ë¡œ í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. <br>ì´ëŸ¬í•œ progressive leariningì€ ëª‡ ê°€ì§€ ì¥ì ì´ ì¡´ì¬í•œë‹¤. ìš°ì„  ì´ˆê¸°ì˜ row resolution ì´ë¯¸ì§€ì—ì„œëŠ” í´ë˜ìŠ¤ ì •ë³´ë‹¤ ëª¨ë“œì˜ ê°¯ìˆ˜ê°€ ì ê¸° ë•Œë¬¸ì— ì´ë¯¸ì§€ ìƒì„±ì´ ì•ˆì •ì ì´ë‹¤(4x4 í¬ê¸°ì˜ ì´ë¯¸ì§€ ë¶„í¬ëŠ” ë­‰ì³ì ¸ìˆìŒ). ê·¸ ë‹¤ìŒ resolutionì„ ì¡°ê¸ˆì”© ì¦ê°€ì‹œì¼œ ë””í…Œì¼ë“¤ì„ ì¶”ê°€í•´ì£¼ëŠ” ë°©ì‹ì´ê¸° ë•Œë¬¸ì—, ê¸°ì¡´ GANì²˜ëŸ¼ latentì—ì„œ ë°”ë¡œ ê°€ëŠ” ë§¤í•‘ë³´ë‹¤ í›¨ì”¬ ì•ˆì •ì ì´ë‹¤. ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ 1024x1024ë¼ëŠ” ì „ë¡€ ì—†ëŠ” í•´ìƒë„ì˜ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ í•™ìŠµ ì†ë„ë„ 2ë°°~6ë°°ê¹Œì§€ ë‹¨ì¶•ë˜ì—ˆë‹¤.


<br>



# ğŸš€ Increasing Variation Using Minibatch Standard Deviation

![3](https://github.com/inhopp/inhopp/assets/96368476/ffc65ade-fb89-45fa-815e-2dfc0a6caf6b){: width="60%" height="70%" .align-center}

GANì€ training dataì˜ subsetë§Œ ìƒì„±í•˜ëŠ” ê²½í–¥ì´ ìˆë‹¤(mode collapse). PGGANì—ì„œëŠ” Slimansê°€ ì œì•ˆí•œ "minibatch discrimanation"ì„ ì‚¬ìš©í–ˆë‹¤. ì´ ë°©ë²•ì€ ê°œë³„ì ì¸ ì´ë¯¸ì§€ë¿ë§Œ ì•„ë‹ˆë¼ mini-batch ì•ˆì—ì„œ feature statisticì„ ê³„ì‚°í•œë‹¤. í•´ë‹¹ ì—°ì‚°ì„ ë‹´ë‹¹í•˜ëŠ” layerëŠ” ì—¬ëŸ¬ ì‹¤í—˜ ê²°ê³¼ Discriminator ë§¨ ëë‹¨ì— ì¶”ê°€í•´ì£¼ëŠ” ê²ƒì´ ê°€ì¥ ì¢‹ì•˜ë‹¤. ê³„ì‚° ë°©ë²•ì€ mini-batch sampleë“¤ì—ì„œ ìƒì„±ëœ í†µê³„ì¹˜ë“¤ì„ output layerì— concatì‹œì¼œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤. Learnable parametersë‚˜ ìƒˆë¡œìš´ hyper parametersê°€ í•„ìš”ë¡œ í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë‹¨ìˆœí•˜ë©´ì„œë„ íš¨ê³¼ê°€ ì¢‹ì€ ë°©ì‹ì´ë‹¤. ì´ ë°©ë²• ì´ì™¸ì—ë„ Generatorì— ìƒˆë¡œìš´ lossë¥¼ ì¶”ê°€í•´ì£¼ëŠ” "repelling regularizer" ë°©ì‹ë„ ì¡´ì¬í•œë‹¤ê³  í•œë‹¤.


<br>



# ğŸš€ Normalization in Generator and Discriminator

GANì˜ ê²½ìš° generatorì™€ discriminator ì‚¬ì´ì˜ ê±´ê°•í•˜ì§€ ëª»í•œ ê²½ìŸìœ¼ë¡œ ì–‘ìª½ì˜ ì‹ í˜¸ê°€ ì»¤ì§€ëŠ” ê²½í–¥ì´ ìˆë‹¤. ê¸°ì¡´ì—ëŠ” G, Dì— batch nomalizationì„ ì´ìš©í•´ ìœ„ ë¬¸ì œë¥¼ ê°„ë‹¨íˆ í•´ê²°í•´ì™”ë‹¤. í•˜ì§€ë§Œ ì´ëŸ¬í•œ nomalization ê¸°ë²•ì€ ë³¸ë˜ covariate shiftë¥¼ ì œê±°í•˜ê¸° ìœ„í•´ ë“±ì¥í•˜ì˜€ëŠ”ë°, ì €ìë“¤ì€ GANì˜ í•™ìŠµ ê³¼ì •ì—ì„œ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë°œê²¬í•˜ì§€ ëª»í–ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ì‹¤ì§ˆì ìœ¼ë¡œ ì‹ í˜¸ì˜ ì„¸ê¸°ë¥¼ ì œí•œí•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤ê³  ìƒê°í–ˆë‹¤. ì €ìë“¤ì€ ìƒˆë¡œìš´ learnable paramertsê°€ í•„ìš” ì—†ëŠ” ë‘ ê°€ì§€ ë°©ì‹ì„ ì œì•ˆí–ˆë‹¤.

- ëª¨ë“  layerë“¤ì´ ë™ì¼í•œ learning speedë¥¼ ê°–ê²Œ í•˜ê¸° ìœ„í•´, weightì™€ ë¬´ê´€í•˜ê²Œ gradientë¥¼ runtimeì— normalization (Equalized Learning Rate)
- Pixelë§ˆë‹¤ feature vectorë¥¼ unit lengthë¡œ normalize (signal ì¦í­ ì œì–´)



<br>



# ğŸš€ Multi-Scale Statistical Similarity for Assessing GAN Results

![5](https://github.com/inhopp/inhopp/assets/96368476/517a5668-e70f-4a4f-abfc-cdb79b7d7342){: width="60%" height="70%" .align-center}

- ì €ìë“¤ì´ ì œì•ˆí•œ ë‹¤ì–‘í•œ ê¸°ë²•ë“¤ì— ë”°ë¥¸ ì§€í‘œ
- CelebA ë°ì´í„°ì˜ (a)ì™€ (h)ëŠ” MS-SSIM ë©”íŠ¸ë¦­ì˜ ì°¨ì´ëŠ” ì—†ì§€ë§Œ ì‹¤ì œ í€„ë¦¬í‹° ì°¨ì´ëŠ” ì—„ì²­ë‚¨ -> ì¢‹ì€ ì§€í‘œê°€ ì•„ë‹˜

ì„œë¡œ ë‹¤ë¥¸ GAN ëª¨ë¸ë“¤ì„ ë¹„êµí•˜ê¸° ìœ„í•´ì„œëŠ” ì–´ë§ˆì–´ë§ˆí•˜ê²Œ ë§ì€ ë°ì´í„°ë“¤ì„ ë¹„êµí•´ì•¼ í•œë‹¤. ê¸°ì¡´ì—ëŠ” MS-SSIM ë°©ì‹ì„ ì´ìš©í•´ ìë™í™”ëœ ê¸°ë²•ì„ ì‚¬ìš©í•´ì™”ë‹¤. í•˜ì§€ë§Œ ì´ ë°©ì‹ì€ large-scale mode collapseë¥¼ ì°¾ì•„ë‚¼ ìˆ˜ ìˆì§€ë§Œ, smaller featureë“¤ì— ì˜ ë°˜ì‘í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œê°€ ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ ì €ìë“¤ì€ ìƒì„±ëœ ì´ë¯¸ì§€ê°€ í•™ìŠµ ì´ë¯¸ì§€ì™€ local-structureê°€ ë¹„ìŠ·í•´ì•¼ í•œë‹¤ëŠ” ì§ê´€ìœ¼ë¡œ Laplacian pyramidë¡œ í‘œí˜„ëœ ë‘ íŒ¨ì¹˜ ë¶„í¬ ì‚¬ì´ì˜ í†µê³„ì  ìœ ì‚¬ì¹˜ë¥¼ ê³ ë ¤í–ˆë‹¤. íŒ¨ì¹˜ë“¤ê°„ì˜ sliced Wasserstein Distance(SWD) metricì€ ìƒì„±ëœ ì´ë¯¸ì§€ì˜ qualityì™€ variation ëª¨ë‘ë¥¼ í‰ê°€í•˜ëŠ” ì¢‹ì€ ì§€í‘œë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.



<br>



# ğŸš€ Experiments

![4](https://github.com/inhopp/inhopp/assets/96368476/1864e607-732b-4feb-b861-d82263146774){: width="60%" height="70%" .align-center}

- 1024x1024 ìƒì„± ì´ë¯¸ì§€. ì„¸ìƒì—ë‚˜


<br>








# ğŸš€ Code

> [PGGAN from scartch (pytorch)](https://github.com/inhopp/PGGAN)

| Sample 1 | Sample 2 |
|:-:| :-: |
| ![img_8](https://github.com/inhopp/inhopp/assets/96368476/25bf03f1-6a24-48fc-825f-636e0e4c3b54) | ![img_3](https://github.com/inhopp/inhopp/assets/96368476/b60ec28f-3025-4756-9b82-4150136abdbf)
 |

1024x1024ë¼ ê·¸ëŸ°ì§€ ì˜¤ë˜ ëŒë ¤ë„ í€„ë¦¬í‹°ê°€ ë‚®ìŒ..

<br>
<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}