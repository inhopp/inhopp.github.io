---
title:  "[ë…¼ë¬¸ ë¦¬ë·°] R-CNN ë°°ê²½ì§€ì‹" 

categories:
  -  Paper
tags:
  - [ML, Paper]

toc: true
toc_sticky: true

date: 2022-02-17
last_modified_at: 2022-02-17
---

**Main Reference: <br>- [Deep Learning for Computer Vision](https://www.youtube.com/watch?v=dJYGatp4SvA&list=PL5-TkQAfAZFbzxjBHtzdVCWE0Zbhomg7r)** <br> ì¤‘ê°„ì— ë“±ì¥í•˜ëŠ” pptëŠ” ê°•ì˜ìë£Œë¥¼ ìº¡ì²˜í•œ ê²ƒì…ë‹ˆë‹¤.
{: .notice--warning}



<br>

# ğŸš€ Introduction

![1](https://user-images.githubusercontent.com/96368476/154297787-d69ddfd6-6e34-4b5e-a361-af5149b909bf.png){: width="60%" height="70%" .align-center}

ì´ë²ˆì— ì†Œê°œí•  R-CNN ë…¼ë¬¸ì€ ë”¥ëŸ¬ë‹ì„ ì´ìš©í•œ ìµœì´ˆì˜ Object Detection ì•Œê³ ë¦¬ì¦˜ì´ë¼ í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  ë¹„ìŠ·í•œ ì‹œë„ëŠ” ìˆì—ˆì§€ë§Œ, ì™„ì„±ë„ ì¸¡ë©´ì—ì„œ ì²« ì‹œë„ë¼ í•  ìˆ˜ ìˆê² ë‹¤. ìµœê·¼ ì‚¬ìš©ë˜ëŠ” Object Detection & Semantic Sementation ê¸°ë²•ì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œ R-CNNì˜ ë‚´ìš©ì€ í•„ìˆ˜ì ìœ¼ë¡œ ì•Œì•„ì•¼ í•œë‹¤.


<br>

# ğŸš€ Object Detectionì€ ì™œ ì–´ë ¤ìš¸ê¹Œ?

R-CNN version1ì´ ì¶œì‹œëœ 2013ë…„ì˜ ìƒí™©ì„ ìƒìƒí•´ë³´ì. 2012ë…„ ë”¥ëŸ¬ë‹ì„ ì´ìš©í•œ image classification ëª¨ë¸ì¸ AlexNetì´ ë“±ì¥í•˜ë©´ì„œ ì‚¬ëŒë“¤ì€ image classificationì— ëŒ€í•´ì„œëŠ” ìì‹ ê°ì„ ì–»ì—ˆì„ ê²ƒì´ë‹¤. ê·¸ í›„ ìì—°ìŠ¤ëŸ½ê²Œ classificationì˜ ë‹¤ìŒ ë‹¨ê³„ì¸ object detection ë¶„ì•¼ì— ëˆˆë… ë“¤ì˜€ì„ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì¡°ê¸ˆë§Œ ìƒê°í•´ë´ë„ object detection ëª¨ë¸ì€ í›¨ì”¬ ê¹Œë‹¤ë¡­ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
<br>

![2](https://user-images.githubusercontent.com/96368476/154305212-c72d9dd9-c60d-4936-b694-501b8970d4a5.png){: width="50%" height="60%" .align-center}

- **Input** : í•˜ë‚˜ì˜ RGB Image
- **Multiple Output** : ëª‡ ê°œì˜ objectê°€ ì¡´ì¬í•˜ëŠ” ì§€ëŠ” ì´ë¯¸ì§€ë§ˆë‹¤ ë‹¤ë¥´ë‹¤
- **Multiple types of output** : í•˜ë‚˜ì˜ objectë§ˆë‹¤ ì–´ë–¤ ì¹´í…Œê³ ë¦¬ì— ì†í•˜ëŠ”ì§€(what), ì–´ë””ì— ìˆëŠ”ì§€(where) ì¦‰, ë‹¤ë¥¸ íƒ€ì…ì˜ outputì´ í•„ìš”í•˜ë‹¤.
- **Large Image** : object detectionì€ ê¸°ë³¸ì ìœ¼ë¡œ ë†’ì€ í•´ìƒë„ê°€ ìš”êµ¬ëœë‹¤.

<br>

## Sliding Window

![3](https://user-images.githubusercontent.com/96368476/154308021-72c2d46a-b8b8-40ed-a523-07fc51cfce59.png){: .align-center}

ê°€ì¥ ë¨¼ì € ë– ì˜¤ë¥´ëŠ” ë°©ë²•ì€ ê³ ì •ì‹œí‚¨ bounding boxë¥¼ sliding í•˜ë©´ì„œ detection í•˜ëŠ” ë°©ë²•ì¼ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ê°€ëŠ¥í•œ bounding boxì˜ ëª¨ì–‘, bouding boxì˜ ìœ„ì¹˜ë¥¼ ê³ ë ¤í•˜ë©´ ëˆˆì•ì´ ìº„ìº„í•´ì§„ë‹¤. R-CNN ì—ì„œ ëŒ€ì•ˆìœ¼ë¡œ ì‚¬ìš©í•œ ë°©ë²•ì€ í›„ë³´ ì˜ì—­ë“¤ì„ ì œì•ˆí•´ì£¼ëŠ” Region Proposal ë°©ë²•ì´ë‹¤. ì—¬ë‹´ìœ¼ë¡œ R-CNNì´ ë‚˜ì˜¤ê¸° ì§ì „ ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ì€ **Overfeat Detection** ëª¨ë¸ì€ sliding windowë¥¼ ì´ìš©í•œ ë°©ë²•ì´ë‹¤. ë…¼ë¬¸ì—ì„œ ìš°ë¦¬ê°€ ë§Œë“  R-CNNì´ overfeat ë³´ë‹¤ ì¢‹ë‹¤ê³  ê³„ì† ë¶€ê´€ì°¸ì‹œí•˜ë”ë¼.


<br>

# ğŸš€ Region Proposal

![4](https://user-images.githubusercontent.com/96368476/154305238-3d65a001-2c85-4004-8179-22f66e808796.png){: .align-center}

Region Proposalì€ objectê°€ ìˆì„ ë§Œí•œ ìœ„ì¹˜ í›„ë³´êµ°ì„ ì œì‹œí•´ì£¼ëŠ” ëª¨ë¸ì´ë‹¤. ì´ëŠ” ê¸°ì¡´ì˜ Computer Vision ë¶„ì•¼ì—ì„œë„ ë…¼ë¬¸ì´ ìš°ìˆ˜ìˆ˜ ìŸì•„ì§€ëŠ” ëœ¨ê±°ìš´ ì£¼ì œì˜€ëŠ”ë° ìƒíƒœê³„ íŒŒê´´ ì¢… ë”¥ëŸ¬ë‹ì˜ ë“±ì¥ ì´í›„ ëª¨ë“  ì•Œê³ ë¦¬ì¦˜ì€ ì”¹ì–´ ë¨¹í˜”ë‹¤ê³  í•œë‹¤. (ë”¥ëŸ¬ë‹ ì—”ë”©..) ì•„ë¬´íŠ¼ ë³¸ ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ Region Proposal ì•Œê³ ë¦¬ì¦˜ì¸ Selective Searchì— ëŒ€í•´ ì•Œì•„ë³´ì.

<br>

## Selective Search

**ìƒìƒ ì† selective search**

![5](https://user-images.githubusercontent.com/96368476/154314768-a47129e9-3508-4165-b842-55d8ffc3e349.png){: width="80%" height="90%" .align-center}

Selective Searchì˜ ê³¨ìëŠ” Color, Texture, Size, Fill ì´ë ‡ê²Œ 4ê°€ì§€ êµ¬ì„± ìš”ì†Œë¡œ ì£¼ë³€ ì˜ì—­ë“¤ê³¼ì˜ Similarityë¥¼ ê³„ì‚°í•œë‹¤. ê·¸ í›„ similarityê°€ ë¹„ìŠ·í•œ ì˜ì—­ë“¤ì„ mergeí•´ ë‚˜ê°€ë©´ì„œ ìµœí›„ì— ë‚¨ëŠ” ì˜ì—­ë“¤ì„ ì œì•ˆí•´ì£¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. í•˜ì§€ë§Œ ìµœí›„ì— ë‚¨ëŠ” ì˜ì—­ë“¤ì„ ì œì•ˆë°›ìœ¼ë©´ ë†“ì¹˜ëŠ” object ë“¤ì´ ë„ˆë¬´ ë§ì•„ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” 2ì²œ ê°œì˜ í›„ë³´ ì˜ì—­ì„ ì œì•ˆë°›ëŠ”ë‹¤.

<br>

**í˜„ì‹¤**

![6](https://user-images.githubusercontent.com/96368476/154314775-135b9caf-5a10-45d4-8644-a255c56f4cda.png){: width="70%" height="80%" .align-center}

ê·¸ë˜ë„ 2ì²œ ê°œì˜ ì˜ì—­ì„ cpuë¡œ ëª‡ ì´ˆì•ˆì— ê³„ì‚°í•´ ë‚´ëŠ” í›Œë¥­í•œ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. Selective Searchì˜ ê°€ì¥ í° ë¬¸ì œëŠ” ê°™ì€ objectë¥¼ ëª‡ í”½ì…€ ì°¨ì´ë¡œ ì—¬ëŸ¬ ë²ˆ ì œì•ˆí•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ ì¤‘ë³µëœ boxë¥¼ ì œê±°í•˜ëŠ” ë°©ë²•ì´ í•„ìš”í•œë° ì´ ë•Œ ì‚¬ìš©ë˜ëŠ” ê°œë…ì´ IoU, NMS ì´ë‹¤.


<br>

## IoU - Intersection over Union

![7](https://user-images.githubusercontent.com/96368476/154318915-63b70d79-701a-4dc7-ae97-a370fc4f2668.png){: width="50%" height="60%" .align-center}

ìš°ë¦¬ì˜ ì „ëµì€ ì‹¤ì œ bounding boxì¸ Ground-Truth boxì™€ ê°€ì¥ ê°€ê¹Œìš´ boxë¥¼ ë¹¼ê³  ì „ë¶€ ì¹˜ì›Œë²„ë¦¬ëŠ” ê²ƒì´ë‹¤. ê·¸ë ¤ë ¤ë©´ ë‘ boxê°€ ì„œë¡œ ê°€ê¹ë‹¤ëŠ” ê²ƒì´ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ë¥¼ ì •í•´ì•¼ í•˜ëŠ”ë° ê·¸ ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ì¤€ì´ ë°”ë¡œ **IoU** ì´ë‹¤.

<br>

![8](https://user-images.githubusercontent.com/96368476/154318916-1c716636-247b-4746-a078-d765c9313b18.png){: .align-center}

- IoU > 0.5 : ìŒ ê·¸ëŸ­ì €ëŸ­ ì˜ ë§ë„¤
- IoU > 0.7 : ì•„ì£¼ ì¢‹ì•„
- IoU > 0.9 : ì™„ë²½í•´! (ì‹¤ì œë¡œëŠ” pixel ëª‡ ê°œ ì°¨ì´)

ì´ì œ box-metricì„ ì •ì˜í–ˆìœ¼ë‹ˆ, Non-Max Suppression(NMS) ì•Œê³ ë¦¬ì¦˜ì„ ì´í•´í•  ìˆ˜ ìˆë‹¤. NMSëŠ” ë§ ê·¸ëŒ€ë¡œ maxê°’ ë¹¼ê³  ì „ë¶€ ì••ì¶•ì‹œí‚¤ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

<br>

## NMS - Non Max Suppression

![9](https://user-images.githubusercontent.com/96368476/154318918-d9c90def-0634-4041-88a0-1a85cbe88cf4.png){: width="50%" height="60%" .align-center}

1. ê°€ì¥ ì ìˆ˜ê°€ ë†’ì€ box ì„ íƒ
2. IoU > threshold (ex 0.7) ì¸ boxë“¤ ì „ë¶€ ì œê±°
   - threshold ê°’ì€ hyper parameter
3. ë‹¤ì‹œ 1ë²ˆìœ¼ë¡œ (ë‚¨ëŠ” boxê°€ ì—†ì„ ë•Œê¹Œì§€)

<br>

![10](https://user-images.githubusercontent.com/96368476/154318900-472a718d-aef7-4711-a590-1f486b2fe073.png){: .align-center}


<br>

## NMS í•œê³„

![11](https://user-images.githubusercontent.com/96368476/154318912-e8697b16-3e19-4595-9e0d-23198cfb3de8.png){: width="50%" height="60%" .align-center}

- NMSëŠ” Object Detection ë¶„ì•¼ì—ì„œ ë°˜ë“œì‹œ í•„ìš”í•œ ì¢‹ì€ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.
- í•˜ì§€ë§Œ objectë“¤ì´ highly overlappingë˜ë©´ **<span style="color:red">ì‹¤ì œ í•„ìš”í•œ boxë“¤ë„ ì§€ìš°ê²Œ ëœë‹¤.</span>**
- ì´ëŠ” Object Detection ë¶„ì•¼ì˜ Open Problem ì´ë¼ê³  í•œë‹¤.




<br>

# ğŸš€ Evaluating Object Detection

> ë‘ Detectorë¥¼ ë‹¨ìˆœíˆ ë¹„êµí•˜ê¸°ì—ëŠ” ì¡°ê¸ˆ ì• ë§¤í•œ ì¸¡ë©´ì´ ìˆë‹¤. <br>Object Detectionì˜ í‰ê°€ ì§€í‘œì¸ mAPì— ëŒ€í•´ ì•Œì•„ë³´ì.


![14](https://user-images.githubusercontent.com/96368476/154418727-105df134-8604-47db-87fa-dd08bd7d251c.png){: .align-center}

- ì™¼ìª½ Detector : í‹€ë¦° Detecting ìˆì§€ë§Œ, <u>ëª¨ë“  ê³ ì–‘ì´ Detect</u>
- ì˜¤ë¥¸ìª½ Detector : ëª¨ë“  ê³ ì–‘ì´ë¥¼ Detectí•˜ì§€ ëª»í–ˆì§€ë§Œ, <u>í‹€ë¦° Detecting ì—†ìŒ</u>
- ì–´ë–¤ ê²ƒì´ ë” ì¢‹ì€ Detetorì¼ê¹Œ?


<br>

## Precision(ì •í™•ë„) vs Recall(ì¬í˜„ìœ¨)

$$Pricision = \frac{ì˜ˆì¸¡ ì„±ê³µí•œ ì˜ì—­ ê°¯ìˆ˜}{Detectorê°€ ì˜ˆì¸¡í•œ ì˜ì—­ ê°¯ìˆ˜}$$

$$Recall = \frac{ì˜ˆì¸¡ ì„±ê³µí•œ ì˜ì—­ ê°¯ìˆ˜}{ì‹¤ì œ Object ì˜ì—­ ê°¯ìˆ˜}$$

![15](https://user-images.githubusercontent.com/96368476/154420333-4539dcc1-2db2-477d-b2fd-1bf447ca8b9c.png){: width="50%" height="60%" .align-center}

<br>



## mAP - mean Average Pricision

![16](https://user-images.githubusercontent.com/96368476/154421095-ec8877ab-e175-4c55-81d8-976061e2d6ae.png){: .align-center}

- ìš°ì„  Prediction Scoreë¡œ boxë“¤ì„ sorting í•œë‹¤.
  - 1ë²ˆ box: ê³ ì–‘ì´ì¼ í™•ë¥  ê°€ì¥ ë†’ìŒ
  - 2ë²ˆ box: ê³ ì–‘ì´ì¼ í™•ë¥  ë‘ ë²ˆì§¸ë¡œ ë†’ìŒ 
  - ...
- Prediction box(ë¹¨ê°„ìƒ‰)ì™€ Ground-Truth box(íŒŒë€ìƒ‰)ì˜ IoUê°€ 0.5 ì´ìƒì´ë©´ ì˜ˆì¸¡ ì„±ê³µ
- IoU > 0.5 â†’ ì˜ˆì¸¡ ì„±ê³µ / IoU < 0.5 â†’ ì˜ˆì¸¡ ì‹¤íŒ¨
- ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ PR Curveë¥¼ ê·¸ë¦°ë‹¤ (Pricision-Recall Curve)

<br>

![17](https://user-images.githubusercontent.com/96368476/154421114-3a68e782-d993-4cd4-9180-7cec5c306cfa.png){: width="80%" height="90%" .align-center}
![18](https://user-images.githubusercontent.com/96368476/154421124-0d011ff5-043d-4f77-823e-2c575b3f335a.png){: width="80%" height="90%" .align-center}

- ì´ë•Œ PR-Cureveì˜ ë©´ì ì„ Average Pricision(AP)ë¼ í•œë‹¤.
- ê·¸ëŸ¼ Categoryë³„ë¡œ APë¥¼ êµ¬í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.
  - Dog AP = 0.7
  - Cat AP = 0.8
  - Car AP = 0.7
  - ...
- **mean Average Pricision (mAP) = APë“¤ì˜ í‰ê· **

<br>

mAPëŠ” ì§€ê¸ˆê¹Œì§€ Detectorì˜ í‰ê°€ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤. ì°¸ê³ ë¡œ R-CNNì˜ mAP = 53.3


<br>
<br>

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}