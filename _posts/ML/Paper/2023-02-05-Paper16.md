---
title:  "[Paper Review] Conditional Image Synthesis with Auxiliary Classifier GANs (ACGANs)" 

categories:
  -  Paper
tags:
  - [ML, Generative]

toc: true
toc_sticky: true

date: 2023-02-05
last_modified_at: 2023-02-05
---

**Main Reference: <br>- [ACGANs Paper](https://arxiv.org/abs/1610.09585)**
{: .notice--primary}

<br>


# ğŸš€ Introduction

ìµœê·¼ GANsì€ ìƒì„±ë¶„ì•¼ì—ì„œ ê´œì°®ì€ ì„±ëŠ¥ì„ ë³´ì´ë©° í° ì£¼ëª©ì„ ë°›ì•„ì™”ë‹¤. í•˜ì§€ë§Œ high resolution ì´ë¯¸ì§€ë¥¼ ë§Œì¡±ìŠ¤ëŸ½ê²Œ ìƒì„±í•´ë‚´ì§€ ëª»í–ˆê³  íŠ¹íˆ ìƒì„±í•´ì•¼ í•  classì˜ ì¢…ë¥˜ê°€ ë§ì•„ì§€ë©´ ë¬¸ì œê°€ ë” ì‹¬ê°í•´ì¡Œë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” Discriminatorì— ë³´ì¡° ë””ì½”ë”(Auxiliary Classifier)ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë¬¸ì œì— ì ‘ê·¼í–ˆë‹¤. ì´ì™¸ì—ë„ high resolutionìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê²ƒì´ ì™œ ì¤‘ìš”í•œì§€, ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ì„ ì–´ë–»ê²Œ í‰ê°€í•  ê²ƒì¸ì§€ ë“±ì˜ ë‚´ìš©ë“¤ì„ ë‹¤ë£¬ë‹¤.


<br>

# ğŸš€ AC-GANs (Auxiliary Classifier GANs)

![acgan1](https://user-images.githubusercontent.com/96368476/216902221-293e4514-2efd-440a-8c65-fb14f88eef5c.png){: width="60%" height="70%" .align-center}

$$ \textbf{L}_{S} =  \mathbb{E}\left [ logP(\text{S = real} | X_{real}) \right ] + \mathbb{E}\left [ logP(\text{S = fake} | X_{fake}) \right ] $$

$$ \textbf{L}_{C} =  \mathbb{E}\left [ logP(\text{C = c} | X_{real}) \right ] + \mathbb{E}\left [ logP(\text{C = c} | X_{fake}) \right ] $$

Auxiliary Classifier GANì€ Conditional GANê³¼ ìœ ì‚¬í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤. C-GANê³¼ì˜ ì°¨ì´ëŠ” discriminatorê°€ sampleì˜ classë„ íŒë‹¨í•˜ëŠ” ê²ƒì´ë‹¤. ì¦‰ DëŠ” $\textbf{L}_{C} + \textbf{L}_{S}$ ë¥¼ maximize í•˜ë„ë¡, GëŠ” $\textbf{L}_{C} - \textbf{L}_{S}$ ë¥¼ maximize í•˜ë„ë¡ í•™ìŠµí•œë‹¤. ì´ëŸ¬í•œ Loss fuctionì„ ê°€ì§„ ëª¨ë¸ì€ ë‹¨ìˆœíˆ ì£¼ì–´ì§„ ì´ë¯¸ì§€ê°€ realì´ëƒ fakeëƒë¥¼ êµ¬ë¶„í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, íŠ¹ì • classì— ëŒ€í•´ ì£¼ì–´ì§„ ì´ë¯¸ì§€ê°€ realì¸ì§€ fakeì¸ì§€ë¥¼ êµ¬ë¶„í•œë‹¤. ë¹„ìŠ·í•œ ì´ì•¼ê¸°ì²˜ëŸ¼ ë“¤ë¦¬ì§€ë§Œ ê²°ê³¼ì ìœ¼ë¡œ ê¸°ì¡´ ëª¨ë¸ì— ë¹„í•´ í•™ìŠµì´ ì•ˆì •ì ì´ë©° ì„±ëŠ¥ì´ ì¢‹ì•„ì§„ë‹¤. ë¬´ì—‡ë³´ë‹¤ íŠ¹ì • classì— ëŒ€í•œ í•™ìŠµì´ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì— large datasetì„ ìª¼ê°œì„œ í•™ìŠµí•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 1000ê°œì˜ classë¥¼ ê°€ì§„ imagenetì„ í•™ìŠµí•˜ê³  ì‹¶ë‹¤ë©´ ê° 10ê°œì˜ classë¥¼ ë‹´ë‹¹í•˜ëŠ” AC-GANs ëª¨ë¸ 100ê°œë¥¼ ì•™ìƒë¸”í•´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ëŸ¬í•œ ì¥ì ì€ classì˜ ê°¯ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ í¬ê²Œ ê°ì†Œí•˜ëŠ” GANê¸°ë°˜ ëª¨ë¸ì—ì„œ í° ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤.


<br>

# ğŸš€ Results

![acgan4](https://user-images.githubusercontent.com/96368476/216963112-6d62ac5c-c0eb-414e-aa25-84715c2a4b36.png){: width="60%" height="70%" .align-center}

ë‚´ ìƒê°ì— AC-GANì˜ ê°€ì¥ í° ì¥ì ì€ large datasetì„ ìª¼ê°œì„œ í•™ìŠµí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. í˜„ì‹¤ì ìœ¼ë¡œ í•™ìŠµë¹„ìš©(íŠ¹íˆ ì†ë„)ì´ ì•„ì£¼ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ê·¼ë° ì´ëŸ¬í•œ ì´ì ì„ ë¹¼ê³ ë„ ê·¸ëƒ¥ ì„±ëŠ¥ì´ ì¢‹ë‹¤ê³  í•œë‹¤. ê·¸ë¦¼ì˜ ì™¼ìª½ì€ ê¸°ì¡´ ìƒì„±ëª¨ë¸ì„ ì´ìš©í•´ imagenet ì´ë¯¸ì§€ë¥¼ ìƒì„±, ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì€ AC-GANìœ¼ë¡œ ìƒì„±í•œ ì´ë¯¸ì§€ì´ë‹¤.

<br>

## Generating high resolution images improves discriminability

| Inception accuracy | accuracy by resolution |
|:-:|:-:|
| ![acgan2](https://user-images.githubusercontent.com/96368476/216911528-c0ee9f6e-f331-4dd8-aebc-123133797b93.png) | ![acgan3](https://user-images.githubusercontent.com/96368476/216911539-c752c284-5ad1-4391-97e1-e6d282c94452.png) |

ë§Œì•½ 128x128 í¬ê¸°ì˜ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•œë‹¤ê³  í•´ë³´ì. ì²˜ìŒë¶€í„° 128x128ë¡œ directly generateí•˜ëŠ” ë°©ë²•ê³¼ 258x258ë¡œ ìƒì„±í•œ ë’¤ resizeë¡œ ì¤„ì´ëŠ” ë°©ë²•ì— ì„±ëŠ¥ì°¨ì´ê°€ ìˆì„ê¹Œ? ì €ìë“¤ì€ í›„ìì˜ ë°©ì‹ì´ ë” ë›°ì–´ë‚¨ì„ ë³´ì—¬ì£¼ë©° high resolution ì´ë¯¸ì§€ ìƒì„±ì˜ ì¤‘ìš”ì„±ì„ ë§í•œë‹¤. ë¨¼ì € ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ í‰ê°€í•˜ëŠ” ê¸°ì¤€ì„ inception accuracyë¡œ ì œì‹œí•˜ì˜€ë‹¤. Inception accuracyë€ ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ classification ëª¨ë¸ì¸ inceptionì— ì§‘ì–´ ë„£ì—ˆì„ ë•Œ outputìœ¼ë¡œ ë‚˜ì˜¨ ì •í™•ë„ì´ë‹¤. ì™¼ìª½ ê·¸ë¦¼ì²˜ëŸ¼ inception ëª¨ë¸ì´ ëª…í™•í•˜ê²Œ êµ¬ë¶„í• ìˆ˜ë¡(discriminabilityê°€ ë†’ì„ìˆ˜ë¡) ìƒì„±ëœ ì´ë¯¸ì§€ì˜ í’ˆì§ˆì´ ì¢‹ë‹¤ëŠ” ëœ»ì´ë‹¤. ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì˜ ë¹¨ê°„ ì„ ì€ 128x128ë¡œ ìƒì„±í•œ ì´ë¯¸ì§€ë¥¼ resizeí•˜ë©° êµ¬í•œ inception accuracy, íŒŒë€ ì„ ì€ 64x64ë¡œ ìƒì„±í•˜ì—¬ resizeí•œ ê²°ê³¼ì´ë‹¤. ì´ì™€ ê°™ì€ ê²°ê³¼ëŠ” ì´ë¯¸ì§€ë¿ ì•„ë‹ˆë¼ ì˜¤ë””ì˜¤ ë“± ë‹¤ë¥¸ ìƒì„±ë¶„ì•¼ì—ì„œë„ ë™ì¼í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤.


<br>


## Measuring the Diversity of Generated Images

ì•ì„œ ì‚¬ìš©í•œ inception accuracyëŠ” ìƒì„±ëœ ì´ë¯¸ì§€ ê°ê°ì˜ í’ˆì§ˆì„ í‰ê°€í•  ìˆ˜ ìˆì§€ë§Œ ì´ë¯¸ì§€ë“¤ì˜ ë¶„í¬ë¥¼ í‰ê°€í•˜ì§€ ëª»í•œë‹¤. ì¦‰ íŠ¹ì • classì— ëŒ€í•´ ëª¨ë¸ì´ mode collapsed ë˜ì–´ ë¹„ìŠ·í•œ ì´ë¯¸ì§€ë“¤ë§Œ ìƒì„±í•˜ëŠ”ì§€, train datasetë§Œí¼ ë‹¤ì–‘í•œ ì´ë¯¸ì§€ë“¤ì„ ìƒì„±í•˜ëŠ”ì§€ ì•Œì§€ ëª»í•œë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” MS-SSIMì„ ì´ìš©í•˜ì—¬ ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ì˜ ë‹¤ì–‘ì„±ì„ ì •ëŸ‰ì ìœ¼ë¡œ ë¶„ì„í•œë‹¤. MS-SSIM(Multi-scale structural smilarity)ëŠ” ë‘ ì´ë¯¸ì§€ê°€ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ë¥¼ human perceptualí•˜ê²Œ í‰ê°€í•œ ì§€í‘œì´ë‹¤. 

![acgan4](https://user-images.githubusercontent.com/96368476/216916975-2d0e66f2-759b-4990-ac25-05c199ff7253.png){: width="60%" height="70%" .align-center}

ì €ìë“¤ì€ ê° classì— ëŒ€í•´ ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ ì¤‘ ëœë¤í•˜ê²Œ 100ìŒì„ ë½‘ì•„ MS-SSIM í‰ê·  ê°’ì„ êµ¬í–ˆë‹¤. ì´ë ‡ê²Œ êµ¬í•œ mean MS-SSIM score ì ìˆ˜ê°€ ë†’ë‹¤ë©´ ìƒì„±ëœ ì´ë¯¸ì§€ë“¤ì´ ì„œë¡œ ë¹„ìŠ·í•˜ë‹¤ëŠ” ì˜ë¯¸ì´ê³ , ë”°ë¼ì„œ sampleë“¤ì˜ diversityê°€ ì‘ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ë°˜ëŒ€ë¡œ MS-SSIM scoreê°€ ë‚®ë‹¤ë©´ sampleë“¤ì˜ ë‹¤ì–‘ì„±ì´ ë†’ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.


| MS-SSIM during training | generated data vs source data |
|:-:|:-:|
| ![acgan6](https://user-images.githubusercontent.com/96368476/216917038-300d73a0-781c-4260-b4c6-f9d3606fdeb3.png) | ![acgan5](https://user-images.githubusercontent.com/96368476/216917031-dfd8b098-b7ee-4fb9-bc51-6920c26937de.png) |

- Training ë™ì•ˆ mean MS-SSIM score ì¶”ì 
  - black line : ì„±ê³µì ì¸ classì— ëŒ€í•´ì„œëŠ” í•™ìŠµí• ìˆ˜ë¡ MS-SSIM ê°ì†Œ (ë‹¤ì–‘í•´ì§)
  - red line : Collapsed classëŠ” í•™ìŠµì´ ì§„í–‰ë ìˆ˜ë¡ MS-SSIM ì¦ê°€
- Generated data vs Source data (mean MS-SSIM score ë¹„êµ)
  - source dataì˜ ê²½ìš° ê°€ì¥ ë†’ì€ mean MS-SSIM scoreëŠ” 0.25
  - generated dataë„ ì „ì²´ classì˜ 85%ê°€ 0.25 ì´í•˜ì˜ mean MS-SSIM scoreë¥¼ ê°€ì§
  - ì¦‰ generated dataë„ source data ëª»ì§€ì•Šì€ ë‹¤ì–‘ì„±ì„ ì§€ë‹Œë‹¤.

ë‹¤ë§Œ sampleì˜ ë‹¤ì–‘ì„±ì„ í‰ê°€í•  ë•Œ MS-SSIM metricì´ ìµœì„ ì¸ê°€ì— ëŒ€í•œ ì˜ë¬¸ì€ ë‚¨ì•„ìˆë‹¤. MS-SSIMì€ pixel space ìœ„ì—ì„œì˜ ì—”íŠ¸ë¡œí”¼ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì‚¬ëŒì´ ì´ë¯¸ì§€ë¥¼ ì–´ë–»ê²Œ ì¸ì‹í•˜ëŠ”ì§€ human perceptualì— ëŒ€í•œ ì§€í‘œì´ê¸° ë•Œë¬¸ì´ë‹¤.


<br>


## Searching for signatures of overfitting

ìƒì„±ëª¨ë¸ì„ ë‹¤ë£° ë•Œ í•­ìƒ ì²´í¬í•´ë´ì•¼ í•  ë¬¸ì œì ì€ generatorê°€ source dataë¥¼ copyí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ overfitting ë˜ì—ˆëŠ”ê°€ í•˜ëŠ” ê²ƒì´ë‹¤. ì´ëŠ” DC-GANsì— ë‚˜ì˜¨ ë°©ë²•ì²˜ëŸ¼ latent spaceë¥¼ ê±¸ì–´ë³´ë©´(waking) ì•Œ ìˆ˜ ìˆë‹¤. ë§Œì•½ generatorê°€ overfitting ë˜ì–´ ìˆë‹¤ë©´ latent space ìœ„ì—ì„œì˜ ì‘ì€ ì›€ì§ì„ì´ ìƒì„±ë˜ëŠ” ì´ë¯¸ì§€ì—ì„œ í° ë³€í™”ë¥¼ ì¼ìœ¼í‚¬ ê²ƒì´ë‹¤.

![acgan8](https://user-images.githubusercontent.com/96368476/216952315-3e6a01f9-e48a-4317-845e-f1721c7ec36b.png){: width="60%" height="70%" .align-center}

- Top : latent space ìœ„ì—ì„œ ë¶€ë“œëŸ½ê²Œ ì›€ì§ì´ë©´ ìƒì„±ë˜ëŠ” ì´ë¯¸ì§€ë„ ë¶€ë“œëŸ½ê²Œ ë³€í™”í•œë‹¤.
- Bottom : noise ë¶€ë¶„ì€ ê·¸ëŒ€ë¡œ ë‘” ì²´ concatí•˜ëŠ” class ì •ë³´ë§Œ ë³€ê²½í•˜ë‹ˆ ì´ë¯¸ì§€ì˜ textureë§Œ ë³€í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.


<br>


## Measuring the effect of class splits on image sample quality

![acgan9](https://user-images.githubusercontent.com/96368476/216952374-eaabf4d9-2b2e-468c-8532-148fafb63250.png){: width="60%" height="70%" .align-center}

ì•ì„œ ì–¸ê¸‰í–ˆë“¯ì´ AC-GANì˜ generatorëŠ” íŠ¹ì • classì— ëŒ€í•œ ì´ë¯¸ì§€ ìƒì„±ì„ í•™ìŠµí•˜ë¯€ë¡œ large datasetì„ ìª¼ê°œì„œ í•™ìŠµí•  ìˆ˜ ìˆë‹¤(ìª¼ê°œì„œ í•™ìŠµí•˜ê³  ì•™ìƒë¸”í•˜ë©´ ê·¸ë§Œ). ì´ëŠ” Training cost ê´€ì ì—ì„œ êµ‰ì¥íˆ í° ì´ë“ì´ë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ ìª¼ê°œì„œ í•™ìŠµí•  ì‹œ ìƒì„±ë˜ëŠ” imageì˜ qualityë„ ì¢‹ì•„ì§„ë‹¤ëŠ” ê²ƒì´ ë³¸ íŒŒíŠ¸ì˜ ë‚´ìš©ì´ë‹¤. ìœ„ í‘œì™€ ê°™ì´ 10ê°œì˜ classë“¤ë¡œ ìª¼ê°œì„œ í•™ìŠµí•´ì•¼ ë¹„ë¡œì†Œ source dataì™€ ë¹„ìŠ·í•œ mean MS-SSIM scoreë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë§ˆëƒ¥ ìª¼ê° ë‹¤ê³  ì¢‹ì•„ì§€ëŠ” ê²ƒì€ ì•„ë‹ˆë¼ê³  í•œë‹¤. Num of classesë¥¼ 1ë¡œ ì¤„ì˜€ë”ë‹ˆ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ í¬ê²Œ ë–¨ì–´ì¡Œë‹¤ê³  í•œë‹¤. ì£¼ì–´ì§„ Datasetì— ëŒ€í•œ ìµœì ì˜ ë¶„í• ì€ ì¢€ ë” ì—°êµ¬ë˜ì–´ì•¼ í•œë‹¤ê³  í•œë‹¤.


<br>



# ğŸš€ Code

> ì¶”ê°€ ì˜ˆì •


<br>
<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}