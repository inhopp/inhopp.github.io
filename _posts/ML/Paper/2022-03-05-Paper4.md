---
title:  "[논문 리뷰] Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition (SPP-net)" 

categories:
  -  Paper
tags:
  - [ML, Paper]

toc: true
toc_sticky: true

date: 2022-03-05
last_modified_at: 2022-03-05
---

**Paper: <br>- [Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition](https://github.com/inhopp/inhopp/files/8190734/SPP.Net.pdf)**
{: .notice--primary}


<br>

# 🚀 Introduction

Object Detection 모델들은 대개 CNN을 기반으로 만들어졌다. 관련된 논문을 읽다보면 단순한 CNN 구조가 아닌 **'Feature Pyramid Network'** 구조를 사용했다는 말이 등장하는데, 이는 단순 CNN이 위치에 불변하기 때문이다(Location Invariant). 아래 그림을 살펴보자.

![1](https://user-images.githubusercontent.com/96368476/156887676-a19dc538-8488-460a-9516-7c9180227a2c.png){: .align-center}

분류를 위한 단순 CNN 구조를 생각해보자. 우선 Convolution과 Pooling을 이용해 input image의 특징을 뽑아낸다. 그 후 마지막 convolution 결과를 쭉 펴서(Flatten) Fully Connected Layer에 집어 넣는다. FC layer는 뽑아낸 feature 값들을 바탕으로 이미지가 어떤 object인지 판단한다. 여기서 중요한 점은 분류기(FC layer)에 들어가는 input(마지막 convolution 결과값)이 위치에 불변하다는 것이다. 즉, object가 왼쪽 위 모서리에 존재하던 오른쪽 아래 모서리에 존재하던 마지막 convoltion 결과는 같은 feature값을 뽑을 것이다.


![5](https://user-images.githubusercontent.com/96368476/154627009-cf83638e-48b1-423f-94c7-e32ece00371d.png){: width="50%" height="60%" .align-center}

이 같은 현상이 나타나는 이유는 Pooling 때문인데, convolution layer가 깊어질 수록 더 넓은 영역을 커버하기 때문이다. 예를 들어 마지막 convolution layer에 눈을 탐지하는 필터가 있다고 해보자. 이 필터는 input 이미지의 굉장히 넓은 영역에서 눈이 있을 확률을 계산할 것이다.<br>

![4](https://user-images.githubusercontent.com/96368476/155002334-51faba53-560e-4bd4-9c3c-52621c5949af.png){: width="60%" height="70%" .align-center}

따라서 object의 특징뿐만이 아닌 위치도 중요한 경우 pooling 중간중간의 feature map 들을 활용할 수 있다. 이렇듯 피라미드 모양으로 feature map 들을 쌓은 후 분류기(FC layer)에 넣어주는 방법을 Feature Pyramid Network라 한다. <br>

본 논문 SPP-net (Spatial Pyramid pooling - Network)은 이러한 아이디어를 처음으로 CNN에 적용시킨 모델이다. 앞서 살펴본 바와 같이 SPP-net은 하나의 모델로 바라보기 보다는 다른 모델에 장착 가능한 최적화 도구라고 보는 것이 합리적이다. 따라서 이번 포스팅에서는 SPP-net의 구체적인 구조나 퍼포먼스는 과감하게 제외했다. 대신 모델이 등장하게 된 배경 (Motivation)과 이전의 어떤 모델에서 영감을 받았는지 등 아이디어를 위주로 살펴보자.



<br>

# 🚀 Motivation - CNN의 한계












<br>
<br>

[맨 위로 이동하기](#){: .btn .btn--primary }{: .align-right}