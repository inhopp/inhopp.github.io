---
title:  "[Paper Review] Image-to-Image Translation with Conditional Adversarial Networks (Pix2Pix)" 

categories:
  -  Paper
tags:
  - [ML, Generative]

toc: true
toc_sticky: true

date: 2023-05-29
last_modified_at: 2023-05-29
---

**Main Reference: <br>- [Pix2Pix Paper](https://arxiv.org/abs/1611.07004)**
{: .notice--primary}

<br>


# ğŸš€ Introduction

![1](https://github.com/inhopp/inhopp/assets/96368476/6dc173ec-a624-4b39-a066-4415037967a1){:.align-center}

ë§ì€ ì´ë¯¸ì§€ ì²˜ë¦¬, ê·¸ë˜í”½, ë¹„ì „ ì‘ì—…ë“¤ì€ image-to-image translation ë¬¸ì œë¡œ í•´ì„í•  ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ ë‹¤ì–‘í•œ ì‘ì—…ë“¤ì€ pixel to pixelì´ë¼ëŠ” ê³µí†µì ì´ ìˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  íŠ¹ì • ì‘ì—…ì— ë”°ë¼ ë³„ê°œë¡œ ë¶„ë¥˜ë˜ì–´ ë‹¤ë£¨ì–´ì¡Œë‹¤. ë‹¤ì‹œ ë§í•´ ì´ë“¤ì€ 'CNN êµ¬ì¡°'ë¼ëŠ” ê³µí†µëœ ë°©í–¥ì„±ì´ ìˆì—ˆì§€ë§Œ ë¬´ì—‡ì„ minimizeí•´ì•¼í•˜ëƒëŠ” ê²ƒì— ëŒ€í•œ ì˜ë¬¸ì´ ë‚¨ì•„ìˆì—ˆë‹¤. ì¼ë°˜ì ì¸ Euclidean distanceë¥¼ ì´ìš©í•œ lossëŠ” blurryí•œ ê²°ê³¼ë¥¼ ë‚³ê¸° ë•Œë¬¸ì— ì›í•˜ëŠ” taskì— ë§ëŠ” ì ì ˆí•œ loss functionì„ ì •ì˜í•´ì•¼ í•œë‹¤. ë¬¸ì œëŠ” ì´ ì‘ì—…ì´ ê½¤ë‚˜ ì „ë¬¸ì ì¸ ì§€ì‹ì„ ìš”êµ¬í•œë‹¤ëŠ” ê²ƒì´ë‹¤. <br>ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ ë¬¸ì œì˜ì‹ì„ ë°”íƒ•ìœ¼ë¡œ CGAN êµ¬ì¡°ë¥¼ í†µí•´ image-to-image ë¬¸ì œë¥¼ í•´ê²°í–ˆë‹¤. GANì˜ ê²½ìš° taskì— ê´€ê³„ ì—†ì´ lossë¥¼ ì •ì˜í•˜ê¸° ë§¤ìš° ì‰½ë‹¤ëŠ” ì¥ì ì´ ìˆê³ , Conditional ì¡°ê±´ì„ ê±¸ì–´ì£¼ë©´ image-to-image taskë¥¼ í•™ìŠµí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.



<br>


# ğŸš€ Method

![2](https://github.com/inhopp/inhopp/assets/96368476/f852bcb3-c991-4962-b2b8-242f0547cc6e){: width="40%" height="50%" .align-center}

ê¸°ì¡´ì˜ CGAN ëª¨ë¸ì€ ì´ë¯¸ì§€ xì™€ nosize vector zë¡œë¶€í„° ì´ë¯¸ì§€ë¥¼ í•©ì„±í•œë‹¤. ë§Œì•½ noise zê°€ ì—†ë‹¤ë©´ ì´ë¯¸ì§€ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ í•™ìŠµí•˜ì§€ ëª»í•˜ê³ , xì—ì„œ yë¡œ deterministicí•œ outputì´ ìƒì„±ë  ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì‹¤í—˜ ê²°ê³¼ generatorê°€ noiseë¥¼ ë¬´ì‹œí•˜ë„ë¡ ë¹ ë¥´ê²Œ í•™ìŠµí•œë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤. ë”°ë¼ì„œ noise vector zë¥¼ ì´ìš©í•˜ëŠ” ë°©ì‹ì´ ì•„ë‹Œ generatorì—ì„œ dropoutì„ ì ìš©í•˜ëŠ” ë°©ì‹ì„ ì±„íƒí–ˆëŠ”ë° ì—¬ì „íˆ stochasticí•œ ë³€í™”ëŠ” ë¯¸ë¯¸í–ˆë‹¤ê³  í•œë‹¤. í˜„ì¬(2018)ë¡œì„œ ìƒì„± ëª¨ë¸ì´ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ì˜ í•™ìŠµí•˜ëŠ” ë°©ë²•ì€ open questionì´ë‹¤.

<br>

## Loss Function

$$ \textbf{L}_{cGAN} =  \mathbb{E}_{y}[logD(y)] + \mathbb{E}_{x}[ log(1 - D(G(x)))] $$

$$ \textbf{L}_{L_{1}} =  \mathbb{E}_{x,y}[\begin{Vmatrix} y - G(x)
\end{Vmatrix}_{1}] $$

$$ \textbf{L}_{pix2pix} = \text{arg}\min_{G}\max_{D} \textbf{L}_{cGAN} + \lambda \textbf{L}_{L_{1}}(G) $$

- Generatorê°€ Discriminatorë¥¼ í†µê³¼í•˜ë„ë¡(GAN loss) + ground truthì™€ ë¹„ìŠ·í•´ì§€ë„ë¡ (L1 loss)


<br>


# ğŸš€ Architecture

## Generator with Skips

![3](https://github.com/inhopp/inhopp/assets/96368476/aa00e126-750a-4b80-b9ed-9a75831ed3f7){: width="40%" height="50%" .align-center}

Image-to-Image translation ì‘ì—…ì€ ê¸°ë³¸ì ìœ¼ë¡œ high resolution inputì—ì„œ high resolution outputìœ¼ë¡œ ê°€ëŠ” ë§¤í•‘ì´ë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ ì…ë ¥ê³¼ ì¶œë ¥ì´ ë§ì€ low-level featureë¥¼ ê³µìœ í•˜ëŠ” ë¹„ìŠ·í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤(ex. edge â†’ photo). ê¸°ì¡´ì˜ GeneratorëŠ” encoder-decoder êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì§€ë§Œ, encoderì˜ downsampling ê³¼ì •ì—ì„œ ì •ë³´ê°€ ì†ì‹¤ë˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´(ìš°íšŒí•˜ê¸° ìœ„í•´) skip connectionì„ ì¶”ê°€í•œ UNet êµ¬ì¡°ë¥¼ íƒœì±…í–ˆë‹¤.

<br>

## Discriminator - PatchGAN

![4](https://github.com/inhopp/inhopp/assets/96368476/2316df6b-6bee-400b-b064-7a247ae8ffa3){: width="40%" height="50%" .align-center}

ìƒì„± ëª¨ë¸ì—ì„œ ì¼ë°˜ì ì¸ L1, L2 lossëŠ” blurí•œ ê²°ê³¼ë¥¼ ë‚³ëŠ”ë‹¤ëŠ” ê²ƒì€ ì˜ ì•Œë ¤ì ¸ ìˆë‹¤. í•´ë‹¹ lossë“¤ì´ ë¹„ë¡ high frequency íŠ¹ì§•ë“¤ì„ ì˜ ì¡ì•„ë‚´ì§€ëŠ” ëª»í•˜ì§€ë§Œ, Localí•œ ë¶€ë¶„ì˜ low frequencyëŠ” ì˜ ì¡ì•„ë‚¸ë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œ Discriminatorì— ë„ì…í•œ PatchGANì€ ì´ëŸ¬í•œ íŠ¹ì§•ì„ ì´ìš©í•´ NxN íŒ¨ì¹˜ë³„ë¡œ real/fakeë¥¼ íŒë³„í•˜ê³ , ì´ë“¤ì„ í‰ê· ë‚´ì–´ ìµœì¢… outputì„ ê³„ì‚°í•œë‹¤. Section4ì—ì„œ ì‹¤í—˜ì„ í†µí•´ Nì´ ì‘ì•„ë„ ì¶©ë¶„íˆ ê³ í€„ë¦¬í‹°ì˜ ì´ë¯¸ì§€ë¥¼ í•©ì„±í•  ìˆ˜ ìˆìŒì„ ë³´ì˜€ë‹¤.


<br>



# ğŸš€ Experiments

ë‹¤ì–‘í•œ Image-to-Image taskë¥¼ í•  ìˆ˜ ìˆëŠ”ì§€ ì²´í¬í•˜ê¸° ìœ„í•´, ì—¬ëŸ¬ taskì™€ datasetìœ¼ë¡œ ëª¨ë¸ì˜ generalityë¥¼ ì²´í¬í•˜ì˜€ë‹¤. ì•½ê°„ íŠ¹ì´í–ˆë˜ ì ì€ ì¢…ì¢… ì ì€ ë°ì´í„° ì–‘ìœ¼ë¡œë„ ê´œì°®ì€ ê²°ê³¼ê°€ ë‚˜ì™”ë‹¤ëŠ” ê²ƒì´ë‹¤. <br>í•œ ê°€ì§€ ë¬¸ì œì ì€, ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ í‰ê°€í•˜ëŠ” ê²ƒì´ ì‰½ì§€ ì•Šë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ëŠ” GANê¸°ë°˜ ëª¨ë¸ë“¤ì˜ ê³µí†µì ì¸ ë¬¸ì œì¸ë°, ì €ìë“¤ì€ ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ë‘ ê°€ì§€ ì „ëµì„ ì‚¬ìš©í–ˆë‹¤.
- Amazon Mechanical Turk (AMT)
  - ìƒ‰ì¹ ê³¼ ê°™ì€ graphicì‘ì—…ì—ì„œëŠ” ì‚¬ëŒì´ ì§ì ‘ ì •ì„±ì ìœ¼ë¡œ í‰ê°€
- FCN Score
  - Inception scoreì™€ ìœ ì‚¬í•˜ê²Œ, ìƒì„±ëœ ì´ë¯¸ì§€ì˜ objectê°€ ì–¼ë§ˆë‚˜ ì˜ recognize ë˜ëŠ”ì§€ í‰ê°€


<br>

| Results | FCN score |
|:-:|:-:|
| ![5](https://github.com/inhopp/inhopp/assets/96368476/945f5fce-8e73-433b-bf5c-61d9f1c380b2) | ![6](https://github.com/inhopp/inhopp/assets/96368476/7482ce6d-4a0a-4b33-8a17-9dfee26ee108) |

- L1 lossë§Œì„ ì´ìš©í•œ blur í˜„ìƒì´ ì‹¬í•¨
- CGAN lossë§Œ ì‚¬ìš©í•˜ë©´ ì„ ëª…í•´ì§€ê¸´ í•˜ì§€ë§Œ visual artifactsê°€ ìƒê¹€

<br>

| Results | FCN score |
|:-:|:-:|
| ![5](https://github.com/inhopp/inhopp/assets/96368476/778929bb-5cc0-459a-bb8c-bf4383222f7c) | ![6](https://github.com/inhopp/inhopp/assets/96368476/e62e694b-4113-4106-afab-98c814ebcc7f) |

- ê¸°ì¡´ Encoder-Decoder êµ¬ì¡°ë³´ë‹¤ U-Netêµ¬ì¡°ê°€ í™•ì‹¤íˆ ì¢‹ë‹¤!

<br>

| Results | FCN score |
|:-:|:-:|
| ![6](https://github.com/inhopp/inhopp/assets/96368476/893c91e4-df53-4671-9f7a-2edf0bfc2aca) | ![5](https://github.com/inhopp/inhopp/assets/96368476/9d29db51-4b3b-4e7e-b5da-3e1f16ff81a0) |

- Discriminiatorì˜ Patch sizeë¥¼ ë°”ê¿”ê°€ë©° í•œ ì‹¤í—˜
- Full size patchë³´ë‹¤ 70x70ì´ ê°€ìƒ ì„±ëŠ¥ì´ ì¢‹ì•˜ìŒ
- (ì´ê±° ì‚¬ëŒì´ ì–´ë–»ê²Œ ì°¾ë‚˜..?)



# ğŸš€ Disccusion

Pix2Pix ë…¼ë¬¸ì„ ì½ìœ¼ë©° ê°€ì¥ ì¸ìƒì ì´ì—ˆë˜ ë¶€ë¶„ì€ GAN-Lossì˜ ì¥ì ì„ ëª…í™•í•˜ê²Œ ì•Œì•˜ë‹¤ëŠ” ê²ƒì´ë‹¤. Taskì™€ ê´€ê³„ì—†ì´ Discriminatorë¥¼ ì†ì´ê¸°ë§Œ í•˜ë©´ ë˜ë‹ˆ Loss function ì •ì˜í•˜ê¸°ê°€ ì´ë³´ë‹¤ ì‰¬ìš¸ ìˆ˜ ìˆì„ê¹Œ? ì •ë§ ë§¤ë ¥ì ì¸ ëª¨ë¸ì¸ ê²ƒ ê°™ë‹¤.



<br>



# ğŸš€ Code

> [Pix2Pix from scartch (pytorch)](https://github.com/inhopp/pix2pix)

| Input | Output |
|:-:|:-:|
| ![7](https://github.com/inhopp/inhopp/assets/96368476/e91d3f38-5d76-43c7-9041-52b65d31670f) | ![8](https://github.com/inhopp/inhopp/assets/96368476/8cd3580c-a9d4-49f8-8bad-574ed07d01d2) |

<br>
<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}