---
title:  "[ë…¼ë¬¸ ë¦¬ë·°] Image Style Transfer Using Convolutional Neural Networks" 

categories:
  -  Paper
tags:
  - [ML, Paper]

toc: true
toc_sticky: true

date: 2022-02-09
last_modified_at: 2022-02-09
---

**Main Reference: <br>- [Deep Learning for Computer Vision](https://www.youtube.com/watch?v=dJYGatp4SvA&list=PL5-TkQAfAZFbzxjBHtzdVCWE0Zbhomg7r) <br>- [ê¼¼ê¼¼í•œ ë”¥ëŸ¬ë‹ ë…¼ë¬¸ ë¦¬ë·°ì™€ ì½”ë“œ ì‹¤ìŠµ](https://github.com/ndb796/Deep-Learning-Paper-Review-and-Practice)** 
{: .notice--warning}


**[Image Style Transfer Using Convolutional Neural Networks](https://github.com/inhopp/inhopp/files/8025046/Image.Style.Transfer.paper.pdf)**
{: .notice--primary}



<br>

# ğŸš€ Introduction

![3](https://user-images.githubusercontent.com/96368476/153019796-222dba35-08f7-4d7d-8fea-2d1d1dafa7b6.jpg)

Image Style Transferë€ Content ì´ë¯¸ì§€ í˜•ìƒ ìœ„ì— style ì´ë¯¸ì§€ì˜ styleì„ ì…íˆëŠ” ê²ƒì´ë‹¤. ê·¸ë¦¼ê³¼ ê°™ì´ í’ê²½ ì‚¬ì§„ ìœ„ì— ìœ ëª… í™”ê°€ë“¤ì˜ í™”í’ì„ ì ìš©í•˜ëŠ” ê²ƒì´ë‹¤. ë…¼ë¬¸ì— ë‚˜ì˜¨ ë°©ì‹ì€ noise imageì—ì„œ ì‹œì‘í•´ contentì™€ styleì„ reconstruction í•œë‹¤. ì¦‰, cnnì˜ ê°€ì¤‘ì¹˜ë“¤ì€ ê³ ì •ì‹œí‚¤ê³  noise ì´ë¯¸ì§€ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤. ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ cnn ëª¨ë¸ì€ pre-trained VGG19 ì´ë‹¤.

<br>

![4](https://user-images.githubusercontent.com/96368476/153026588-622ca670-cb34-4f18-832e-e6dd5588da3f.jpg)
{: width="60%" height="70%"}

ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
- ì´ë¯¸ì§€ì˜ styleì„ ì–´ë–»ê²Œ ì •ì˜í•  ê²ƒì¸ê°€?
- contentì™€ styleì„ ì–´ë–»ê²Œ reconstruction í•  ê²ƒì¸ê°€?




<br>


# ğŸš€ Content Reconstruction

content ì´ë¯¸ì§€ë¥¼ reconstructioní•˜ê¸° ìœ„í•´ content loss í•¨ìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì´ í•¨ìˆ˜ëŠ” Lë²ˆì§¸ convolution layerì— ì¡´ì¬í•˜ëŠ” ië²ˆì§¸ í•„í„°ì— ëŒ€ì‘í•˜ëŠ” F matrixë¡œ í‘œí˜„ëœë‹¤.

![paper1-17](https://user-images.githubusercontent.com/96368476/153029638-cebd1487-704f-412d-bf0d-a992ec5b7b38.jpg)
{: width="60%" height="70%"}
![6](https://user-images.githubusercontent.com/96368476/153029592-98300888-3823-4afd-9444-8f1bb124057c.jpg)
{: width="60%" height="70%"}

- F: noise image xë¥¼ ë„£ì—ˆì„ ë•Œ
- P: content image pë¥¼ ë„£ì—ˆì„ ë•Œ (ìƒìˆ˜)

<br>

ì—¬ê¸°ì„œ íŠ¹ì´í•œ ì ì€ ëª¨ë“  í•„í„°ë¥¼ ì‚¬ìš©í•´ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šê³  4ë²ˆì§¸ layer 1ë²ˆ ì§¸ í•„í„°ë§Œì„ ì´ìš©í•´ reconstruction í•œë‹¤. ì‹¤ì œ ì½”ë“œë¥¼ ëŒë ¤ë³´ë©´ ì—…ë°ì´íŠ¸ ì†ë„ê°€ êµ‰ì¥íˆ ëŠë ¤ì„œ í•„í„°ì˜ ê°œìˆ˜ë¥¼ ì œí•œí•˜ëŠ” ê²ƒì€ ì´í•´ê°€ ê°„ë‹¤. ê·¸ëŸ°ë° ì™œ í•˜í•„ conv4_1 í•„í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì¼ê¹Œ?

<br>

![7](https://user-images.githubusercontent.com/96368476/153031734-4147c747-7327-4c8c-bbe0-5ba147d2d7f2.jpg)

Content Reconstructionsë¶€ë¶„ì„ ì‚´í´ë³´ì. aëŠ” ì²«ë²ˆ ì§¸ ë ˆì´ì–´ì— ì¡´ì¬í•˜ëŠ” í•„í„°ë¥¼ ì´ìš©í•´ reconstruction í•œ ê·¸ë¦¼ì´ê³  ê·¸ ì¤‘ íŠ¹ì • ë¶€ë¶„ì„ í™•ëŒ€í•œ ê·¸ë¦¼ì´ ì•„ë˜ì˜ ê²ƒì´ë‹¤. ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ì¦‰, ê¹Šì€ layerì˜ í•„í„°ë¥¼ ì‚¬ìš©í•œ ê²ƒì¼ìˆ˜ë¡ í•´ìƒë„ëŠ” ë–¨ì–´ì§„ë‹¤. ì´ëŠ” ê¹Šì€ layerì˜ í•„í„°ì¼ìˆ˜ë¡ ë” ë„“ì€ ì˜ì—­ì„ ì»¤ë²„í•˜ê³ , ê³ ì°¨ì›ì˜ íŠ¹ì§•ì„ í‘œí˜„í•˜ê¸° ë•Œë¬¸ì´ë‹¤. 

<br>

![8](https://user-images.githubusercontent.com/96368476/153033127-d0c8ecb9-9b7c-4f4b-a934-1312b145aaca.jpg)
{: width="60%" height="70%"}

ìœ„ ê·¸ë¦¼ì€ Content Imageë¥¼ ê°ê° Conv2_2 í•„í„°, Conv4_2 í•„í„°ë¥¼ ì´ìš©í•´ reconstructioní•œ ê²ƒì´ë‹¤. Conv2_2 í•„í„°ë¥¼ ì´ìš©í•œ ê²½ìš°, í™•ëŒ€í•œ ì‚¬ì§„ì„ ë³´ë©´ content imageì˜ ì €ì°¨ì› íŠ¹ì§•ì´ ë„ˆë¬´ ì„ ëª…í•´ì„œ ë‹¨ìˆœíˆ ìƒ‰ê¹”ë§Œ ì…í˜€ë†“ì€ ë“¯ í•˜ë‹¤. ë°˜ë©´ Conv4_2 í•„í„°ë¥¼ ì´ìš©í•˜ë‹ˆ í•´ìƒë„ê°€ ë–¨ì–´ì§€ì§€ë§Œ, ì˜¤íˆë ¤ ë” ìì—°ìŠ¤ëŸ½ê²Œ ìŠ¤íƒ€ì¼ì´ í‘œí˜„ëœ ë“¯í•˜ë‹¤.





<br>


# ğŸš€ Style Reconstruction

ë³¸ ë…¼ë¬¸ì—ì„œëŠ” 'Style'ì„ Gram matrix Gë¼ëŠ” í–‰ë ¬ì„ ì´ìš©í•´ ì •ì˜í•œë‹¤. Gram matrixê°€ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³´ì.

- í•„í„°ì˜ ê°œìˆ˜: N+1 (0,1,...,N)
- M: feature mapì˜ ê°€ë¡œ*ì„¸ë¡œ

![paper1-18](https://user-images.githubusercontent.com/96368476/153035219-aef94db0-bc40-43ed-9624-570963077e4c.jpg)
![paper1-19](https://user-images.githubusercontent.com/96368476/153035224-e5afb876-8731-44e7-91aa-966adfb4dd1a.jpg)
![paper1-20](https://user-images.githubusercontent.com/96368476/153035225-0cfefc24-0e69-4322-9927-d51703fefdd0.jpg)
![paper1-21](https://user-images.githubusercontent.com/96368476/153035227-c51387b1-7eec-4e53-88c2-4bff56ba0298.jpg)
![paper1-22](https://user-images.githubusercontent.com/96368476/153035232-07ceb49e-81b1-4222-b446-314fe6e21a2c.jpg)

- ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ìŠ¤íƒ€ì¼ì´ë€?
- **<span style="color:red">Correlations between the different filter responses</span>**


![9](https://user-images.githubusercontent.com/96368476/153037303-e85c8fdc-c359-454c-8fb6-803bfb7ff48f.jpg)
{: width="50%" height="60%"}

- Gram matrixëŠ” í¬ê¸°ê°€ í¬ê¸° ë•Œë¬¸ì— 4MNìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ì •ê·œí™” í…€ì„ ê±°ì¹˜ëŠ” ë“¯ í•˜ë‹¤.
- AëŠ” style imageì˜ Gram matrix (ìƒìˆ˜)
- content reconstructionê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ëª¨ë“  layerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  conv1, conv2, conv3, conv4, conv5 ë‹¤ì„¯ ê°œì˜ layerë§Œ ì‚¬ìš©í•œë‹¤.
  - ì„±ëŠ¥ ì´ìŠˆ ë•Œë¬¸ì¸ ë“¯
- ì´ë•Œ wëŠ” 1/5ë¡œ ì§€ì •í•´ì¤€ í•˜ì´í¼ íŒŒë¼ë¯¸í„° ì´ë‹¤.

<br>

![11](https://user-images.githubusercontent.com/96368476/153039545-e9b3cc96-10bb-481d-9488-c825f9e1be28.jpg)
{: width="50%" height="60%"}

- Gradientë¥¼ computed analyticallyí•˜ë©´ì„œ íˆ­ ë˜ì ¸ì£¼ëŠ”ë° ì•„ì§ ì´í•´í•˜ì§€ ëª»í–ˆë‹¤. ì¢€ ë” ê³ ë¯¼í•´ë´ì•¼ê² ë‹¤.


<br>


# ğŸš€ Style Transfer

![10](https://user-images.githubusercontent.com/96368476/153039052-cf473197-b723-46e9-9f2f-b16d5770d70c.jpg)

ì´ì œ content lossì™€ style lossë¥¼ ì •ì˜í–ˆìœ¼ë‹ˆ total lossë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ style lossì˜ ì •ê·œí™” í…€ ë•Œë¬¸ì¸ì§€ ì•ŒíŒŒê°€ 1, ë² íƒ€ê°€ 1000 ì´ëŸ° ì‹ì´ë”ë¼. ë˜ í•˜ë‚˜ íŠ¹ì´í•œ ì ì€ LBFGS ë¼ëŠ” ì²˜ìŒ ë³´ëŠ” optimizerë¥¼ ì“°ë˜ë° tensorflow coreì—ì„œëŠ” admaì¨ë„ ê´œì°®ë‹¤ê³  í•œë‹¤. ì•„ë§ˆ ì˜›ë‚ ì— ì“°ë˜ optimizerì¸ê°€ ë³´ë‹¤.


<br>


[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}