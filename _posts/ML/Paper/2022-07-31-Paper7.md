---
title:  "[ë…¼ë¬¸ ë¦¬ë·°] Xception : Deep Learning with Depthwise Separable Convolutions" 

categories:
  -  Paper
tags:
  - [ML, Paper, Classification]

toc: true
toc_sticky: true

date: 2022-07-31
last_modified_at: 2022-07-31
---

**Paper: <br>- [Xception : Deep Learning with Depthwise Separable Convolutions](https://github.com/inhopp/inhopp/files/9228234/Xception.pdf)**
{: .notice--primary}


<br>

# ğŸš€ Abstract

| Simplified Inception | Reformulation Version | Extreme Version |
|:-:|:-:|:-:|
| ![1](https://user-images.githubusercontent.com/96368476/182015967-1b200631-b01d-4036-a08a-81ef77d0344e.png) | ![2](https://user-images.githubusercontent.com/96368476/182015968-15dc27e1-65ef-443b-ac67-964416fb0f93.png) | ![3](https://user-images.githubusercontent.com/96368476/182015969-6fc8d736-9406-404e-b444-cc2ca53300c6.png) |

ì €ìë“¤ì˜ ì œì‹œí•˜ëŠ” inception moduleì— ëŒ€í•œ í•´ì„ì€ simple convolutionê³¼ depthwise separable convolutionì˜ ì¤‘ê°„ ë‹¨ê³„ë¼ëŠ” ê²ƒì´ë‹¤. ë‹¤ì‹œ ë§í•´ depthwise separable convolution moduleì€ towerì˜ ê°¯ìˆ˜ê°€ ë§¤ìš° ë§ì€ inception moduleì— ë¶ˆê³¼í•˜ë‹¤ëŠ” ë§ì´ë‹¤(input channelì„ ì–¼ë§ˆë‚˜ ìª¼ê°¤ ê²ƒì¸ê°€ì˜ ì°¨ì´). ì´ëŸ¬í•œ ê´€ì ì—ì„œ Inception V3ì˜ ë‹¤ìŒ ëª¨ë¸ë¡œ inception moduleì„ depthwise separable moduleë¡œ ë°”ê¾¼ ëª¨ë¸ì„ ìƒê°í•  ìˆ˜ ìˆë‹¤. ì €ìë“¤ì€ ì´ ëª¨ë¸ì„ Extreme Inception, Xception ì´ë¼ ì´ë¦„ ì§€ì—ˆë‹¤. Xceptionì€ Inception V3ì™€ íŒŒë¼ë¯¸í„° ê°¯ìˆ˜ëŠ” ê°™ìœ¼ë©´ì„œë„ ì„±ëŠ¥ì´ ë›°ì–´ë‚˜ë‹¤. íŠ¹íˆ, ì•„ì£¼ í° datasetì—ì„œëŠ” ê·¸ ì°¨ì´ê°€ ë” ë²Œì–´ì§„ë‹¤. ë‘ ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„° ê°¯ìˆ˜ê°€ ê°™ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ì˜ ì°¨ì´ëŠ” ëª¨ë¸ì˜ í¬ê¸°ì—ì„œ ì˜¤ëŠ” ê²ƒì´ ì•„ë‹Œ, ì–¼ë§ˆë‚˜ íš¨ìœ¨ì ìœ¼ë¡œ êµ¬ì„±í–ˆëŠëƒì˜ ì°¨ì´ì—ì„œ ì˜¤ëŠ” ê²ƒì´ë‹¤. Depthwise Separable moduleì´ ì™œ íš¨ìœ¨ì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ ì•Œì•„ë³´ì.


<br>


# ğŸš€ Introduction

## Inception Hypothesis

![6](https://user-images.githubusercontent.com/96368476/182018023-37a1691a-f1a8-4460-b434-b205e102d063.png){: width="50%" height="60%" .align-center}

Simple Convolution ì—°ì‚°ì„ ìƒê°í•´ë³´ì. convolution layerì˜ ì—­í• ì€ 3D kernelë¡œ channelë³„ feature, 2D spatial featureë¥¼ í•™ìŠµí•˜ëŠ” ê²ƒì´ë‹¤. ì¦‰ í•˜ë‚˜ì˜ ì»¤ë„ì´ spatial correlation, cross-channel correlation ë‘ ê°€ì§€ ìš”ì¸ì„ í•™ìŠµí•œë‹¤. **<span style="color:red">Inception moduleì˜ hypothesis(main idea)ëŠ” ì´ ë‘ factorë¥¼ ë™ì‹œì— í•™ìŠµí•˜ëŠ” ê²ƒë³´ë‹¤, ë¶„ë¦¬í•´ì„œ í•™ìŠµí•˜ëŠ” ê²ƒì´ ë” íš¨ìœ¨ì ì´ë¼ëŠ” ê²ƒì´ë‹¤.</span>** Inceptionì€ ë¨¼ì € cross-channel correlationì„ êµ¬í•˜ê³ , ì±„ë„ì´ ì¤„ì–´ë“  ê³µê°„ì—ì„œ 2d spatial correlationì„ í•™ìŠµí•œë‹¤. ìœ„ì—ì„œ ë³´ì•˜ë˜ ê·¸ë¦¼ì„ ë‹¤ì‹œ ë³´ë©° inception moduleì˜ ì² í•™ì„ ì‚´í´ë³´ì.

<br>


| Simplified Inception | Reformulation Version | Extreme Version |
|:-:|:-:|:-:|
| ![1](https://user-images.githubusercontent.com/96368476/182015967-1b200631-b01d-4036-a08a-81ef77d0344e.png) | ![2](https://user-images.githubusercontent.com/96368476/182015968-15dc27e1-65ef-443b-ac67-964416fb0f93.png) | ![3](https://user-images.githubusercontent.com/96368476/182015969-6fc8d736-9406-404e-b444-cc2ca53300c6.png) |

- 1by1 convolutionì„ ë”°ë¡œ í•´ì•¼ í•  í•„ìš”ê°€ ìˆë‚˜? (simple -> reformulate)
- 1by1 convolutionì˜ output channelì„ ê°€ì§€ê³  2d spatial featureë¥¼ í•™ìŠµí•´ì•¼ í•˜ëŠ”ë°, ì–¼ë§ˆë‚˜ ë§ì€ kernelì´ í•„ìš”í•˜ë‚˜?
- Extreme version : input channelì˜ ê°¯ìˆ˜ë§Œí¼ í•´ì£¼ì (reformulate -> extreme)

Extreme ë²„ì „ ê¸°ì €ì— ê¹”ë ¤ìˆëŠ” ìƒê°ì€ mush stronger hypothesisì´ë‹¤. ì¦‰, "cross-channel correlationê³¼ 2d spatial correlationì´ ì™„ì „íˆ ë¶„ë¦¬ ê°€ëŠ¥í•˜ë‹¤"ë¼ëŠ” ê°€ì •ì¸ ê²ƒì´ë‹¤. ì´ ì•„ì´ë””ì–´ëŠ” ê¸°ì¡´ì— ì¡´ì¬í•˜ë˜ depthwise separable convolutionì˜ ì² í•™ê³¼ ì•„ì£¼ ìœ ì‚¬í•˜ë‹¤. Inceptionì˜ ì² í•™ì„ ë”°ë¼ê°€ë‹¤ ë³´ë©´ depthwise separableì´ ìì—°ìŠ¤ëŸ½ê²Œ ë“±ì¥í•œë‹¤ëŠ” ì˜ë¯¸ì¸ë° êµ‰ì¥íˆ í¥ë¯¸ë¡œì› ë‹¤. ë‘˜ ì‚¬ì´ì˜ ë¯¸ë¬˜í•œ ì°¨ì´ì ì„ ì‚´í´ë³´ì.


<br>


## Extreme Inception vs Depthwise Separable

| Extreme Inception | Depthwise Separable |
|:-:|:-:|
| ![5](https://user-images.githubusercontent.com/96368476/182018022-e0e40e61-2f32-4458-b5d8-3ae0abf5bdee.png) | ![4](https://user-images.githubusercontent.com/96368476/182018020-3d6deb1f-822c-47ad-be54-e447998467d6.png) |

1ï¸âƒ£ **ì—°ì‚°ì˜ ìˆœì„œê°€ ë‹¤ë¥´ë‹¤.**
- inceptionì˜ ê²½ìš° 1by1 convë¡œ cross-channel correlationì„ êµ¬í•œ ë’¤ì— depthwise convolutionì„ ìˆ˜í–‰í•œë‹¤.
- depthwise separableì˜ ê²½ìš° ê·¸ ë°˜ëŒ€ì´ë‹¤.

2ï¸âƒ£ **ì²« ë²ˆì§¸ ì—°ì‚° í›„ non-linearity (activation function)ì˜ ì¡´ì¬ ì—¬ë¶€**
- inceptionì˜ ê²½ìš° ê°ê°ì˜ ì—°ì‚° í›„ ëª¨ë‘ ReLU ì—°ì‚°ì´ ìˆ˜í–‰ëœë‹¤.
- depthwise separableì˜ ê²½ìš° ì¤‘ê°„ ë‹¨ê³„ì—ì„œëŠ” activation functionì„ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.

ì €ìë“¤ì€ 1ë²ˆ ì—°ì‚°ì˜ ìˆœì„œ ì°¨ì´ê°€ stack settingì— ë¶ˆê³¼í•  ë¿ ì¤‘ìš”í•˜ì§€ ì•Šë‹¤ê³  ë§í•œë‹¤. ë‚˜ì˜ ê´€ì ì€ ì¡°ê¸ˆ ë‹¤ë¥¸ë° ë§ˆì§€ë§‰ dicussionì—ì„œ ë‹¤ë£¨ì–´ ë³´ì. ë°˜ë©´ 2ë²ˆ ì°¨ì´ì¸ ì¤‘ê°„ non-linearlityì˜ ì¡´ì¬ ì—¬ë¶€ê°€ ì„±ëŠ¥ì— ìœ ì˜ë¯¸í•œ ì˜í–¥ì„ ë¼ì¹¨ì„ ì‹¤í—˜ì ìœ¼ë¡œ ë³´ì—¬ì¤€ë‹¤. í•´ë‹¹ ì‹¤í—˜ì˜ ë‚´ìš©ì€ Performanceì—ì„œ ë‹¤ë£¬ë‹¤.



<br>


# ğŸš€ Xception Architecture

![7](https://user-images.githubusercontent.com/96368476/182025972-aa183566-94ed-4ae2-9e05-d569f4610ade.png){: width="70%" height="80%" .align-center}

ë…¼ë¬¸ì„ ì½ìœ¼ë©´ì„œ ì¢€ ì–´ì´ê°€ ì—†ì—ˆë˜ ë¶€ë¶„ì¸ë°, extreme inception ì´ì•¼ê¸° ì‹¤ì»· í•´ë†“ê³  ë§‰ìƒ networkëŠ” depthwise separable blockìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤(ê·¸ë¦¼ì˜ SeparableConvëŠ” depthwise separableì„ ì˜ë¯¸í•œë‹¤). Depthwise Separable blockì´ ì´ë¯¸ tensorflowì— êµ¬í˜„ë˜ì–´ ìˆì–´ì„œ ë§Œë“¤ê³  ìœ ì§€ë³´ìˆ˜í•˜ê¸° í¸í•´ì„œë¼ê³  í•˜ëŠ”ë° ì´ê²ƒë§Œìœ¼ë¡œëŠ” ë‚©ë“ì´ ì˜ ì•ˆ ê°„ë‹¤. ì•„ë§ˆ ê¸°ì €ì— ê¹”ë¦° ì² í•™ì´ xceptionê³¼ ê°™ì•„ì„œ í˜¹ì€ ëª¨ë¸ì˜ motivationì´ inceptionì´ë¼ ê·¸ëŸ°ë“¯í•˜ë‹¤. (í˜¹ì€ googleë‹¤ë‹ˆëŠ” ì–´ë¥¸ë“¤ì˜ ì‚¬ì •?) <br> Xception architectureëŠ” ê¸°ë³¸ì ìœ¼ë¡œ depthwise separable blockì˜ linear stackìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆê³ , first & last moduleì„ ì œì™¸í•œ ëª¨ë“  moduleì— residual connectionì´ ì¡´ì¬í•œë‹¤. ì‚¬ì†Œí•˜ì§€ë§Œ í•œê°€ì§€ ì§šê³  ì‹¶ì€ ë‚´ìš©ì€ ê°™ì€ blockì„ ë‹¨ìˆœíˆ ìŒ“ì€ í˜•íƒœì˜ êµ¬ì¡°ì´ë‹¤. ë…¼ë¬¸ì—ì„œëŠ” VGGë¥¼ ì°¸ê³ í•´ì„œ ë§Œë“¤ì—ˆë‹¤ê³  í•˜ëŠ”ë°, íŠ¹ë³„í•œ ì´ìœ ê°€ ìˆëŠ” ê²ƒì¸ì§€ ìì›ì˜ í•œê³„ ë•Œë¬¸ì¸ì§€ ê¶ê¸ˆí•˜ë‹¤. MobileNetì€ depthwise separable block ì‚¬ì´ì‚¬ì´ì— simple convolutionì´ ë“¤ì–´ìˆë˜ë° ê¸°ì¤€ì„ ëª¨ë¥´ê² ë‹¤. ê¸°ì¤€ì´ë€ê²Œ ì—†ì„ ìˆ˜ë„ ìˆê³ .



<br>


# ğŸš€ Performance

ì„±ëŠ¥ì„ ë¹„êµí•˜ê¸° ì „ì— ì•Œì•„ë‘˜ ì ì€ inception V3ì™€ ë™ì¼í•œ optimization configurationì„ ì„¸íŒ…í–ˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì¦‰, xceptionì— ë” ìµœì í™” í•  ìˆ˜ ìˆë‹¤ëŠ” ë§ì¸ë° ì§ì ‘ ì°¾ê¸°ëŠ” ê·€ì°®ìœ¼ì…¨ë‚˜ ë³´ë‹¤. ì‚¬ìš©í•œ ë°ì´í„°ì…‹ì€ ImageNet, JFT ë‘ ì¢…ë¥˜ì´ë‹¤.

| Training on ImageNet | Training on JFT |
|:-:|:-:|
| ![8](https://user-images.githubusercontent.com/96368476/182026499-663ce1a9-4be3-415c-9dcc-f3a5589ac9b4.png) | ![9](https://user-images.githubusercontent.com/96368476/182026500-64d16098-df9f-4688-a07c-879772669472.png) |

- ImageNet: 1000-class & single-label classification
- JFT: 17000-class & multi-class classification
- imagenetì—ì„œëŠ” ì•½ê°„ ë” ì¢‹ê³ , JFTì—ì„œëŠ” ë§ì´ ì¢‹ë‹¤.
- (ì•„ë§ˆ inception v3ê°€ imagenetì„ ê¸°ì¤€ìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ê·¸ëŸ°ë“¯)
- gradient step ì†ë„ëŠ” inceptionì´ ì¡°ê¸ˆ ë” ë¹ ë¥´ë‹¤. (28/31 steps per sec)


<br>

## Effect of the residual connection

![10](https://user-images.githubusercontent.com/96368476/182026497-eb121420-4dbe-40a0-a8ad-55f32313e924.png){: width="50%" height="60%" .align-center}

Residual connectionì„ ë¹¼ë©´ ì„±ëŠ¥ì´ ëš ë–¨ì–´ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. Xceptionì—ì„œ residual connectionì€ speedì™€ accuracyë¥¼ ë™ì‹œì— ì˜¬ë ¤ì£¼ëŠ” í•„ìˆ˜ì ì¸ ìš”ì†Œì´ë‹¤. ê·¸ëŸ¼ residual connectionì€ ë¬´ì¡°ê±´ ì¢‹ì„ê¹Œ? ê·¸ê±´ ì•„ë‹ˆë‹¤. VGGì˜ base moduleì„ depthwise separableë¡œ ë°”ê¾¼ ëª¨ë¸ì—ì„œëŠ” residual connectionì´ ì—†ì„ ë•Œ ì„±ëŠ¥ì´ ì¢‹ì•˜ë‹¤ê³  í•œë‹¤. ì¦‰, ëª¨ë¸ì˜ êµ¬ì¡°ì— ë”°ë¼ ì¢‹ì„ ìˆ˜ë„ ë‚˜ì  ìˆ˜ë„ ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.


<br>


## Effect of an intermediate activation

![11](https://user-images.githubusercontent.com/96368476/182026498-f0f9a346-6b7a-483c-b51a-9b59caf8b7a2.png){: width="50%" height="60%" .align-center}

Non-linearityê°€ ì˜¤íˆë ¤ ì„±ëŠ¥ì„ ë–¨ì–´ëœ¨ë¦°ë‹¤ëŠ” ê²ƒì€ ì˜ˆìƒ ë°–ì˜ ê²°ê³¼ì´ë‹¤. ë” ì£¼ëª©í•  ì§€ì ì€ ê°™ì€ inception ëª¨ë“ˆë¡œ ë°˜ëŒ€ì˜ ê²°ê³¼ë¥¼ ì–»ì€ ë…¼ë¬¸ì´ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. í•´ë‹¹ ë…¼ë¬¸ì— ë”°ë¥´ë©´ activation functionì´ deep kenel convolution(ê¹Šì€ channelì˜ í•„í„°)ì—ì„œëŠ” ë„ì›€ì´ ë˜ê³ , shallow kenelì—ì„œëŠ” ì„±ëŠ¥ì„ ë–¨ì–´ëœ¨ë¦°ë‹¤ê³  í•œë‹¤.


<br>

# ğŸš€ Future Direction

ì €ìë“¤ì€ inception moduleì˜ extreme versionì„ ê°€ì§€ê³  ëª¨ë¸ì„ ë§Œë“¤ì—ˆì§€ë§Œ, extremeë²„ì „ì´ ë°˜ë“œì‹œ optimalí•˜ë‹¤ëŠ” ë³´ì¥ì€ ì—†ë‹¤. ê¸°ì¡´ì˜ inceptionê³¼ extreme inception ì‚¬ì´ ì¤‘ê°„ ë‹¨ê³„ì˜ ëª¨ë“ˆë“¤ë¡œë„ ì¶©ë¶„íˆ ëª¨ë¸ì„ ë§Œë“¤ ìˆ˜ ìˆê³  í˜¹ì‹œ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë‚˜íƒ€ë‚¼ì§€ ëª¨ë¥¸ë‹¤. (ê·¼ë° ë„ˆê·¸ë“¤ì´ í•´ë´ë¼)



<br>

# ğŸš€ Discussion

## Extreme Inception vs Depthwise Separable

ìœ„ ë‚´ìš©ì—ì„œ ì €ìë“¤ì€ ì—°ì‚° ìˆœì„œ ì°¨ì´ê°€ ë‹¨ì§€ stacking settingì— ë¶ˆê³¼í•˜ë‹¤ê³  ë§í•œë‹¤. í•˜ì§€ë§Œ ì§ê´€ì ìœ¼ë¡œ ìƒê°í•´ë³´ë©´ ì •ë³´ë¥¼ ì••ì¶•ì‹œí‚¨ í›„ì— 2d spatial featureë¥¼ ë½‘ëŠ” ê²ƒë³´ë‹¤ 2d spatial featureë¥¼ ë¨¼ì € ë½‘ê³  ì •ë³´ë¥¼ ì••ì¶•ì‹œí‚¤ëŠ” ê²ƒì´ ë” í•©ë¦¬ì ì´ì§€ ì•Šì„ê¹Œ ì‹¶ë‹¤. ìˆ˜í•™ê³¼ ì¶œì‹ ì´ë¼ ê·¸ëŸ°ì§€ êµí™˜ë²•ì¹™ì„ ë§‰ ê°€ì ¸ë‹¤ ì“°ë©´ ì–´ë”˜ê°€ ë¶ˆí¸í•˜ë‹¤.. ë‚˜ì¤‘ì— ì—¬ìœ ê°€ ìƒê¸°ë©´ ê²€ì¦í•´ë´ì•¼ê² ë‹¤.



<br>


## Effect of the residual connection

ë‚´ê°€ ìƒê°í•˜ëŠ” residual connectionì˜ ì˜ë¯¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì •ë³´ë¥¼ ê°•í•˜ê²Œ ì••ì¶•í–ˆì„ ê²½ìš°, í° featureë“¤ì€ ì˜ ë½‘ì•„ë‚´ê² ì§€ë§Œ ì‘ì€ featureë“¤ì€ ë†“ì¹˜ê¸° ì‰¬ì›Œì§„ë‹¤. ì´ë•Œ ë†“ì¹˜ê¸° ì‰¬ìš´ ì‘ì€ ì •ë³´ë“¤ì„ ë³´ì™„í•´ì£¼ê¸° ìœ„í•´ ì••ì¶•í•˜ê¸° ì „ì˜ ë°ì´í„°ë¥¼ ë”í•´ì£¼ëŠ” ê²ƒì´ residual connectionì´ë‹¤. ì¦‰, residual connectionì€ ì••ì¶•ì˜ ì •ë„ê°€ ê°•í•  ìˆ˜ë¡ íš¨ê³¼ê°€ ì¢‹ì„ ê²ƒì´ë¼ëŠ” ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ë‹¤. í˜¹ì‹œ VGGì˜ convë¥¼ depthwise separableë¡œ ë°”ê¾¼ ëª¨ë¸ì—ì„œëŠ” channel-correlationì„ ì–•ê²Œ ì••ì¶•í•œ ê²ƒì´ ì•„ë‹ê¹Œ? ë§Œì•½ ê·¸ë ‡ë‹¤ë©´ ì´ ë¶€ë¶„ì€ ì¶©ë¶„íˆ ì„¤ëª…ì´ ê°€ëŠ¥í•˜ê²Œ ëœë‹¤. í•´ë‹¹ ëª¨ë¸ì˜ êµ¬ì²´ì ì¸ ì •ë³´ëŠ” ì—†ì–´ì„œ í™•ì¸ì€ ëª»í•´ë´¤ë‹¤.


<br>
<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}