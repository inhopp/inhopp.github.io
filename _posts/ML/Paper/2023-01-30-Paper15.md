---
title:  "[Paper Review] Deep Convolutional Generative Adversarial Networks (DCGANs)" 

categories:
  -  Paper
tags:
  - [ML, Generative]

toc: true
toc_sticky: true

date: 2023-01-30
last_modified_at: 2023-01-30
---

**Main Reference: <br>- [DCGANs Paper](https://github.com/inhopp/inhopp/files/10536727/DCGAN.pdf) <br>- [Jaejun Yoo's Playground](https://jaejunyoo.blogspot.com/2017/02/deep-convolutional-gan-dcgan-1.html)**
{: .notice--primary}

<br>


# ğŸš€ Introduction

GAN ëª¨ë¸ì€ maximum likelihood ê¸°ë²•ì„ ì‚¬ìš©í•˜ëŠ” ê¸°ì¡´ ìƒì„±ëª¨ë¸ë“¤ì„ í›Œë¥­í•˜ê²Œ ëŒ€ì²´í–ˆë‹¤. í•˜ì§€ë§Œ í•™ìŠµì´ ë¶ˆì•ˆì •í•˜ê³  generatorê°€ ì´ìƒí•œ outputì„ ë‚´ë±‰ëŠ” í˜„ìƒì´ ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” multi-layer perceptron êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì§„ ê¸°ì¡´ Generator, Discriminator ëª¨ë¸ì„ Deep Convolution ê¸°ë°˜ ëª¨ë¸ë¡œ ë°”ê¾¸ë©° ë„¤íŠ¸ì›Œí¬ë¥¼ ì•ˆì •í™”ì‹œí‚¤ëŠ”ë° ì„±ê³µí–ˆê³  ì¶”ê°€ì ìœ¼ë¡œ ë‹¤ìŒ ë‚´ìš©ë“¤ì„ ë‹¤ë£¬ë‹¤.

- Convolution êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ì•ˆì •í™”
- GANì—ì„œ í›ˆë ¨ëœ DiscriminatorëŠ” ê·¸ ìì²´ë¡œ ì¢‹ì€ classifierì„
- G, Dì˜ filterë“¤ì„ ì‹œê°í™”í•˜ì—¬ ì–´ë–¤ featureë“¤ì„ í•™ìŠµí•˜ëŠ”ì§€ í™•ì¸
- Generatorê°€ ìƒì„±í•˜ëŠ” ì´ë¯¸ì§€ë“¤ì€ ë§ˆì¹˜ word2vecì²˜ëŸ¼ vector arithmetic ì„±ì§ˆì„ ê°€ì§



<br>


# ğŸš€ Approach and Model Architecture

ì‚¬ì‹¤ G, Dë¥¼ convolution networksë¡œ ë°”ê¾¸ìëŠ” ì•„ì´ë””ì–´ëŠ” ë„ˆë¬´ ìì—°ìŠ¤ëŸ¬ì›Œ 'ë…¼ë¬¸ê°ì¸ê°€..?'í•˜ëŠ” ìƒê°ì´ ë“ ë‹¤. í•˜ì§€ë§Œ ë…¼ë¬¸ì„ ì½ì–´ë³´ë©´ GANì„ scale upí•˜ëŠ” ê³¼ì •ì´ ìƒë‹¹íˆ ì–´ë ¤ì› ë‹¤ê³  í•œë‹¤(ì–´ì§¸ì„œ?). Facebookì—ì„œ ê·¼ë¬´í•˜ëŠ” ì €ìë„ ì• ë¥¼ ì¢€ ë¨¹ì—ˆëŠ”ë° extensive model exploration ëì— ê´œì°®ì€ ëª¨ë¸ì„ ì°¾ì•„ëƒˆë‹¤ê³  í•œë‹¤. ê·¸ë ‡ê²Œ ë‚˜ì˜¨ ë„¤íŠ¸ì›Œí¬ì˜ êµ¬ì¡°ë¥¼ ë³´ë©´ ë‹¨ìˆœ cnn êµ¬ì¡°ì´ë‹¤.

<br>

![dcgan1](https://user-images.githubusercontent.com/96368476/215671929-3d791633-c9d0-4c83-8519-037a38621a46.png){: width="60%" height="70%" .align-center}

- Pooling layerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ 
  - Discriminatorì—ì„œëŠ” strided convolution
  - Generatorì—ì„œëŠ” fractional-strided convolution (transposed conv)
- Batchnorm ì‚¬ìš© (ì˜¤ë˜ëœ ëª¨ë¸ì´ë¼ ê°•ì¡°)
- ë§ˆì§€ë§‰ fully-connected layerë¥¼ ì œê±°
  - Global Average Poolingìœ¼ë¡œ êµì²´í–ˆë”ë‹ˆ ìˆ˜ë ´ì†ë„ëŠ” ì¡°ê¸ˆ ëŠë ¤ì§€ì§€ë§Œ ì•ˆì •ì„± í–¥ìƒ
- Activation function ë³€ê²½
  - GeneratorëŠ” ReLU + ë§ˆì§€ë§‰ output ì¶œë ¥í•  ë•Œì—ë§Œ tanh
  - DiscriminatorëŠ” LeakyReLU



<br>



# ğŸš€ Results

| Epoch 1 | Epoch 5 |
|:-:|:-:|
| ![dcgan2](https://user-images.githubusercontent.com/96368476/215682009-ff78460d-1ee8-411f-ad4f-78625d2978bd.png) | ![dcgan3](https://user-images.githubusercontent.com/96368476/215682081-33398152-edfc-4fbe-b666-69009c71bf29.png) |

- LSUN : bedrooms dataset (30000 training examples)
- G, D ëª¨ë¸ì„ scale up í•˜ë©´ì„œ overfitting & memorizationì´ ê±±ì •ë˜ì—ˆì§€ë§Œ, 5 epochì„ ëŒë ¤ë„ ë…¸ì´ì¦ˆ ë‚€ ë°ì´í„°ê°€ ì¡´ì¬
  - Underfittingì´ë¼ ì£¼ì¥


<br>



# ğŸš€ Investigating and Visualizing The Internals of the Networks 

<br>

## Walking in the latent space

![dcgan5](https://user-images.githubusercontent.com/96368476/215689296-9768b426-4216-4bb9-919c-a5f07514ebc0.png){: width="60%" height="70%" .align-center}

ì˜¤í† ì¸ì½”ë” ëª¨ë¸ì˜ ê²½ìš° ì¸ì½”ë”ë¥¼ í†µí•´ input ë°ì´í„°ë¥¼ ì €ì°¨ì›ì˜ manifold(latent space)ë¡œ dimensionallity reductionì„ ìˆ˜í–‰í•œë‹¤. GANì˜ ê²½ìš° generatorì˜ êµ¬ì¡°ë¥¼ ë³´ë©´, 100ì°¨ì›ì˜ noise vector zë¡œ ë¶€í„° ìƒˆë¡œìš´ ì´ë¯¸ì§€ê°€ ìƒì„±ëœë‹¤. ì´ z ë²¡í„°ë¥¼ ë¶€ë“œëŸ½ê²Œ ì›€ì§ì´ë©´ ìƒì„± ì´ë¯¸ì§€ëŠ” ì–´ë–»ê²Œ ë³€í• ê¹Œ? ë†€ëê²Œë„ ìƒì„± ì´ë¯¸ì§€ ì—­ì‹œ ë¶€ë“œëŸ½ê²Œ ë³€í™”í•œë‹¤. ì¦‰, z ê³µê°„ì´ ì¸ì½”ë” ê²°ê³¼ ë‚˜ì˜¨ latent spaceì™€ ë¹„ìŠ·í•œ ê³µê°„ì¸ ê²ƒì²˜ëŸ¼ ì‘ë™í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê·¸ë¦¼ì˜ ë§ˆì§€ë§‰ í–‰ì„ ë³´ë©´, TVê°€ ìì—°ìŠ¤ëŸ½ê²Œ ì°½ë¬¸ìœ¼ë¡œ ë³€í™”í•œë‹¤.


<br>


## Visualizing the discriminator features

![dcgan6](https://user-images.githubusercontent.com/96368476/215691345-e0101a73-2b5b-4e84-9090-ffc333929393.png){: width="60%" height="70%" .align-center}

<br>

![dcgan4](https://user-images.githubusercontent.com/96368476/215682117-d19b4619-eac9-49ae-912b-5e3665df9403.png){: width="60%" height="70%" .align-center}

ì €ìë“¤ì€ Guided backpropagationê¸°ë²•ì„ ì´ìš©í•´ Discriminator ë‚´ì— ì¡´ì¬í•˜ëŠ” filterë“¤ì„ ì‹œê°í™”í–ˆë‹¤. ê·¸ë¦¼ì˜ ì™¼ìª½ì²˜ëŸ¼ í•™ìŠµ ì „ì—ëŠ” ê° filerê°€ ì–´ë–¤ featureë“¤ì„ ë‹´ë‹¹í•˜ëŠ”ì§€ ì•Œê¸° ì–´ë ¤ìš´ ë°˜ë©´ í•™ìŠµ í›„ì—ëŠ” ê° filterê°€ íŠ¹ì • featureë“¤ì„ ë‹´ë‹¹í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤. ì‹¤ì œë¡œë„ imagenet 1kë¡œ í•™ìŠµí•œ DCGANì˜ discriminator ëª¨ë¸ì´ ì—¬ëŠ ëª¨ë¸ì— ê¿€ë¦¬ì§€ ì•ŠëŠ” classifierì—­í• ì„ í•œë‹¤.



<br>



# ğŸš€ Manipulating the Generator Representation

<br>

## Forgetting to draw certain objects

![dcgan7](https://user-images.githubusercontent.com/96368476/215693102-7f32e7c4-b65a-4837-aa76-6ca6511e532c.png){: .align-center}

ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ generatorì˜ filterë„ ë¶„ì„ì´ ê°€ëŠ¥í•˜ë‹¤. ìœ„ ê·¸ë¦¼ì€ ì°½ë¬¸ì— í•´ë‹¹í•˜ëŠ” filterë¥¼ êº¼ë²„ë ¸ì„ ë•Œ ë‚˜íƒ€ë‚˜ëŠ” ê²°ê³¼ì´ë‹¤(ì²« í–‰: ìˆ˜ì • ì „, ì•„ë˜ í–‰: ìˆ˜ì • í›„). ì°½ë¬¸ì´ ë¬¸ìœ¼ë¡œ ë°”ë€ŒëŠ” ë“± ì¬ë°ŒëŠ” ê²°ê³¼ê°€ ë‚˜íƒ€ë‚œë‹¤. ì´ëŸ¬í•œ ê²°ê³¼ë¥¼ ë³´ê³  ìˆìœ¼ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ì›í•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³ ì‹¶ì€ ìš•êµ¬ê°€ ìƒê¸´ë‹¤. ë‹¤ìŒ ë…¼ë¬¸ìœ¼ë¡œ conditional GANì„ ë¦¬ë·°í•  ê³„íšì´ë‹¤.


<br>


## Vector arithmetic on face samples

| Smiling man | Woman with glasses |
|:-:|:-:|
| ![dcgan8](https://user-images.githubusercontent.com/96368476/215696189-5a61fdbc-7f53-49e1-95dc-38eb1db2ab5a.png) | ![dcgan9](https://user-images.githubusercontent.com/96368476/215696182-81f61a38-0bec-4a35-9aeb-507424d1d335.png) |

Word2vecì—ì„œ ë‹¨ì–´ëŠ” ë§ˆì¹˜ ë²¡í„°ì²˜ëŸ¼ ì‘ë™í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ **King(vec) - Man(vec) + Woman(vec) = Queen(vec)** ì´ ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë§ì´ë‹¤. ì´ëŸ¬í•œ í˜„ìƒì´ DCGANì˜ z ê³µê°„ì—ì„œë„ ë°œìƒí•œë‹¤. ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì„ ë³´ë©´ **ì•ˆê²½ ì“´ ë‚¨ì - ì•ˆê²½ ì•ˆ ì“´ ë‚¨ì + ì•ˆê²½ ì•ˆ ì“´ ì—¬ì = ì•ˆê²½ ì“´ ì—¬ì** ê°€ ë‚˜íƒ€ë‚¨ì„ ì•Œ ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ ëª¨ë¸ì´ ë¶ˆì•ˆì •í•˜ê¸° ë•Œë¬¸ì— ëª‡ ê°œì˜ ë²¡í„°ë¥¼ í‰ê· í•´ì•¼í•œë‹¤ê³  í•œë‹¤.

<br>

![dcgan10](https://user-images.githubusercontent.com/96368476/215696200-3b4815fb-e234-4b85-b0df-7aa53b3866df.png){: width="60%" height="70%" .align-center}

ë¿ë§Œ ì•„ë‹ˆë¼ ì™¼ìª½ì„ ë°”ë¼ë³´ëŠ” ì–¼êµ´ì„ ìƒì„±í•˜ëŠ” ë²¡í„°, ì˜¤ë¥¸ìª½ì„ ë°”ë¼ë³´ëŠ” ì–¼êµ´ì„ ìƒì„±í•˜ëŠ” ë²¡í„°ì˜ í‰ê·  ë²¡í„°ëŠ” ê°€ìš´ë°ë¥¼ ë°”ë¼ë³´ëŠ” ì–¼êµ´ì„ ìƒì„±í•œë‹¤! ì •ë¦¬ë¥¼ ë§ˆë¬´ë¦¬í•˜ë©° ë“œëŠ” ìƒê°ì€ ì´ ë…¼ë¬¸ì˜ í•µì‹¬ì´ ë‹¨ìˆœí•œ ëª¨ë¸ì˜ êµ¬ì¡°ê°€ ì•„ë‹Œ GAN íŠ¹íˆ Generatorì˜ ë¬´ê¶ë¬´ì§„í•œ ì ì¬ë ¥ì„ ë³´ì¸ ê²ƒì´ë¼ëŠ” ê²ƒì´ë‹¤.


<br>



# ğŸš€ Code

> ì¶”ê°€ ì˜ˆì •



<br>
<br>



[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}