---
title:  "ScrennShot" 

categories:
  -  Graphics
tags:
  - [DirectX]

toc: true
toc_sticky: true

date: 2023-08-23
last_modified_at: 2023-08-23
---


í™ì •ëª¨ë‹˜ì˜ **[ê·¸ë˜í”½ìŠ¤ ìƒˆì‹¹ì½”ìŠ¤](https://honglab.co.kr/)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ¥ ScreenShot

![captured1](https://github.com/inhopp/StyleGAN/assets/96368476/d8b4fed2-39e8-4c3e-941b-d9d126b437c9){: width="40%" height="50%"}

Render Targetì— ê·¸ë¦° ë Œë”ë§ ê²°ê³¼ë¥¼ ì €ì¥í•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ? ìš°ì„  ë Œë”ë§ ê²°ê³¼ê°€ GPU ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì´ë¥¼ CPUë¡œ ì˜®ê²¨ì£¼ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. ì´ ê³¼ì •ì´ ìƒê°ë³´ë‹¤ ë³µì¡í•œë° ê·¸ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì²«ì§¸, RenderTargetìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” TextureëŠ” Multi-Samplingì„ ìœ„í•œ íŠ¹ìˆ˜í•œ ìë£Œêµ¬ì¡° Texture2D-MSë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ë”°ë¼ì„œ ì´ë¥¼ ì¼ë°˜ì ì¸ Texture2Dë¡œ ë°”ê¿”ì•¼ í•œë‹¤. ë‘˜ì¨°, GPUì—ì„œ Texutreë¥¼ ë§Œë“¤ê³  ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹ë°›ìœ¼ë ¤ë©´ ìš©ë„ë¥¼ ëª…í™•íˆ ì§€ì •í•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ 'CPUë¡œ ë³´ë‚´ê¸° ìœ„í•´ ì„ì‹œë¡œ ì €ì¥í•˜ëŠ” (Staging) Textureì…ë‹ˆë‹¤'í•˜ê³  ë³„ë„ì˜ textureë¡œ ë°”ê¿”ì•¼ í•œë‹¤.


<br>


``` cpp
m_context->ResolveSubresource(m_tempTexture.Get(), 0,
                                backBuffer.Get(), 0,
                                DXGI_FORMAT_R8G8B8A8_UNORM);

```

- ResolveSubresource : GPU -> GPU ë©”ëª¨ë¦¬ ë³µì‚¬
- back bufferë¥¼ temp textureë¡œ ì˜®ê²¨ì£¼ê¸°

<br>


``` cpp
ComPtr<ID3D11Texture2D> stagingTexture;

D3D11_TEXTURE2D_DESC desc;
// ...
desc.CPUAccessFlags = D3D11_CPU_ACCESS_READ // CPUì—ì„œ ì½ì„ ìˆ˜ ìˆì–´ìš”
desc.Usage = D3D11_USAGE_STAGING; // ì„ì‹œë¡œ ì €ì¥í•˜ëŠ” ìš©ë„ì—ìš”

D3D11_MAPPED_SUBRESOURCE ms;

std::Vector<uint8_t> pixels(desc.Width * desc.Height * 4);

context->Map(stagingTexture.Get(), NULL, D3D11_MAP_READ, NULL, &ms);

uint8_t *pData = (uint8_t *)ms.pData;
for (unsigned int h=0; h<desc.Height; h++) {
    memcpy(&pixels[h * desc.Width * 4], &pData[h * ms.RowPitch], desc.Width * sizeof(uint8_t) * 4);
}

context->Unmap(stagingTexture.Get(), NULL);


```

- Staging Texture ìƒì„±í•˜ê³  (desc ì£¼ì˜)
- map -> memcopy -> Unmap
- forë¬¸ìœ¼ë¡œ ê°€ë¡œ ì¤„ í•˜ë‚˜ì”© ë³µì‚¬
- R8G8B8A8 ê°€ì •
- ì´ì œ CPUì—ì„œ pixelsë¡œ í•œ ì¤„ì”© ì¨ì£¼ë©´ ìº¡ì³ ì™„ë£Œ!

<br>
<br>


[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}