---
title:  "Normal Mapping" 

categories:
  -  Graphics
tags:
  - [DirectX]

toc: true
toc_sticky: true

date: 2023-09-05
last_modified_at: 2023-09-05
---


í™ì •ëª¨ë‹˜ì˜ **[ê·¸ë˜í”½ìŠ¤ ìƒˆì‹¹ì½”ìŠ¤](https://honglab.co.kr/)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ¥ Normal Mapping

![ezgif com-crop (2)](https://github.com/inhopp/StyleGAN/assets/96368476/69761fc9-f5f4-4062-a2f8-b3a767ab0b89)

| Texture | Tangent Frame |
|:-:|:-:|
|![1](https://github.com/inhopp/StyleGAN/assets/96368476/c6d5aa26-6cc7-4564-9b32-a821124639f2)|![normal](https://github.com/inhopp/StyleGAN/assets/96368476/9f43183e-4752-4839-8d89-3d6915198f96)|

- ì›ë˜ normalì´ë¼ í•¨ì€ tangent planeì— ìˆ˜ì§í•´ì•¼ í•¨
- normal mappingì´ë€ ë©”ì‹œì˜ vertexëŠ” ê·¸ëŒ€ë¡œ ë‘ê³ , normalë§Œ ìˆ˜ì •í•´ ì…ì²´ íš¨ê³¼ë¥¼ ë‚´ëŠ” ê¸°ë²•
- ìœ„ gifëŠ” í‰ë©´ ë©”ì‹œì— normal mappingë§Œ í•œ ê²°ê³¼
- Texture Coordinateìœ¼ë¡œ ë“¤ê³  ìˆëŠ” normal vectorë¥¼ TNB Frameìœ¼ë¡œ ì˜®ê²¨ì£¼ì–´ì•¼ í•¨

<br>

``` hlsl
struct Vertex {
    Vector3 position;
    Vector3 normal;
    Vector2 texCoord;
    Vector3 tangent;
};

// in Pixel Shader

if (useNormalMap)
{
    float3 normalTex = g_normalTexture.SampleLevel(g_sampler, input.texcoord, 0.0).rgb
    normalTex = 2.0 * normalTex - 1.0;

    float3 N = normal;
    float3 T = normalize(input.tangent - dot(input.tangent, N) * N);
    float3 B = cross(N, T);

    float3x3 TBN = float3x3(T, B, N);

    normal = normalize(mul(normalTex, TBN))
}
```

- ë©”ì‹œì˜ Vertexì—ì„œ tangentë„ ë“¤ê³  ë‹¤ë‹ˆê¸°
    - tangentëŠ” ë³´í†µ ë°”ë¡œ ì˜† vertex ì—°ê²°í•´ì„œ ìƒì„±
- Normal Textureì—ì„œ normal vector ê°€ì ¸ì˜¤ê¸°
    - ì´ë•Œ [-1, 1]ë¡œ ë²”ìœ„ ì¬ì§€ì • (RGBë¡œ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— 0~1)
- Nì€ ê¸°ì¡´ normal ì‚¬ìš©
- TëŠ” í˜¹ì‹œ ëª¨ë¥´ë‹ˆ Nì„±ë¶„ ë¹¼ê³  ì‚¬ìš©
- BëŠ” N,T ì™¸ì ìœ¼ë¡œ ìƒì„±
- TBNì€ í¬ê¸°ê°€ 1ì¸ basisì´ê¸° ë•Œë¬¸ì— ë‹¨ìˆœ ê³±ìœ¼ë¡œ ë³€í™˜ ê°€ëŠ¥

<br>


# ğŸ¥ Results

| Wire Frame | Albedo | Normal | Albedo + Normal |
|:-:|:-:|:-:|:-:|
| ![2](https://github.com/inhopp/StyleGAN/assets/96368476/9f055cf6-4505-40cd-bdfa-42663a9d1cc9) | ![3](https://github.com/inhopp/StyleGAN/assets/96368476/8a3f5bd5-7b29-4996-8525-3cdbf2e153af) | ![4](https://github.com/inhopp/StyleGAN/assets/96368476/f307d01c-8d57-4428-9eb1-c14eb98c0fcd) | ![5](https://github.com/inhopp/StyleGAN/assets/96368476/aef23007-84e5-451f-8631-1cf0570a5aef) |

<br>

![ezgif com-crop (3)](https://github.com/inhopp/StyleGAN/assets/96368476/dfbdd14a-ac13-4a3e-b70d-fed789d252b6)



<br>
<br>


[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}