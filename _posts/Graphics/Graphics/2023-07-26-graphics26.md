---
title:  "Draw Nomals" 

categories:
  -  Graphics
tags:
  - [DirectX]

toc: true
toc_sticky: true

date: 2023-07-26
last_modified_at: 2023-07-26
---


í™ì •ëª¨ë‹˜ì˜ **[ê·¸ë˜í”½ìŠ¤ ìƒˆì‹¹ì½”ìŠ¤](https://honglab.co.kr/)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ¥ Draw Normal

ì¶”í›„ Geometry Shaderë¥¼ ì´ìš©í•˜ë©´ meshì˜ vertex ì •ë³´ë§Œìœ¼ë¡œ normalì„ ê·¸ë¦´ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” normalì˜ vertexë“¤ì„ ë”°ë¡œ êµ¬í•œ ë’¤, ë©”ì‹œì™€ ë³„ë„ë¡œ ë Œë”ë§í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•œë‹¤.

<br>

## Vertices / Indices

``` cpp
// Vertices ì§€ì •
for (size_t i = 0; i < meshData.vertices.size(); i++) {

    auto v = meshData.vertices[i];

    v.texcoord.x = 0.0f; 
    normalVertices.push_back(v);

    v.texcoord.x = 1.0f; 
    normalVertices.push_back(v);

    normalIndices.push_back(uint16_t(2 * i));
    normalIndices.push_back(uint16_t(2 * i + 1));


// ...

m_context->IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_LINELIST);
}
```

- ê¸°ì¡´ meshì˜ vertexë“¤ì„ ë‘ ë²ˆì”© ì‚½ì…
    - í•˜ë‚˜ëŠ” texcoord.x = 0 : normalì˜ ì‹œì‘ ì§€ì 
    - ë‹¤ë¥¸ í•˜ë‚˜ëŠ” texcoord.x = 1 : normalì˜ ë ì§€ì 
- Topology - D3D11_PRIMITIVE_TOPOLOGY_LINELISTë¡œ ì§€ì •í•˜ë©´ index ë‘ê°œì”© ì§ì§€ì–´ ì§ì„  ê·¸ë¦¼

<br>

## Constant Buffer

``` cpp
// Vertex Shader
cbuffer BasicVertexConstantBuffer : register(b0)
{
    matrix model;
    matrix invTranspose;
    matrix view;
    matrix projection;
};

cbuffer NormalVertexConstantBuffer : register(b1)
{
    float scale; // normalì˜ ê¸¸ì´
};
```

- MVP ë³€í™˜ì€ ê¸°ì¡´ ë©”ì‹œì™€ ë™ì¼í•œ ë³€í™˜
    - ë©”ì‹œ ê·¸ë¦´ ë•Œ ì‚¬ìš©í•œ vertex buffer ê·¸ëŒ€ë¡œ ì‚¬ìš©!
- normalì— í•„ìš”í•œ scaleë§Œ ì¶”ê°€ë¡œ cpu -> gpu ë³´ë‚´ì£¼ê¸°

<br>

``` cpp
ID3D11Buffer *pptr[2] = {m_mesh->m_vertexConstantBuffer.Get(),
                        m_normalLines->m_vertexConstantBuffer.Get()};

m_context->VSSetConstantBuffers(0, 2, pptr);
```

- pointerë¥¼ ì´ìš©í•˜ì—¬ shaderì— ì—¬ëŸ¬ ê°œì˜ buffer ë³´ë‚´ì¤„ ìˆ˜ ìˆìŒ


<br>


# ğŸ¥ Results

![result](https://github.com/inhopp/inhopp/assets/96368476/4ae5d934-c227-4ce9-ad34-1574304baec8)



<br>
<br>


[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}