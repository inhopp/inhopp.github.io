---
title:  "Picking" 

categories:
  -  Graphics
tags:
  - [DirectX]

toc: true
toc_sticky: true

date: 2023-08-23
last_modified_at: 2023-08-23
---


í™ì •ëª¨ë‹˜ì˜ **[ê·¸ë˜í”½ìŠ¤ ìƒˆì‹¹ì½”ìŠ¤](https://honglab.co.kr/)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ¥ Picking with Rasterization (GPU)

| Render Target | Index - Render Target |
|:-:|:-:|
|![captured1](https://github.com/inhopp/StyleGAN/assets/96368476/d8b4fed2-39e8-4c3e-941b-d9d126b437c9)|![captured](https://github.com/inhopp/StyleGAN/assets/96368476/710908cd-4687-4b0c-b892-0588586dc194)
| 

``` cpp
// ..
ID3D11RenderTargetView *targets[] = {m_renderTargetView.Get(), m_indexRenderTargetView.Get()};
m_context->OMSetRenderTargets(2, targets, m_depthStencilViw.Get());

//...
```

``` hlsl
struct PixelShaderOutput
{
    float4 pixelColor : SV_Target0;
    float4 indexColor : SV_Target1;
}
```

- Meshë§ˆë‹¤ index colorë¥¼ ì§€ì •
- Render Target 2ê°œë¥¼ ë§Œë“¤ì–´ í•˜ë‚˜ëŠ” index colorë¡œ ë Œë”ë§
- Index Render Targetì„ í†µí•´ Picking ì—¬ë¶€ë¥¼ í™•ì¸!

<br>

## Results

![ezgif com-crop (1)](https://github.com/inhopp/StyleGAN/assets/96368476/2d01d175-f3c6-41bd-b9b5-ae159f96f530)

<br>


# ğŸ¥ Picking with Ray Collision (CPU)

![Ect-38](https://github.com/inhopp/StyleGAN/assets/96368476/fa849a05-4aec-4510-b626-02bdc4c4b260){: width="40%" height="50%"}

``` cpp
Vector3 cursorNdcNear = Vector3(m_cursorNdcX, m_cursorNdcY, 0.0f);
Vector3 cursorNdcFar = Vector3(m_cursorNdcX, m_cursorNdcY, 1.0f);

Matrix inverseProjView = (viewRow * porjRow).Invert();

Vector3 CursorWorldNear = Vector3::Transform(cursorNdcNear, inverseProjView);
Vector3 CursorWorldFar = Vector3::Transform(cursorNdcFar, inverseProjView);

Vector3 dir = (CursorWorldFar - CursorWorldNear).Normalize();

SimpleMath::Ray ray = SimpleMath::Ray(CursorWorldNear, dir);
float dist = 0.0f;
m_selected = ray.Intersects(m_mainBoundingSphere, dist);

// ...
```

- ë§ˆìš°ìŠ¤ì˜ NDCì¢Œí‘œë¥¼ ë‹¤ì‹œ world spaceë¡œ ì˜®ê²¨ì£¼ì–´ì•¼ í•¨
- ë§ˆìš°ìŠ¤ë¡œëŠ” zê°’ì„ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ near plane, far plane ì–‘ìª½ìœ¼ë¡œ ë³€í™˜
- ë§ˆìš°ìŠ¤ì— ëŒ€ì‘í•˜ëŠ” í”½ì…€ì—ì„œ Rayë¥¼ ì˜ì•„ picking ì—¬ë¶€ íŒë‹¨ (near planeì—ì„œ ì¶œë°œí•´ì•¼ í•¨)
- ëª°ëëŠ”ë° SimpleMath::Rayì— sphere, circle, box, ... ë“± Intersects ë©”ì„œë“œê°€ êµ¬í˜„ë˜ì–´ ìˆë‹¤..

<br>

## Results

![ezgif com-crop](https://github.com/inhopp/StyleGAN/assets/96368476/88f08691-a6a6-40ea-b7de-d704ae78fb74)




<br>
<br>


[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}