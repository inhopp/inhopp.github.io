---
title:  "Mipmap Texture" 

categories:
  -  Graphics
tags:
  - [DirectX]

toc: true
toc_sticky: true

date: 2023-09-03
last_modified_at: 2023-09-03
---


í™ì •ëª¨ë‹˜ì˜ **[ê·¸ë˜í”½ìŠ¤ ìƒˆì‹¹ì½”ìŠ¤](https://honglab.co.kr/)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ¥ Mipmap

![MipMap_Example_STS101](https://github.com/inhopp/StyleGAN/assets/96368476/9aeb856d-c738-4371-ac46-51281edb353b){: width="60%" height="70%"}

Mipmapì´ë€ ì›ë³¸ í…ìŠ¤ì³ë¥¼ ë‹¤ì–‘í•œ í•´ìƒë„ë¡œ ë¯¸ë¦¬ ì¤€ë¹„í•œ í…ìŠ¤ì³ì˜ ì§‘í•©ì´ë‹¤. êµ³ì´ ë†’ì€ í•´ìƒë„ì˜ í…ìŠ¤ì³ë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ëŠ” ê²½ìš°(LOD), ë‚®ì€ í•´ìƒë„ì˜ í…ìŠ¤ì³ë¥¼ ì‚¬ìš©í•´ ë©”ëª¨ë¦¬ì™€ ì—°ìƒëŸ‰ì„ ëª¨ë‘ ì ˆì•½í•  ìˆ˜ ìˆë‹¤. 

<br>

![Mipmap_Aliasing_Comparison](https://github.com/inhopp/StyleGAN/assets/96368476/17686dfc-e1a8-4ded-8298-2739bdbfc1e7){: width="60%" height="70%"}

ë˜í•œ ì¹´ë©”ë¼ì™€ì˜ ê±°ë¦¬ê°€ ë©€ì–´ì§ˆìˆ˜ë¡ ë†’ì€ í•´ìƒë„ì— ë”°ë¥¸ aliasing í˜„ìƒì´ ë‘ë“œëŸ¬ì§„ë‹¤. ì´ë•Œ Mipmapê³¼ LOD ê¸°ë²•ì„ ì´ìš©í•˜ì—¬ ì´ëŸ¬í•œ í˜„ìƒì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.


<br>


# ğŸ¥ Create Mipmap Texture

``` cpp
ComPtr<ID3D11Texture2D> stagingTexture = CreateStagingTexture(device, context, width, height, image);

D3D11_TEXTURE2D_DESC txtDesc;
// ..
txtDesc.MipLevels = 0;
txtDesc.Usage = D3D11_USAGE_DEFAULT;
txt.MiscFlags = D3D11_RESOURCE_MISC_GENERATE_MIPS;

// ì´ˆê¸° ë°ì´í„° ì—†ì´ texture2d ìƒì„±
device->CreateTexture2D(&txtDesc, nullptr, texture.GetAddressOf());

// ì›ë³¸ texture(staging texture) ë³µì‚¬
context->CopySubresourceRegion(texture.Get(), 0, 0, 0, 0, stagingTexture.Get(), 0, nullptr);

device->CreateShaderResourceView(texture.Get(), 0, textureResourceVuew.GetAddressOf());

// í•´ìƒë„ ë‚®ì¶°ê°€ë©° ë°‰ë§µ ìƒì„±
context->GenerateMips(textureResourceView.Get());
```

- ì„ì‹œ í…ìŠ¤ì³(staging texture) ë§Œë“¤ê¸°
- Usageë¥¼ D3D11_USAGE_STAGINGì¸ ì¤„ ì•Œì•˜ëŠ”ë° GPU->CPUê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— DEFAULT
- MipLevels = 0 : í•´ìƒë„ 1x1 ë  ë•Œê¹Œì§€ ìµœëŒ€í•œ ë§ì€ mipmap ìƒì„±
- MiscFlagsì—ì„œ generate_mips ì§€ì •

<br>

## SubResource

| Resource | SubResource |
|:-:|:-:|
|![1](https://github.com/inhopp/StyleGAN/assets/96368476/3db72b98-1166-4ce4-908c-4e501fa7499d)|![2](https://github.com/inhopp/StyleGAN/assets/96368476/fbebadf4-907f-4901-ac40-aa88027ddc82)|

- Mipmapì‚¬ìš© ì‹œ ResourceëŠ” mipmapì„ ë¬¶ì–´ì„œ array indexë¡œ ë“¤ê³ ë‹¤ë‹˜
- SubResourceëŠ” resource ë‚´ í•˜ë‚˜í•˜ë‚˜ì— ëŒ€í•œ ì ‘ê·¼


<br>


# ğŸ¥ Using Mipmap Texture

``` hlsl
// ...

PixelShaderOutput main(PixelShaderInput input)
{
  // ...
  float dist = length(eyeWorld - input.posWorld);
  float distMin = 5.0;
  float distMax = 10.0;
  float lod = 8.0 * saturate(dist - distMin / (distMax - distMin));

  dffuse *= g_texture0.SampleLevel(g_sampler, input.texcoord, lod);

  // ...
}
```

- Mipmap ì‚¬ìš©ì‹œ SamplerëŒ€ì‹  SampleLevel ì‚¬ìš©
- ê±°ë¦¬ì— ë”°ë¼ lod ë‹¨ê³„ë¥¼ ì •í•´ì£¼ê³  SampleLevel(sampler, texcoord, lodë‹¨ê³„)


<br>


# ğŸ¥ Results

![ezgif com-crop (1)](https://github.com/inhopp/StyleGAN/assets/96368476/b64e4b64-46f0-446e-a15f-2863c813958b)



<br>
<br>


[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}