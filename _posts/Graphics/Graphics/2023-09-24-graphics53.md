---
title:  "Depth Map & Fog Effect" 

categories:
  -  Graphics
tags:
  - [DirectX]

toc: true
toc_sticky: true

date: 2023-09-24
last_modified_at: 2023-09-24
---


í™ì •ëª¨ë‹˜ì˜ **[ê·¸ë˜í”½ìŠ¤ ìƒˆì‹¹ì½”ìŠ¤](https://honglab.co.kr/)** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
{: .notice--warning}

<br>


# ğŸ¥ Depth Map

| Origin Map | Depth Map |
|:-:|:-:|
|![3](https://github.com/inhopp/StyleGAN/assets/96368476/c60536b9-acb9-441b-bf25-f3691f20f883)|![4](https://github.com/inhopp/StyleGAN/assets/96368476/430c887c-ebce-489b-9a77-18c8fd1030db)|

![Ect-67](https://github.com/inhopp/StyleGAN/assets/96368476/928af447-6fd4-4437-aa06-069a7374a909){: width="40%" height="50%"}

Depth Mapì€ ì¹´ë©”ë¼ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì–¼ë§ˆë§Œí¼ì˜ ê±°ë¦¬ë¥¼ ê°–ëŠ”ì§€ë¥¼ í‘œí˜„í•œ ë²„í¼ì´ë‹¤. ì´ë•Œ ê¹Šì´ê°’ì€ ì •í™•íˆ ì¹´ë©”ë¼ ë¶€í„° world positionê¹Œì§€ì˜ ê±°ë¦¬ê°€ ì•„ë‹Œ ì¹´ë©”ë¼ì™€ Near-Farì¶•ì— ëŒ€í•œ ê±°ë¦¬ì´ë‹¤. Depth Mapì€ Frame Bufferì™€ ë™ì¼í•œ í¬ê¸°ì´ë©° í”½ì…€ ë‹¨ìœ„ë¡œ ê¹Šì´ ê°’ì„ ê°€ì§„ë‹¤.


<br>

``` hlsl
float4 TexcoordToView(float2 texcoord)
{
  float4 posProj;

  posProj.xy = texcoord * 2.0 - 1.0;
  posProj.y *= -1;
  posProj.z = depthOnlyTex.Sample(linearClampSampler, texcoord).r;
  posProj.w = 1.0;

  float4 posView = mul(posProj, invProj);
  posProj.xyz /= posProj.w;

  return posProj;
}
```

- íŠ¹ì • World ì¢Œí‘œì˜ ê¹Šì´ê°’ì€?
- xy ë²”ìœ„ë¥¼ [0, 1]ì—ì„œ NDC[-1, 1]ë¡œ ì¡°ì •
- depthTextureì—ì„œ í•´ë‹¹ ìœ„ì¹˜ì˜ ê¹Šì´ê°’ ê°€ì ¸ì˜¤ê¸°
- MVPë³€í™˜ì„ êµ¬í•  ë•Œ ê°™ì´ êµ¬í•´ë‘” inverse Projectionë³€í™˜ì„ ì´ìš©í•´ ì—­ë³€í™˜


<br>


# ğŸ¥ Fog Effect

![images](https://github.com/inhopp/StyleGAN/assets/96368476/a520cd54-2149-47a9-938e-c231cf43cd1c){: width="30%" height="40%"}

ë‹¨ìˆœí•œ Fog Effect êµ¬í˜„ ë°©ë²•ì„ ìƒê°í•´ë³´ë©´, íŠ¹ì • ìœ„ì¹˜ì˜ ê¹Šì´ì— ë¹„ë¡€í•œ fog colorë¥¼ interpolationí•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤. ì´ë•Œ Beer-Lambert Lawë¥¼ ì ìš©í•´ì£¼ë©´ ë”ìš± í˜„ì‹¤ì ì¸ Fog Effectë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. Beer-Lambert Lawë€ ë§¤ì§ˆì˜ ì„±ì§ˆê³¼ ë¹›ì˜ ê°ì‡ í˜„ìƒì— ëŒ€í•œ ë²•ì¹™ì´ë‹¤. ê°„ë‹¨í•œ ë¯¸ë¶„ ë°©ì ì‹ì„ í’€ë©´ ë˜ëŠ”ë° expì— ëŒ€í•œ í•¨ìˆ˜ë¡œ ì •ë¦¬ëœë‹¤.


# ğŸ¥ Results

![ezgif com-crop (1)](https://github.com/inhopp/StyleGAN/assets/96368476/3714da1c-8f80-4e78-9bfe-7c887363eb7a)



<br>
<br>


[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}